
BEGIN_PROLOG


dunefd_geo:
{

 # Various configurations for FD-related geometries

 Name:     "dune10kt"   #note: this does not need to change with GDML file
			#unless it is important that DetId be 34kt.
			#  At this point, 34kt is no different than 10kt,
			#  and there are no other FD detector IDs. 9/7/13

 # Choose GDML file

 GDML:      "dune10kt_v1.gdml"
 ROOT:      "dune10kt_v1.gdml"
# GDML:      "dune10kt_v1_workspace.gdml"
# ROOT:      "dune10kt_v1_workspace.gdml"
# GDML:      "dune10kt_v1_45deg.gdml"
# ROOT:      "dune10kt_v1_45deg.gdml"
# GDML:      "dune10kt_v1_45deg_workspace.gdml"
# ROOT:      "dune10kt_v1_45deg_workspace.gdml"
# GDML:      "dune10kt_v1_3mmPitch.gdml"
# ROOT:      "dune10kt_v1_3mmPitch.gdml"
# GDML:      "dune10kt_v1_3mmPitch_workspace.gdml"
# ROOT:      "dune10kt_v1_3mmPitch_workspace.gdml"
# GDML:      "lbne10kt.gdml"
# ROOT:      "lbne10kt.gdml"
# GDML:      "lbne34kt.gdml"
# ROOT:      "lbne34kt.gdml"
# GDML:      "lbne4apa36deg.gdml"
# ROOT:      "lbne4apa36deg.gdml"   # *45deg.gdml or *36deg.gdml

 SortingParameters:	{ChannelsPerOpDet:	1}

 SurfaceY:         0.0e2               # in cm, vertical distance to the surface
 #SurfaceY: 147828                       # Underground option. 4850 feet to cm. from DocDb-3833


 DisableWiresInG4: true
}

dune10kt_geo:
{
 Name:      "dune10kt_v1"
 
 GDML:      "dune10kt_v1.gdml"
 ROOT:      "dune10kt_v1.gdml"

 SortingParameters:	{ChannelsPerOpDet:	1}

 SurfaceY: 147828                       # Underground option. 4850 feet to cm. from DocDb-3833

 DisableWiresInG4:   true

}

dunedphase10kt_geo:
{
 Name:      "dunedphase10kt_v2"
 
 GDML:      "dunedphase10kt_v2.gdml"
 ROOT:      "dunedphase10kt_v2.gdml"

 SortingParameters:	{ChannelsPerOpDet:	1}

 SurfaceY: 147828                       # Underground option. 4850 feet to cm. from DocDb-3833

 DisableWiresInG4:   true
}

dunedphase10kt_driftY_geo:
{
 Name:      "dunedphase10kt_v2_driftY"
 
 GDML:      "dunedphase10kt_v2_driftY.gdml"
 ROOT:      "dunedphase10kt_v2_driftY.gdml"

 SortingParameters:	{ChannelsPerOpDet:	1}

 SurfaceY: 147828                       # Underground option. 4850 feet to cm. from DocDb-3833

 DisableWiresInG4:   true
}

dunedphase10kt_driftY_HalfFoiled_geo: @local::dunedphase10kt_driftY_geo
dunedphase10kt_driftY_HalfFoiled_geo.Name: "dunedphase10kt_v2_driftY_HalfFoil"
dunedphase10kt_driftY_HalfFoiled_geo.GDML: "dunedphase10kt_v2_driftY_HalfFoil.gdml"
dunedphase10kt_driftY_HalfFoiled_geo.ROOT: "dunedphase10kt_v2_driftY_HalfFoil.gdml"

protodunedphase_geo:
{
 Name:      "protodunedphase"

 GDML:      "protodunedphase.gdml"
 ROOT:      "protodunedphase.gdml"

 SortingParameters:    {ChannelsPerOpDet:    1}
 SurfaceY: 0.0                       # Underground option. 4850 feet to cm. from DocDb-3833
 DisableWiresInG4:   true
} 

protodunedphase_driftY_geo:
{
 Name:      "protodunedphase_driftY"

 GDML:      "protodunedphase_driftY.gdml"
 ROOT:      "protodunedphase_driftY.gdml"

 SortingParameters:    {ChannelsPerOpDet:    1}
 SurfaceY: 0.0                       # Underground option. 4850 feet to cm. from DocDb-3833
 DisableWiresInG4:   true
} 

protodunedphase_driftY_uniform_geo:
{
 Name:      "protodunedphase_driftY_uniform"

 GDML:      "protodunedphase_driftY_uniform.gdml"
 ROOT:      "protodunedphase_driftY_uniform.gdml"

 SortingParameters:    {ChannelsPerOpDet:    1}
 SurfaceY: 0.0                       # Underground option. 4850 feet to cm. from DocDb-3833
 DisableWiresInG4:   true
} 

dphase3x1x1_geo:
{
 Name:      "3x1x1dphase"

 GDML:      "3x1x1dphase.gdml"
 ROOT:      "3x1x1dphase.gdml"

 SortingParameters:    {ChannelsPerOpDet:    1}
 SurfaceY: 0.0                       # Underground option. 4850 feet to cm. from DocDb-3833
 DisableWiresInG4:   true
}

dphase3x1x1_driftY_geo:
{
 Name:      "3x1x1dphase_driftY"

 GDML:      "3x1x1dphase_driftY.gdml"
 ROOT:      "3x1x1dphase_driftY.gdml"

 SortingParameters:    {ChannelsPerOpDet:    1}
 SurfaceY: 0.0                       # Underground option. 4850 feet to cm. from DocDb-3833
 DisableWiresInG4:   true
}

dune10kt_workspace_geo: @local::dune10kt_geo
dune10kt_workspace_geo.Name: "dune10kt_v1_workspace"
dune10kt_workspace_geo.GDML: "dune10kt_v1_workspace.gdml"
dune10kt_workspace_geo.ROOT: "dune10kt_v1_workspace.gdml"

dune10kt_1x2x6_v1_geo: @local::dune10kt_geo
dune10kt_1x2x6_v1_geo.Name: "dune10kt_v1_1x2x6"
dune10kt_1x2x6_v1_geo.GDML: "dune10kt_v1_1x2x6.gdml"
dune10kt_1x2x6_v1_geo.ROOT: "dune10kt_v1_1x2x6.gdml"

dune10kt_1x2x6_v3_geo: @local::dune10kt_geo
dune10kt_1x2x6_v3_geo.Name: "dune10kt_v3_1x2x6"
dune10kt_1x2x6_v3_geo.GDML: "dune10kt_v3_1x2x6.gdml"
dune10kt_1x2x6_v3_geo.ROOT: "dune10kt_v3_1x2x6.gdml"

dune10kt_1x2x6_v3_geo: @local::dune10kt_geo
dune10kt_1x2x6_v3_geo.Name: "dune10kt_v3_1x2x6"
dune10kt_1x2x6_v3_geo.GDML: "dune10kt_v3_1x2x6.gdml"
dune10kt_1x2x6_v3_geo.ROOT: "dune10kt_v3_1x2x6.gdml"

dune10kt_1x2x6_v4_geo: @local::dune10kt_geo
dune10kt_1x2x6_v4_geo.Name: "dune10kt_v4_1x2x6"
dune10kt_1x2x6_v4_geo.GDML: "dune10kt_v4_1x2x6.gdml"
dune10kt_1x2x6_v4_geo.ROOT: "dune10kt_v4_1x2x6.gdml"

dune10kt_1x2x6_geo: @local::dune10kt_1x2x6_v4_geo


dunedphase10kt_workspace_geo: @local::dunedphase10kt_geo
dunedphase10kt_workspace_geo.Name: "dunedphase10kt_v2_workspace"
dunedphase10kt_workspace_geo.GDML: "dunedphase10kt_v2_workspace.gdml"
dunedphase10kt_workspace_geo.ROOT: "dunedphase10kt_v2_workspace.gdml"

dunedphase10kt_workspace4x2_geo: @local::dunedphase10kt_geo
dunedphase10kt_workspace4x2_geo.Name: "dunedphase10kt_v2_workspace4x2"
dunedphase10kt_workspace4x2_geo.GDML: "dunedphase10kt_v2_workspace4x2.gdml"
dunedphase10kt_workspace4x2_geo.ROOT: "dunedphase10kt_v2_workspace4x2.gdml"




dunedphase10kt_driftY_workspace_geo: @local::dunedphase10kt_driftY_geo
dunedphase10kt_driftY_workspace_geo.Name: "dunedphase10kt_v2_driftY_workspace"
dunedphase10kt_driftY_workspace_geo.GDML: "dunedphase10kt_v2_driftY_workspace.gdml"
dunedphase10kt_driftY_workspace_geo.ROOT: "dunedphase10kt_v2_driftY_workspace.gdml"

dunedphase10kt_driftY_workspace4x2_geo: @local::dunedphase10kt_driftY_geo
dunedphase10kt_driftY_workspace4x2_geo.Name: "dunedphase10kt_v2_driftY_workspace4x2"
dunedphase10kt_driftY_workspace4x2_geo.GDML: "dunedphase10kt_v2_driftY_workspace4x2.gdml"
dunedphase10kt_driftY_workspace4x2_geo.ROOT: "dunedphase10kt_v2_driftY_workspace4x2.gdml"

dunedphase10kt_driftY_workspace3x3_geo: @local::dunedphase10kt_driftY_geo
dunedphase10kt_driftY_workspace3x3_geo.Name: "dunedphase10kt_v2_driftY_workspace3x3"
dunedphase10kt_driftY_workspace3x3_geo.GDML: "dunedphase10kt_v2_driftY_workspace3x3.gdml"
dunedphase10kt_driftY_workspace3x3_geo.ROOT: "dunedphase10kt_v2_driftY_workspace3x3.gdml"




dune10kt_45deg_workspace_geo: @local::dune10kt_geo
dune10kt_45deg_workspace_geo.Name: "dune10kt_v1_45deg_workspace"
dune10kt_45deg_workspace_geo.GDML: "dune10kt_v1_45deg_workspace.gdml"
dune10kt_45deg_workspace_geo.ROOT: "dune10kt_v1_45deg_workspace.gdml"

dune10kt_45deg_1x2x6_geo: @local::dune10kt_geo
dune10kt_45deg_1x2x6_geo.Name: "dune10kt_v1_45deg_1x2x6"
dune10kt_45deg_1x2x6_geo.GDML: "dune10kt_v1_45deg_1x2x6.gdml"
dune10kt_45deg_1x2x6_geo.ROOT: "dune10kt_v1_45deg_1x2x6.gdml"


dune10kt_3mmpitch_workspace_geo: @local::dune10kt_geo
dune10kt_3mmpitch_workspace_geo.Name: "dune10kt_v1_3mmpitch_workspace"
dune10kt_3mmpitch_workspace_geo.GDML: "dune10kt_v1_3mmpitch_workspace.gdml"
dune10kt_3mmpitch_workspace_geo.ROOT: "dune10kt_v1_3mmpitch_workspace.gdml"

dune10kt_3mmpitch_1x2x6_geo: @local::dune10kt_geo
dune10kt_3mmpitch_1x2x6_geo.Name: "dune10kt_v1_3mmpitch_1x2x6"
dune10kt_3mmpitch_1x2x6_geo.GDML: "dune10kt_v1_3mmpitch_1x2x6.gdml"
dune10kt_3mmpitch_1x2x6_geo.ROOT: "dune10kt_v1_3mmpitch_1x2x6.gdml"

#Updated CRT locations, shorter grid-anode distance, 1.5 cm outer volume
protodunev6_geo: @local::dune10kt_geo
protodunev6_geo.Name: "protodune" # will be made lower case anyway
protodunev6_geo.GDML: "protodune_v6.gdml"
protodunev6_geo.ROOT: "protodune_v6.gdml"

#ARAPUCA geometry
protodunev7_geo: @local::dune10kt_geo
protodunev7_geo.Name: "protodunev7" # will be made lower case anyway
protodunev7_geo.GDML: "protodune_v7.gdml"
protodunev7_geo.ROOT: "protodune_v7.gdml"

protodune_geo: @local::protodunev7_geo

iceberg_geo: @local::dune10kt_geo
iceberg_geo.Name: "iceberg" # will be made lower case anyway
iceberg_geo.GDML: "iceberg_v1.gdml"
iceberg_geo.ROOT: "iceberg_v1.gdml"

dune35t_geo:
{
 Name:     "dune35t4apa_v6"

 # Choose GDML file and set detector version similarly
 GDML:         "dune35t4apa_v6.gdml"
 ROOT:         "dune35t4apa_v6.gdml"
 SortingParameters: { 
    DetectorVersion: "dune35t4apa_v6"
    ChannelsPerOpDet:	12
 } 

 SurfaceY:           0.0e2               #in cm, vertical distance to the surface
 DisableWiresInG4:   true

}

larnd_geo:
{
 Name:     "larnd"

 GDML:     "larnd.gdml"
 ROOT:     "larnd.gdml"

 SortingParameters:	{ChannelsPerOpDet:	1}
 SurfaceY:           5578               #183ft in cm, vertical distance to the surface
 DisableWiresInG4:   true
}


dune_geometry_helper:
{
 service_provider : DUNEGeometryHelper
}



END_PROLOG
BEGIN_PROLOG

standard_detproperties :
{
 service_provider: "DetectorPropertiesServiceStandard"

 # Drift properties 
 Temperature:      91                #Kelvin
 Efield:           [0.5,0.66,0.8 ]   #kV/cm
 Electronlifetime: 750               #microseconds
 
 SternheimerA:     0.1956  # Ar Sternheimer parameter a.
 SternheimerK:     3.0000  # Ar Sternheimer parameter k.
 SternheimerX0:    0.2000  # Ar Sternheimer parameter x0.
 SternheimerX1:    3.0000  # Ar Sternheimer parameter x0.
 SternheimerCbar:  5.2146  # Ar Sternheimer parameter Cbar.

 DriftVelFudgeFactor: 1.
 
 ElectronsToADC:    1.208041e-3  # in ADC/e; 6241.5 electrons = 1fC = 7.54 ADC counts for ArgoNeuT
 NumberTimeSamples: 2048         # ticks of the clock per readout frame
 TimeOffsetU:       -5.193
 TimeOffsetV:       0.585
 TimeOffsetZ:       0
 ReadOutWindowSize: 2048

 SimpleBoundaryProcess: true  #enable opticalBoundaryProcessSimple instead of G4 default

}

# be sure to make the necessary changes when microboone and
# lbne have different electronics simulations from argoneut

END_PROLOG

BEGIN_PROLOG


dunefd_detproperties:                   @local::standard_detproperties
# dunefd_detproperties.SamplingRate:      500.         #in ns
dunefd_detproperties.Temperature:       87
dunefd_detproperties.Electronlifetime:  3.0e3
dunefd_detproperties.Efield:           [0.5,0.666,0.8]  #(predicted for microBooNE)
dunefd_detproperties.ElectronsToADC:    6.8906513e-3 # 1fC = 43.008 ADC counts for DUNE fd
dunefd_detproperties.NumberTimeSamples: 4492         # drift length/drift velocity*sampling rate = (359.4 cm)/(0.16 cm/us)*(2 MHz)
dunefd_detproperties.ReadOutWindowSize: 4492         # drift length/drift velocity*sampling rate = (359.4 cm)/(0.16 cm/us)*(2 MHz)
dunefd_detproperties.TimeOffsetU:       0.
dunefd_detproperties.TimeOffsetV:       0.
dunefd_detproperties.TimeOffsetZ:       0.

dunefddphase_detproperties:                   @local::standard_detproperties
# dunefddphase_detproperties.SamplingRate:    400.          # in ns
dunefddphase_detproperties.Temperature:       87            # in K
dunefddphase_detproperties.Electronlifetime:  3.0e3         # in us
dunefddphase_detproperties.Efield:            [0.5,4.0,0.0] # in kV/cm
dunefddphase_detproperties.ElectronsToADC:    5.1267e-04    # 
dunefddphase_detproperties.NumberTimeSamples: 20000         # drift length/drift velocity*sampling rate
dunefddphase_detproperties.ReadOutWindowSize: 20000         # drift length/drift velocity*sampling rate
dunefddphase_detproperties.TimeOffsetX:       0.
dunefddphase_detproperties.TimeOffsetY:       0.
dunefddphase_detproperties.TimeOffsetZ:       0.

protodunedphase_detproperties:                   @local::standard_detproperties
protodunedphase_detproperties.Temperature:       87            # in K
protodunedphase_detproperties.Electronlifetime:  3.0e3         # in us
protodunedphase_detproperties.Efield:            [0.5,4.0,0.0] # in kV/cm
protodunedphase_detproperties.ElectronsToADC:    1.02534e-03   # 
protodunedphase_detproperties.NumberTimeSamples: 10000         # 10000 before beam + 10000 after beam
protodunedphase_detproperties.ReadOutWindowSize: 10000         # 10000 before beam + 10000 after beam
protodunedphase_detproperties.TimeOffsetX:       0.
protodunedphase_detproperties.TimeOffsetY:       0.
protodunedphase_detproperties.TimeOffsetZ:       0.

dphase3x1x1_detproperties: 		@local::standard_detproperties
dphase3x1x1_detproperties.Temperature:       87            # in K
dphase3x1x1_detproperties.Electronlifetime:  3.0e3         # in us
dphase3x1x1_detproperties.Efield:            [0.5,4.0,0.0] # in kV/cm
dphase3x1x1_detproperties.ElectronsToADC:    1.02534e-03   # 
dphase3x1x1_detproperties.NumberTimeSamples: 1667
dphase3x1x1_detproperties.ReadOutWindowSize: 1667
#dphase3x1x1_detproperties.TimeOffsetX:       0.
dphase3x1x1_detproperties.TimeOffsetY:       0.
dphase3x1x1_detproperties.TimeOffsetZ:       0.

dune35t_detproperties:                   @local::standard_detproperties
# dune35t_detproperties.SamplingRate:      500.         #in ns
dune35t_detproperties.Temperature:       87
dune35t_detproperties.Electronlifetime:  3.0e3
# dune35t_detproperties.Efield:          [0.5,0.666,0.8]  #(predicted for microBooNE)
dune35t_detproperties.Efield:            [0.25,0.782,1.734] # Run was at half field
dune35t_detproperties.ElectronsToADC:    6.8906513e-3 # 1fC = 43.008 ADC counts for DUNE 35t
dune35t_detproperties.NumberTimeSamples: 5200
dune35t_detproperties.ReadOutWindowSize: 5200
dune35t_detproperties.TimeOffsetU:       0.
dune35t_detproperties.TimeOffsetV:       0.
dune35t_detproperties.TimeOffsetZ:       0.

dune35t_milliblock_detproperties:         @local::dune35t_detproperties
dune35t_milliblock_detproperties.NumberTimeSamples: 15000
dune35t_milliblock_detproperties.ReadOutWindowSize: 15000

# Implement new 6000 tick readout window (500 before trigger)
protodune_detproperties:                   @local::standard_detproperties
protodune_detproperties.Temperature:       87.68
protodune_detproperties.Electronlifetime:  35.0e3
protodune_detproperties.Efield:           [0.4867,0.666,0.8]  #(predicted for microBooNE)
protodune_detproperties.ElectronsToADC:    6.8906513e-3 # 1fC = 43.008 ADC counts for DUNE fd
protodune_detproperties.NumberTimeSamples: 6000         # 1 drift window = 4492 = drift length/drift velocity*sampling rate = (359.4 cm)/(0.16 cm/us)*(2 MHz)
protodune_detproperties.ReadOutWindowSize: 6000         # 1 drift window = 4492 = drift length/drift velocity*sampling rate = (359.4 cm)/(0.16 cm/us)*(2 MHz)
protodune_detproperties.TimeOffsetU:       0.
protodune_detproperties.TimeOffsetV:       0.
protodune_detproperties.TimeOffsetZ:       0.




protodunesp_detproperties :
 {
 service_provider: "DetectorPropertiesServiceProtoDUNEsp" 



 GetHVDriftfromSamweb: true   #will attempt to look up nominal drift HV voltage from samweb metadata
 GetReadOutWindowSizefromSamweb: true #will attempt to look up readout window size samweb metadata
 UseRunDependentTemperature: true #will updated temperature using run number to account for the varition during datataking 

  # Drift properties 
Temperature:      87.68           #Kelvin
Efield:           [0.4867,0.619423,0.776903,1.72178]     #calc from 180KV drift and wire biases will be overwritten if GetHVvaluefromTable is enabled
Electronlifetime: 35.0e3               #microseconds
SternheimerA:     0.1956  # Ar Sternheimer parameter a.
SternheimerK:     3.0000  # Ar Sternheimer parameter k.
SternheimerX0:    0.2000  # Ar Sternheimer parameter x0.
SternheimerX1:    3.0000  # Ar Sternheimer parameter x0.
SternheimerCbar:  5.2146  # Ar Sternheimer parameter Cbar.  
SimpleBoundaryProcess: true  #enable opticalBoundaryProcessSimple instead of G4 default
ElectronsToADC:    6.8906513e-3 # 1fC = 43.008 ADC counts for DUNE fd
NumberTimeSamples: 6000         # 1 drift window = 4492 = drift length/drift velocity*sampling rate = (359.4 cm)/(0.16 cm/us)*(2 MHz)
ReadOutWindowSize: 6000         # 1 drift window = 4492 = drift length/drift velocity*sampling rate = (359.4 cm)/(0.16 cm/us)*(2 MHz)
TimeOffsetU:       0.
TimeOffsetV:       0.
TimeOffsetZ:       0.

}


END_PROLOG
BEGIN_PROLOG

standard_properties:
{
 service_provider: "LArPropertiesServiceStandard"

 # For following parameters, see http://pdg.lbl.gov/AtomicNuclearProperties/
 RadiationLength:  19.55   # g/cm^2
 AtomicNumber:     18      # Ar atomic number.
 AtomicMass:       39.948  # Ar atomic mass (g/mol).
 ExcitationEnergy: 188.0   # Ar mean excitation energy (eV).

# Argon39DecayRate: 0.00141 # decays per cm^3 per second.  Assumes 1.01 Bq/kg and a density of 1.396 g/cc
# The following parameter was formerly used to steer an ad-hoc 39Ar decay model as part of the G4 step.
# Users are now recommended to use the radiological generator: see larsim/EventGenerators/radiological_gen.fcl
# As of February 2017, this value is no longer used.
 Argon39DecayRate: 0.0

 # Optical properties
 # Fast and slow scintillation emission spectra, from [J Chem Phys vol 91 (1989) 1469]
 FastScintEnergies:    [ 6.0,  6.7,  7.1,  7.4,  7.7, 7.9,  8.1,  8.4,  8.5,  8.6,  8.8,  9.0,  9.1,  9.4,  9.8,  10.4,  10.7]
 SlowScintEnergies:    [ 6.0,  6.7,  7.1,  7.4,  7.7, 7.9,  8.1,  8.4,  8.5,  8.6,  8.8,  9.0,  9.1,  9.4,  9.8,  10.4,  10.7]
 FastScintSpectrum:    [ 0.0,  0.04, 0.12, 0.27, 0.44, 0.62, 0.80, 0.91, 0.92, 0.85, 0.70, 0.50, 0.31, 0.13, 0.04,  0.01, 0.0]
 SlowScintSpectrum:    [ 0.0,  0.04, 0.12, 0.27, 0.44, 0.62, 0.80, 0.91, 0.92, 0.85, 0.70, 0.50, 0.31, 0.13, 0.04,  0.01, 0.0]
 ScintResolutionScale: 1.     # resolution factor used by G4 scintillation
 ScintFastTimeConst:   6.     # fast scintillation time constant (ns)
 ScintSlowTimeConst:   1590.  # slow scintillation time constant (ns)
 ScintBirksConstant:   0.069  # birks constant for LAr (1/MeV cm)
 ScintYield:           24000. # total scintillation yield (ph/Mev)
 ScintPreScale:        0.03   # Scale factor to reduce number of photons simulated
                              # Later QE should be corrected for this scale
 ScintYieldRatio:      0.3    # fast / slow scint ratio (needs revisitting)
 ScintByParticleType:  false  # whether to use different yields and
                              # quenching per particle in fast op sim
 EnableCerenkovLight: true    # whether to switch on cerenkov light (slow)




 # Scintillation yields and fast/slow ratios per particle type
 MuonScintYield:          24000
 MuonScintYieldRatio:     0.23
 PionScintYield:          24000
 PionScintYieldRatio:     0.23
 ElectronScintYield:      20000
 ElectronScintYieldRatio: 0.27
 KaonScintYield:          24000
 KaonScintYieldRatio:     0.23
 ProtonScintYield:        19200
 ProtonScintYieldRatio:   0.29
 AlphaScintYield:         16800
 AlphaScintYieldRatio:    0.56


 # Refractive index as a function of energy (eV) from arXiv:2002.09346
 RIndexEnergies: [ 1.18626, 1.68626, 2.18626, 2.68626, 3.18626, 3.68626, 4.18626, 4.68626, 5.18626, 5.68626, 6.18626, 6.68626, 7.18626, 7.68626, 8.18626, 8.68626, 9.18626, 9.68626, 10.1863, 10.6863, 11.1863 ]
 RIndexSpectrum: [ 1.24664, 1.2205, 1.22694, 1.22932, 1.23124, 1.23322, 1.23545, 1.23806, 1.24116, 1.24489, 1.24942, 1.25499, 1.26197, 1.2709, 1.28263, 1.29865, 1.32169, 1.35747, 1.42039, 1.56011, 2.16626 ]

 # absorption length as function of energy
 AbsLengthEnergies: [ 4,     5,     6,     7,     8,     9,     10,    11   ]
 AbsLengthSpectrum: [ 2000., 2000., 2000., 2000., 2000., 2000., 2000., 2000.]

 # Rayleigh scattering length (cm) @ 90K as a function of energy (eV) from arXiv:2002.09346

RayleighEnergies: [ 1.18626, 1.68626, 2.18626, 2.68626, 3.18626, 3.68626, 4.18626, 4.68626, 5.18626, 5.68626, 6.18626, 6.68626, 7.18626, 7.68626, 8.18626, 8.68626, 9.18626, 9.68626, 10.1863, 10.6863, 11.1863 ]
RayleighSpectrum: [ 1200800, 390747, 128633, 54969.1, 27191.8, 14853.7, 8716.9, 5397.42, 3481.37, 2316.51, 1577.63, 1092.02, 763.045, 534.232, 371.335, 252.942, 165.38, 99.9003, 51.2653, 17.495, 0.964341 ]

 # Surface reflectivity data - vector of energy spectrum per
 #   surface type
 ReflectiveSurfaceEnergies:           [ 7, 9, 10 ]
 ReflectiveSurfaceNames:            [ "STEEL_STAINLESS_Fe7Cr2Ni" ]
 ReflectiveSurfaceReflectances:     [ [ 0.25, 0.25, 0.25 ] ]
 ReflectiveSurfaceDiffuseFractions: [ [ 0.5,  0.5,  0.5  ] ]

 # Information related with the simulation of the Wavelength Shifter (TPB)
 LoadExtraMatProperties: false

 # TPB - WLS
 TpbTimeConstant: 2.5 #wls time constant in s J. Lumin 81(1999) 285

 # WLS - TPB properties original tpb [0.0, 0.0, 0.0, 0.0588,0.235, 0.853, 1.0,1.0,0.9259,0.704,0.0296,0.011, 0.0,0.0, 0.]
 TpbEmmisionEnergies: [0.05,1.0,1.5, 2.25, 2.481, 2.819, 2.952,2.988,3.024, 3.1, 3.14,3.1807, 3.54, 5.5, 50.39]
 TpbEmmisionSpectrum: [0.0, 0.0, 0.0, 0.0588,0.235, 0.853, 1.0,1.0,0.9259,0.704,0.0296,0.011, 0.0,0.0, 0.]
 TpbAbsorptionEnergies: [0.05,1.77,2.0675, 7.42, 7.75, 8.16, 8.73, 9.78,10.69, 50.39]
 TpbAbsorptionSpectrum: [100000.0,100000.0, 100000.0,0.001,0.00000000001,0.00000000001, 0.00000000001, 0.00000000001, 0.00000000001, 0.00000000001]

}

END_PROLOG

BEGIN_PROLOG

dune35t_properties:                  @local::standard_properties

dunefd_properties:                   @local::standard_properties
# Load TPB properties for photon simulation
dunefd_properties.LoadExtraMatProperties: true 

dunefddphase_properties:             @local::standard_properties

END_PROLOG
BEGIN_PROLOG

standard_larfft:
{
 FFTSize:    0   # Default to the readout window size
 FFTOption: ""   # Add option "P" for planning.
 FitBins:   20   # Number of bins of correlation used for peak fit
}

END_PROLOG

BEGIN_PROLOG


dunefd_larfft:           @local::standard_larfft
dunefd_larfft.FitBins:   5

dune35t_larfft:            @local::standard_larfft
dune35t_larfft.FitBins:    5

# Note: going much higher on the FitBins introduces an 
# undesired time offset in dune wires


END_PROLOG

BEGIN_PROLOG

standard_debug:
{
 debugModules: [ "*" ]     # list individual module names here if you only want output from specific modules
 destinations:
 {	
  debugmsg:
  {
   type:      "file"       # record the messages in a file, could also be cout, cerr, archive, dds
   filename:  "debug.log"  # name of the file in which to place the messages
   threshold: "DEBUG"      # threshold of what level of messages to use
   categories:             # place to list named categories, if you want to customize, 
                           # I think the categories are what are the strings given to mf::LogXXX() commands
   {
     default:              # treat all unspecified categories using these values
     {
      limit:       10      # only show the first n messages and then back off exponentially
      reportEvery: 20      # report every nth message
      timespan:    600     # if more than this many seconds have elapsed without a message, print one
     }
   } # end categories
  } # end debugmsg
 } # end destinations
} # end standard_debug

# see comments for standard_debug configuration to figure out what each value is
standard_info:
{ 
 destinations:
 {  
  infomsg:
  {
   type:      "cout"	
   threshold: "INFO"
   categories:                                      
   {
     default:             
     {
      limit:       1000   
      timespan:    600    
     }
     RecoBaseDefaultCtor:
     {
      limit: 5
      timespan: 1000
     }
     GeometryBadInputPoint:
     {
      limit: 5
      timespan: 1000
     }
   } # end categories
  } # end infomsg
 } # end destinations
} # end standard_info

# see comments for standard_debug configuration to figure out what each value is
standard_warning:
{ 
 destinations:
 {  
  warningmsg:
  {
   type:      "cout"	
   threshold: "WARNING"
   categories: 
   {
     default:             
     {
      limit:       1000   
      timespan:    60    
     }
     RecoBaseDefaultCtor:
     {
      limit: 5
      timespan: 1000
     }
     GeometryBadInputPoint:
     {
      limit: 5
      timespan: 1000
     }
   } # end categories
  } # end warningmsg
 } # end destinations
} # end standard_warning

# see comments for standard_debug configuration to figure out what each value is
standard_error:
{ 
 destinations:
 {  
  errormsg:
  {
   type:      "cerr"	
   threshold: "ERROR"
   categories: 
   {
     default: {} 
   } # end categories
  } # end errormsg
 } # end destinations
} # end standard_error

END_PROLOG

BEGIN_PROLOG

#for now the parameter sets for the different experiments are all the same

standard_largeantparameters:
{
 OpticalSimVerbosity:      0       #verbosity of optical simulation, soon to be depricated
 ParticleKineticEnergyCut: 0.01e-3  #in GeV
 StoreTrajectories:        true
 VisualizationEnergyCut:   10.e-3  #depricated, in GeV
 VisualizeNeutrals:        false   #depricated
 UseCustomPhysics:         false   #Whether to use a custom list of physics processes or the default
 ModifyProtonCut:          false   #Whether to modify the default proton cut
 NewProtonCut:             0.0     #new ProtonCut value, ModifyProtonCut must be set to set new value
 KeepEMShowerDaughters:    false   #save secondary, tertiary, etc particles in EM showers
 LongitudinalDiffusion:    6.2e-9  #in cm^2/ns
 TransverseDiffusion:      16.3e-9 #in cm^2/ns
 ElectronClusterSize:      600.0   #number of ionization electrons to drift in a unit
 MinNumberOfElCluster:     0	   #minimum number of electron clusters
 EnabledPhysics:           [ "Em", "SynchrotronAndGN", "Ion", "Hadron",
                             "Decay", "HadronElastic", "Stopping", "NeutronTrackingCut" ]
 CosmogenicK0Bias:         0 # 0 is off. N is the number of secondaries to produce.
 CosmogenicXSMNBiasOn:     0 # 0 is off. 1 works. 2 still in development.
 CosmogenicXSMNBiasFactor: 1 # Not more than 5-ish cuz of numerical instabilities.
 DisableWireplanes:        false #if set true, charge drift simulation does not run - used for optical sim jobs OR just when you don't wanna drift the e's.
 SkipWireSignalInTPCs:     []     # put here TPC id's which should not receive ionization electrons - used to simulate TPC geom volumes which are actually dead LAr volumes in protoDUNE
 UseModBoxRecomb:          true   # use Modified Box recombination instead of Birks

 #* Recombination factor coefficients come from Nucl.Instrum.Meth.A523:275-286,2004
 #* * @f$ dE/dx @f$ is given by the voxel energy deposition, but have to convert it to MeV/cm from GeV/voxel width
 #* * electric field: @f$ E @f$ in kV/cm
 #* * @f$ R = A/(1 + (dE/dx)*k/E) @f$
 #* * @f$ A = 0.800 \pm 0.003 @f$
 #* * @f$ k = 0.0486 @f$ needs to be scaled with Electric field
 RecombA: 0.800      #< _A_ constant.
 Recombk: 0.0486     #< _k_ constant, in g/(MeV cm&sup2;)*kV/cm.

 #* Recombination factor coefficients come from Nucl.Instrum.Meth.A523:275-286,2004
 #* * @f$ dE/dx @f$ is given by the voxel energy deposition, but have to convert it to MeV/cm from GeV/voxel width
 #* * electric field: @f$ E @f$ in kV/cm
 #* * `kModBoxB` needs to be scaled with the electric field.
 ModBoxA: 0.930
 ModBoxB: 0.212

 # The following parameters specify details of wireplanes or similar
 #  areas with optically parameterized transmissions (Ben J 2013)

 #  volume names to be associated with an optical wireplane model
 OpticalParamVolumes:      ["volTPCPlaneVert_PV"]

 #  specification of which model to use for each volume
 OpticalParamModels:       ["OverlaidWireplanes"]

 # orientation of each wireplane set
 #  0 = Xdrift, 1 = Ydrift, 2 = Zdrift
 OpticalParamOrientations: [0]

 # This a set of floats which is specific to the particular model used.
 # For overlaid wireplanes, should be a vector of vectors of
 #                                 [plane angle, pitch/mm, wire diameter/mm]
 #
 # This format is chosen to allow for future extensions to the model
 #  for, eg, DUNE wireplane development.
 #
 OpticalParamParameters:   [ [ [60,  3, 0.15],
 	 		       [-60, 3, 0.15],
                               [0,   3, 0.15] ] ]
 UseLitePhotons: false
}

jp250L_largeantparameters:     @local::standard_largeantparameters
bo_largeantparameters:         @local::standard_largeantparameters
argoneut_largeantparameters:   @local::standard_largeantparameters
# The following line is already in simulationservices_microboone.fcl
# and so it should not also be included here, for clarity's sake.
#microboone_largeantparameters: @local::standard_largeantparameters
dune35t_largeantparameters:    @local::standard_largeantparameters
dunefd_largeantparameters:   @local::standard_largeantparameters

standard_larvoxelcalculator:
{
 VoxelSizeX:     0.03    #in cm
 VoxelSizeY:     0.03    #in cm
 VoxelSizeZ:     0.03    #in cm
 VoxelSizeT:     5000.0  #in ns
 VoxelOffsetX:   0.0     #in cm
 VoxelOffsetY:   0.0     #in cm
 VoxelOffsetZ:   0.0     #in cm
 VoxelOffsetT:   -2500.0 #in ns
 VoxelEnergyCut: 1.e-6   #in GeV
}

bo_larvoxelcalculator:         @local::standard_larvoxelcalculator
jp250L_larvoxelcalculator:     @local::standard_larvoxelcalculator
argoneut_larvoxelcalculator:   @local::standard_larvoxelcalculator
# The following line is already in simulationservices_microboone.fcl
# and so it should not also be included here, for clarity's sake.
#microboone_larvoxelcalculator: @local::standard_larvoxelcalculator
dune35t_larvoxelcalculator:    @local::standard_larvoxelcalculator
dunefd_larvoxelcalculator:     @local::standard_larvoxelcalculator

END_PROLOG

BEGIN_PROLOG


dunefd_largeantparameters:   @local::standard_largeantparameters
dunefd_larvoxelcalculator:   @local::standard_larvoxelcalculator
dunefd_largeantparameters.UseLitePhotons: true

protodune_largeantparameters:   @local::standard_largeantparameters
protodune_largeantparameters.UseCustomPhysics: true
protodune_largeantparameters.EnabledPhysics: [
         "Em",
         "FastOptical",
         "SynchrotronAndGN",
         "Ion",
         "Hadron",
         "Decay",
         "HadronElastic",
         "Stopping"
        ] # removed NeutronTrackingCut so neutrons from cosmics generator can appear throughout the full readout window

protodune_larvoxelcalculator:   @local::standard_larvoxelcalculator
protodune_largeantparameters.UseLitePhotons: true

dune35t_largeantparameters:   @local::dunefd_largeantparameters
dune35t_largeantparameters.UseModBoxRecomb: true
dune35t_larvoxelcalculator:   @local::dunefd_larvoxelcalculator


END_PROLOG
# signalservices_dune.fcl
#
# David Adams
# January 2016
#
# 28jan2016: Modify filter to fix problems with baseline for deconvoluted signals.
#            See https://cdcvs.fnal.gov/redmine/issues/11475.

BEGIN_PROLOG

dunefd_signalshapingservice: {

  DeconNorm: 200
  ADCPerPCAtLowestASICGain: 13160 #ADC/pC (2.8 ADC/mV * 4.7 mV/fC * 1000)
  # ASICGains:           [4.7, 7.8, 14, 25]
  ASICGainInMVPerFC:  [ 14, 14, 14 ] #mV/fC for Ind & col planes
  ShapeTimeConst:  [ 2.0, 2.0, 2.0 ] #Gain and Peaking time (microseconds)

  # Noise Factor - rms ADCs @ lowest ASIC Gain (4.7 mV/fC)
  NoiseFactVec:         [[ 1.12, 0.86, 0.60, 0.55 ], [ 1.12, 0.86, 0.60, 0.55 ], [ 0.89, 0.66, 0.48, 0.43 ]]
  # to turn off noise
  # NoiseFactVec:         [[ 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0 ]]


  #FieldBins:        75 # for UseFunctionFieldShape: true
  FieldBins:        400
  InputFieldRespSamplingPeriod: 100. # in nano second

  Col3DCorrection:  2.5
  Ind3DCorrection:  1.5
  ColFieldRespAmp:  1.0
  IndUFieldRespAmp:  1.0
  IndVFieldRespAmp:  1.0

  FieldResponseTOffset: [-32.5e3, -32.5e3, -32.5e3] # in ns, time offset of field response shape
  CalibResponseTOffset: [0.0, 0.0, 0.0] # in ns time offset to align all three planes


  # For IndFilter and ColFilter, frequency (x) is measured in
  # cycles/microsecond.  The conversion to frequency bin depends on FFT size
  # samping rate.

  #dla IndUFilter:       "(x>0.0)*gaus(0)*exp(-0.5*pow(x/[3],[4]))"
  IndUFilter:       "gaus(0)*exp(-0.5*pow(x/[3],[4]))"
  # IndUFilterParams: [ .454, 0.0, 0.1875, 0.25, 8.0 ]
  #IndUFilterParams: [ 0.05, 0.0, 0.1875, 0.25, 8.0 ]
  IndUFilterParams: [ 1.73, 1.69, 1.55, 0.19, 3.75 ]

  #dla IndVFilter:       "(x>0.0)*gaus(0)*exp(-0.5*pow(x/[3],[4]))"
  IndVFilter:       "gaus(0)*exp(-0.5*pow(x/[3],[4]))"
  # IndVFilterParams: [ .454, 0.0, 0.1875, 0.25, 8.0 ]
  #IndVFilterParams: [ 0.05, 0.0, 0.1875, 0.25, 8.0 ]
  #dla IndVFilterParams: [ 1.74, 1.46, 1.33, 0.23, 4.89 ]
  IndVFilterParams: [ 1.73, 1.69, 1.55, 0.19, 3.75 ]


  #dla ColFilter:       "(x>0)*[0]*exp(-0.5*(((x-[1])/[2])^2)^[3])"
  ColFilter:       "[0]*exp(-0.5*(((x-[1])/[2])^2)^[3])"
  # ColFilterParams: [ 79258.0, 0.0, 0.1875, 1.5 ]
  #ColFilterParams: [ 0.0792580, 0.0, 0.1875, 1.5 ]
  ColFilterParams: [ 1.03, 0.08, 0.15, 2.17 ]

  GetFilterFromHisto:   false

  FilterFunctionFname:  "uboone_filters_v0.1.root"
  FilterHistoName:	"noisefilter_%d"


  UseFunctionFieldShape: false
  UseHistogramFieldShape: true
  FieldResponseFname:     "FieldResponse/dune35t_response_v1.0.root"
  FieldResponseHistoName: "FieldResponse"

  IndUFieldShape: "[0]*(1.0+[3]*tanh(x-[4]))*([4]-x)*exp(-0.5*((x-[4])/[2])^2.0)"
  IndUFieldParams:  [.00843,.1534,1.77,0.,0.5]    #last parameter needs to be half of FFT vector, correct for in code
  IndVFieldShape: "[0]*(1.0+[3]*tanh(x-[4]))*([4]-x)*exp(-0.5*((x-[4])/[2])^2.0)"
  IndVFieldParams:  [.00843,.1534,1.77,0.,0.5]    #last parameter needs to be half of FFT vector, correct for in code
  ColFieldShape: "x^[2]/(1.0+(x/[0])^[1])"
  ColFieldParams: [ 8.0,16.0,.75 ]

  DebugFieldShape: false
}

# 35t is the same for now

dune35t_signalshapingservice:   @local::dunefd_signalshapingservice
### Previous default settings
#dune35t_signalshapingservice.ADCPerPCAtLowestASICGain: 11700 #ADC/pC   (For correct Digitization)
#dune35t_signalshapingservice.ASICGainInMVPerFC: [7.8, 7.8, 7.8] #mV/fC for Ind & col planes
#dune35t_signalshapingservice.ShapeTimeConst:  [ 2.0, 2.0, 2.0 ] #Gain and Peaking time (microseconds)
### Bringing in line with data settings, 8th Sept 2016
dune35t_signalshapingservice.ASICGainInMVPerFC: [ 14.0, 14.0, 14.0] #mV/fC for Ind & col planes
dune35t_signalshapingservice.ShapeTimeConst:    [ 3.0 , 3.0 , 3.0 ] #Gain and Peaking time (microseconds)
#
# 3x1x1, protoDUNE and DUNE dual-phase signal service
#

# ProtoDUNE single phase
protodunesp_signalshapingservice: @local::dunefd_signalshapingservice
protodunesp_signalshapingservice.ColFilter: "(x>0.0)*gaus"
protodunesp_signalshapingservice.ColFilterParams: [ 1.0, 0.0, 0.1 ]
protodunesp_signalshapingservice.IndUFilter: "(x>0.0)*gaus"
protodunesp_signalshapingservice.IndUFilterParams: [ 1.0, 0.0, 0.1 ]
protodunesp_signalshapingservice.IndVFilter: "(x>0.0)*gaus"
protodunesp_signalshapingservice.IndVFilterParams: [ 1.0, 0.0, 0.1 ]


dunefddphase_signalshapingservice:
{
  AreaNorm:  35.64   # in units (ADC x us) / fC	
  ADCpermV:  1.0     # ADC conversion factor (not used at the moment)
  AmpENC:    1000.0  # noise in electrons from TDR
  DeconNorm: 70.0
  ShapeFunc: "1/([0]-[1]) * ( exp(-(x)/[0]) - exp(-(x)/[1]) )"
  ShapeFuncParams: [0.5, 4.0]
  RespSamplingPeriod: 400. # in nano second
 
  AddFieldFunction: false
  ColFieldFunction: "x*[0]"
  ColFieldFunctionParams: [1.0]
  ColFieldRespAmp: 1.0

  ColFilter:       "[0]*exp(-1.2*(((x-[1])/[2])^2)^[3])"
  ColFilterParams: [ 1.0, 0.0, 0.136, 2.5 ]
  #FieldFunctionParameters: [1.0, 1.0, 1.0, 1.0] #0 step width #1 step height #2 slow/fast (could be taken from E field) #Tau (could be taken from field and temperature). 0 and Tau in us
}

# ProtoDUNE dual phase
protodunedphase_signalshapingservice: @local::dunefddphase_signalshapingservice
protodunedphase_signalshapingservice.ColFilter: "(x>0.0)*gaus"
protodunedphase_signalshapingservice.ColFilterParams: [ 1.0, 0.0, 0.1 ]

# 3x1x1 dual phase TPC
dunedphase3x1x1_signalshapingservice: @local::dunefddphase_signalshapingservice
dunedphase3x1x1_signalshapingservice.AreaNorm:   16.84 
dunedphase3x1x1_signalshapingservice.AreaNorm1m: 23.58
dunedphase3x1x1_signalshapingservice.ShapeFunc: "[0]*exp((x-[1])/[2]) / ( 1 + exp((x-[1])/[3]))"        #obtained from pulsed waveform fit
dunedphase3x1x1_signalshapingservice.ShapeFuncParams: [1.21581, 0.864873, 0.288648, 0.27413]		#obtained from pulsed waveform fit
dunedphase3x1x1_signalshapingservice.ShapeFunc1m: "[0]*exp((x-[1])/[2]) / ( 1 + exp((x-[1])/[3]))"      #obtained from pulsed waveform fit
dunedphase3x1x1_signalshapingservice.ShapeFuncParams1m: [1.46135, 1.0228, 0.336029, 0.29685]		#obtained from pulsed waveform fit

END_PROLOG
BEGIN_PROLOG

no_mag:
{
FieldDescriptions: [ { UseField:         0  # 0--off 1--Constant field
                                            # 2--Field map (not implemented)
                       ConstantField:    [ 0.0, 0.0, 0.0 ]
                       MagnetizedVolume: "volWorld" } ]
}

no_mag_larsoft: @local::no_mag

END_PROLOG
BEGIN_PROLOG

standard_database:
{
  DBHostName:		"fnalpgsdev.fnal.gov"
  DBName:		"uboonedaq_dev"
  DBUser:		"uboonedaq_reader"
  Port:			5436
  PassFileName:		".pswd"
  ToughErrorTreatment:  false                #if true, throw cet::exception at DB connection error
  ShouldConnect:        false
  TableName:    	"main_run"
}

END_PROLOG

BEGIN_PROLOG


dunefd_database:               @local::standard_database
dunefd_database.DBName:	       "dune_dev"
dunefd_database.DBUser:	       "dune_reader"
dunefd_database.Port:	       5438
dunefd_database.PassFileName:  ".lpswd"
dunefd_database.ShouldConnect: false # enable it when DB is available
dunefd_database.ToughErrorTreatment: false # enable it when DB is available too

dune35t_database:               @local::standard_database
dune35t_database.DBName:        "dune_dev"
dune35t_database.DBUser:        "dune_reader"
dune35t_database.Port:          5438
dune35t_database.PassFileName:  ".lpswd"
dune35t_database.ShouldConnect: false # enable it when DB is available
dune35t_database.ToughErrorTreatment: false # enable it when DB is available too


END_PROLOG
BEGIN_PROLOG

PIProv: {
  G4ModuleLabel: "largeant"
  EveIdCalculator: "EmEveIdCalculator"
}
standard_particleinventoryservice: {
  ParticleInventory: @local::PIProv
}

jp250L_particleinventoryservice:     @local::standard_particleinventoryservice
bo_particleinventoryservice:         @local::standard_particleinventoryservice
argoneut_particleinventoryservice:   @local::standard_particleinventoryservice
microboone_particleinventoryservice: @local::standard_particleinventoryservice
#dune35t_particleinventoryservice:    @local::standard_particleinventoryservice
#dunefd_particleinventoryservice:     @local::standard_particleinventoryservice

END_PROLOG



BEGIN_PROLOG

providerBKConf:{
 G4ModuleLabel:            "largeant" # module that produced the sim::Particle objects
 SimChannelModuleLabel:    "largeant" # module that produced the sim::SimChannel objects, if not provided defaults to using the G4ModuleLabel
 MinimumHitEnergyFraction: 0.1        # minimum fraction of energy a G4 trackID contributes to a hit to be 
                                      # counted in hit based efficiency and purity calculations
}

standard_backtrackerservice:

{
 BackTracker: @local::providerBKConf
}

jp250L_backtrackerservice:     @local::standard_backtrackerservice

bo_backtrackerservice:         @local::standard_backtrackerservice

argoneut_backtrackerservice:   @local::standard_backtrackerservice

microboone_backtrackerservice: @local::standard_backtrackerservice

#dune35t_backtrackerservice:    @local::standard_backtrackerservice

#dunefd_backtrackerservice:     @local::standard_backtrackerservice

END_PROLOG


BEGIN_PROLOG

dune35t_backtrackerservice:    @local::standard_backtrackerservice
dunefd_backtrackerservice:     @local::standard_backtrackerservice

END_PROLOG
BEGIN_PROLOG

PIProv: {
  G4ModuleLabel: "largeant"
  EveIdCalculator: "EmEveIdCalculator"
}
standard_particleinventoryservice: {
  ParticleInventory: @local::PIProv
}

jp250L_particleinventoryservice:     @local::standard_particleinventoryservice
bo_particleinventoryservice:         @local::standard_particleinventoryservice
argoneut_particleinventoryservice:   @local::standard_particleinventoryservice
microboone_particleinventoryservice: @local::standard_particleinventoryservice
#dune35t_particleinventoryservice:    @local::standard_particleinventoryservice
#dunefd_particleinventoryservice:     @local::standard_particleinventoryservice

END_PROLOG



BEGIN_PROLOG

dune35t_particleinventoryservice:    @local::standard_particleinventoryservice
dunefd_particleinventoryservice:     @local::standard_particleinventoryservice
#dune35t_particleinventoryservice.ParticleInventory.EveIdCalculator: "EveIdCalculator"
#dunefd_particleinventoryservice.ParticleInventory.EveIdCalculator: "EveIdCalculator"

END_PROLOG
BEGIN_PROLOG

PIProv: {
  G4ModuleLabel: "largeant"
  EveIdCalculator: "EmEveIdCalculator"
}
standard_particleinventoryservice: {
  ParticleInventory: @local::PIProv
}

jp250L_particleinventoryservice:     @local::standard_particleinventoryservice
bo_particleinventoryservice:         @local::standard_particleinventoryservice
argoneut_particleinventoryservice:   @local::standard_particleinventoryservice
microboone_particleinventoryservice: @local::standard_particleinventoryservice
#dune35t_particleinventoryservice:    @local::standard_particleinventoryservice
#dunefd_particleinventoryservice:     @local::standard_particleinventoryservice

END_PROLOG


BEGIN_PROLOG

providerPBKConf:{
 G4ModuleLabel:            "largeant" # module that produced the sim::Particle and sim::SimChannel objects
 MinimumHitEnergyFraction: 0.1        # minimum fraction of energy a G4 trackID contributes to a hit to be 
                                      # counted in hit based efficiency and purity calculations
 Delay:                    0          #This number is the difference between when light arrives at the detector, and the time recorded in OpHits. This number is experiment specific and should be set by each experiment. 
}

standard_photonbacktrackerservice:
{
 PhotonBackTracker: @local::providerPBKConf
}

END_PROLOG


#
# File:    seedservice_dune.fcl
# Desc:    custom configurations of NuRandomService for DUNE
# Author:  Gianluca Petrillo (petrillo@fnal.gov)
# Date:    February 13th, 2015
# Version: 1.0
# 
# The default configuration is the "random" policy, that defies the goal of the
# seed service altogether.
# 
# Changes:
# 13022015 (petrillo@fnal.gov) [v1.0]
#   first version; not many choices here
# 
#

#
# File:    NuRandomService.fcl
# Brief:   Default configuration for random seed service
# Author:  Gianluca Petrillo (petrillo@fnal.gov)
# Date:    February 5th, 2015
# Version: 1.0
# 
# The default configuration for the seed service uses the autoIncrement policy.
# 
# Use this as:
# 
# services.NuRandomService: @local::standard_NuRandomService
# 
# 
# Changes:
# 20150205 (petrillo@fnal.gov) [v1.0]
#   first version
#

BEGIN_PROLOG


autoincrement_NuRandomService: {
  # policy: autoIncrement
  # each time a seed is requested, a counter is increased and its value returned
  # as seed; the first seed returned is baseSeed
  policy            :    "autoIncrement"
  
  # this is the first seed that is returned;
  # override it with:
  # 
  # services.NuRandomService.baseSeed: MySeed
  # 
  baseSeed          : 2829
  
  # since this is a generic configuration and we don't know how many seeds there
  # are going to be around, we just skip the range check
  checkRange        : false
  
  # print into the log all seeds at the end of the job
  endOfJobSummary   :  true
} # autoincrement_NuRandomService


linearmapping_NuRandomService: {
  # policy: linearIncrement
  # each time a seed is requested, a counter is increased and its value returned
  # as seed; the first seed returned is nJob x maxUniqueEngines
  policy            :    "linearMapping"
  
  # this is the number of this job in an absolute batch count; override it with:
  # 
  # services.NuRandomService.nJob: NJOB
  #
  nJob            :  1
  maxUniqueEngines: 20
  
  # make sure that we don't try to use more engines than we are allowed;
  # that would mean overlapping random seeds with the next job
  checkRange      :  true
  
  # print into the log all seeds at the end of the job
  endOfJobSummary   :  true
} # linearmapping_NuRandomService


random_NuRandomService: {
  # policy: random
  # each time a seed is requested, a random number is returned.
  # 
  policy            :    "random"
  
  # if you really want this sequence of seeds to be reproducible,
  # insert here a seed for the random seed generator
  # baseSeed          : 64429
  
  # print into the log all seeds at the end of the job
  endOfJobSummary   :  true
} # random_NuRandomService


per_event_NuRandomService: {
  # policy: perEvent
  # on each event, the seed is computed from event information
  # 
  policy            :    "perEvent"
  
  # print into the log all seeds at the end of the job
  endOfJobSummary   :  false
} # per_event_NuRandomService


# choose our autoIncrement configuration as "standard"
standard_NuRandomService: @local::autoincrement_NuRandomService


END_PROLOG


BEGIN_PROLOG

# 
# the random policy extracts unpredictable, random seeds in a way similar to the
# behaviour that existed before NuRandomService.
# You don't want this for production.
# 
dune_seedservice: @local::random_NuRandomService # from seedservice.fcl


END_PROLOG
BEGIN_PROLOG

# the "standard" values are supposed to be good for ArgoNeuT
standard_detectorclocks:
{
  service_provider: "DetectorClocksServiceStandard"
  
  TrigModuleName:    ""
  InheritClockConfig: true
  G4RefTime:         0     # G4 time [us] where electronics clock counting start
  TriggerOffsetTPC:  0     # Time offset for TPC readout start time w.r.t. trigger [us]
  FramePeriod:       405.504 # Frame period [us]; 2048 * 198 ns
  ClockSpeedTPC:     5.0505  # TPC clock speed in MHz; 1 / 198.0 ns
  ClockSpeedOptical: 64    # Optical clock speed in MHz
  ClockSpeedTrigger: 16    # Trigger clock speed in MHz
  ClockSpeedExternal:31.25 # External clock speed in MHz
  DefaultTrigTime:   0     # Default trigger time in electronics clock [us]
  DefaultBeamTime:   0     # Default beam gate time in electronics clock [us]
}

END_PROLOG

BEGIN_PROLOG

dunefd_detectorclocks: @local::standard_detectorclocks

# dunefd_detectorclocks.TrigModuleName:      ""
dunefd_detectorclocks.InheritClockConfig:   false
dunefd_detectorclocks.G4RefTime:            0.  # G4 time [us] where electronics clock counting start
dunefd_detectorclocks.TriggerOffsetTPC:     0.  # Time [us] for TPC readout start w.r.t. trigger time
dunefd_detectorclocks.FramePeriod:       1600.  # Frame period [us]
dunefd_detectorclocks.ClockSpeedTPC:        2.  # TPC clock speed in MHz
dunefd_detectorclocks.ClockSpeedOptical:   62.5 # Optical clock speed in MHz
dunefd_detectorclocks.ClockSpeedTrigger:   16.  # Trigger clock speed in MHz
dunefd_detectorclocks.DefaultTrigTime:      0.  # Default trigger time [us].
dunefd_detectorclocks.DefaultBeamTime:      0.  # Default beam time [us].


dunefddphase_detectorclocks: @local::standard_detectorclocks
# dunefddphase_detectorclocks.TrigModuleName:      ""
dunefddphase_detectorclocks.InheritClockConfig:   false
dunefddphase_detectorclocks.G4RefTime:            0.    # G4 time [us] where electronics clock counting start
dunefddphase_detectorclocks.TriggerOffsetTPC:     0.    # Time [us] for TPC readout start w.r.t. trigger time
dunefddphase_detectorclocks.FramePeriod:          8000. # Frame period [us]
dunefddphase_detectorclocks.ClockSpeedTPC:        2.5   # TPC clock speed in MHz
dunefddphase_detectorclocks.ClockSpeedOptical:    250.  # Optical clock speed in MHz
dunefddphase_detectorclocks.ClockSpeedTrigger:    16.   # Trigger clock speed in MHz
dunefddphase_detectorclocks.DefaultTrigTime:      0.    # Default trigger time [us].
dunefddphase_detectorclocks.DefaultBeamTime:      0.    # Default beam time [us].

protodunedphase_detectorclocks: @local::dunefddphase_detectorclocks
protodunedphase_detectorclocks.FramePeriod:         4000. # Frame period [us]
protodunedphase_detectorclocks.ClockSpeedOptical:   62.5  # Optical clock speed in MHz

dune35t_detectorclocks: @local::standard_detectorclocks

# dune35t_detectorclocks.TrigModuleName:      ""
dune35t_detectorclocks.InheritClockConfig:   false
dune35t_detectorclocks.G4RefTime:            0. # G4 time [us] where electronics clock counting start
dune35t_detectorclocks.TriggerOffsetTPC:     0. # Time [us] for TPC readout start w.r.t. trigger time
dune35t_detectorclocks.FramePeriod:       2600. # Frame period [us]
dune35t_detectorclocks.ClockSpeedTPC:        2. # TPC clock speed in MHz
dune35t_detectorclocks.ClockSpeedOptical:  128. # Optical clock speed in MHz
dune35t_detectorclocks.ClockSpeedTrigger:   16. # Trigger clock speed in MHz
dune35t_detectorclocks.DefaultTrigTime:      0. # Default trigger time [us].
dune35t_detectorclocks.DefaultBeamTime:      0. # Default beam time [us].

# Implement new 6000 tick readout window (500 before trigger, or 250 us)
protodune_detectorclocks: @local::standard_detectorclocks

protodune_detectorclocks.InheritClockConfig:   false
protodune_detectorclocks.G4RefTime:            -250. # G4 time [us] where electronics clock counting start
protodune_detectorclocks.TriggerOffsetTPC:  -250. # Time [us] for TPC readout start w.r.t. trigger time (500 ticks)
protodune_detectorclocks.FramePeriod:       1600. # Frame period [us]
protodune_detectorclocks.ClockSpeedTPC:        2. # TPC clock speed in MHz
protodune_detectorclocks.ClockSpeedOptical:  150. # Optical clock speed in MHz
protodune_detectorclocks.ClockSpeedTrigger:   16. # Trigger clock speed in MHz
protodune_detectorclocks.DefaultTrigTime:     250. # Default trigger time [us].
protodune_detectorclocks.DefaultBeamTime:     250. # Default beam time [us].

dunedphase3x1x1_detectorclocks: @local::dunefddphase_detectorclocks
dunedphase3x1x1_detectorclocks.ClockSpeedOptical:  250. # Optical clock speed in MHz

END_PROLOG
# Contains information required for:
# Timing parameterisation for VUV photons (propagation time)

BEGIN_PROLOG

# VUV/DIRECT LIGHT: TIMING PARAMETERISATION
# Parameters of the Landau + Exponential (<= 350 cm) and Landau (> 350 cm) models
# Landau parameters
Distances_landau_generic: [0, 25, 50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 525, 550]
Norm_over_entries_generic: [ [4.64837, 4.64837, 2.86581, 1.4143, 0.974871, 0.71311, 0.55772, 0.461078, 0.411807, 0.364951, 0.325477, 0.297132, 0.297132, 0.297132, 0.297132, 0.297132,0.297132, 0.297132,
		0.297132, 0.297132, 0.297132, 0.297132, 0.297132],
		[3.43562, 3.43562, 1.61042, 0.981127, 0.64465, 0.476552, 0.369063, 0.310461, 0.264819, 0.231387, 0.215373, 0.199128, 0.189638, 0.170387, 0.159308, 0.151498,0.140134, 0.135217, 0.131114, 0.129511, 0.126329, 0.12452, 0.124595] ]
Mpv_generic: [	[2.73373, 2.73373, 3.599, 5.80141, 7.57883, 9.56959, 11.6047, 13.6676, 15.6126, 17.5389, 19.492, 21.3254, 21.3254, 21.3254, 21.3254, 21.3254, 21.3254, 21.3254, 21.3254, 21.3254, 21.3254,
		21.3254, 21.3254],
		[2.19076, 2.19076, 4.0163, 5.86531, 8.09466, 10.4547, 12.9261, 15.2731, 17.7939, 20.6664, 22.99, 25.7017, 27.9139, 30.9469, 33.6378, 36.1413, 39.8435, 42.1625, 44.6396, 46.5133, 48.6331, 50.6754, 53.3949] ]
Width_generic: [ [0.198303, 0.198303, 0.347397, 0.562874, 0.750881, 0.998318, 1.2622, 1.55553, 1.79799, 2.05579, 2.3295, 2.57611, 2.57611, 2.57611, 2.57611, 2.57611,2.57611, 2.57611, 2.57611, 2.57611,
		2.57611, 2.57611, 2.57611],
		[0.305766, 0.305766, 0.508544, 0.747765, 1.12059, 1.57047, 2.07501, 2.54661, 3.09789, 3.79078, 4.19731, 4.74438, 5.09894, 5.83702, 6.36225, 6.80253, 8.278, 8.717, 9.2568, 9.7239, 10.5865, 11.3262, 11.8423] ]
# Exponential parameters
Distances_exp_generic: [0, 25, 50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375]
Slope_generic: [ [-0.181318, -0.181318, -0.148935, -0.126243, -0.10837, -0.0860558, -0.0759728, -0.0706126, -0.0672814, -0.0622897, -0.0577351, -0.0546709, -0.0546709, -0.0546709, -0.0546709, -0.0546709],
			[-0.169274, -0.169274, -0.119906, -0.0983691, -0.0781793, -0.0659805, -0.0587059, -0.0545288, -0.0514041, -0.0489773, -0.047259, -0.0454668, -0.0439597, -0.0415122, -0.0396851, -0.0378005] ]
Expo_over_Landau_norm_generic: [ [0.0149644, 0.0149644, 0.0337403, 0.0967895, 0.152669, 0.181732, 0.23025, 0.290033, 0.338948, 0.372986, 0.404828, 0.441243, 0.441243, 0.441243, 0.441243, 0.441243],
							[0.0252807, 0.0252807, 0.0638727, 0.113343, 0.165669, 0.216794, 0.274868, 0.325299, 0.38959, 0.466117, 0.515046, 0.578897, 0.621872, 0.689713, 0.742833, 0.773619] ]


# *************************************************************************************************
#  VUV time model, generic for all experiments (at first order)
# *************************************************************************************************

common_vuv_timing_parameterization:
{
  # Timing parameterisaion:
  #
  # Parameters of the Landau + Exponential (<= 350 cm) and Landau (> 350 cm) models
  # Landau parameters
  Distances_landau: @local::Distances_landau_generic
  Norm_over_entries: @local::Norm_over_entries_generic
  Mpv: @local::Mpv_generic
  Width: @local::Width_generic

  # Exponential parameters
  Distances_exp: @local::Distances_exp_generic
  Slope: @local::Slope_generic

  # Normalisations
  Expo_over_Landau_norm:  @local::Expo_over_Landau_norm_generic

  # Discretisation step size in cm
  step_size: 1.
  # Min and maximum distance in cm parameterisations are generated for (only generated when required to prevent long initial loading time)
  max_d: 2500.
  min_d: 25.
  # VUV group velocity in cm/ns
  vuv_vgroup_mean: 13.5
  vuv_vgroup_max: 18.
  # Distance in cm from "Landau + Expo" -> "Single Landau" model
  inflexion_point_distance: 350.

  # angular bin size in deg, must correspond to parameterisation set
  angle_bin_timing_vuv: 45
}


END_PROLOG










BEGIN_PROLOG

standard_photonvisibilityservice:
{

  NX: 75
  NY: 75
  NZ: 400
  UseCryoBoundary: true
  Interpolate: false

  DoNotLoadLibrary: false

  LibraryBuildJob: false

  #LibraryFile: "PhotonPropagation/LibraryData/lib8984855.root"
  LibraryFile: "PhotonPropagation/LibraryData/uboone_photon_library_v4.root"

 #These are not used when usecryoboundary=true
  XMin: -120
  XMax: 120
  YMin: -120
  YMax: 120
  ZMin: 0
  ZMax: 1200
}

microboone_photonvisibilityservice: @local::standard_photonvisibilityservice

protodunedp_photonvisibilityservice_buildlib:
{

  NX: 29
  NY: 24
  NZ: 24
  UseCryoBoundary: false

  DoNotLoadLibrary: true

  LibraryBuildJob: true

  LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"

 #These are not used when usecryoboundary=true
  XMin: -420.5
  XMax: 304.5
  YMin: -300
  YMax: 300
  ZMin: 0
  ZMax: 600
}
#Bea

standard_photonvisibilityservice_buildlib:
{

  NX: 75
  NY: 75
  NZ: 400
  UseCryoBoundary: true
  Interpolate: false

  DoNotLoadLibrary: true

  LibraryBuildJob: true

  LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"


 #These are not used  when usecryoboundary=true
  XMin: 100
  XMax: 110
  YMin: -100
  YMax: 100
  ZMin: 500
  ZMax: 600

}


standard_photonvisibilityservice_par:
{
  NX: 125
  NY: 1
  NZ: 1
  UseCryoBoundary: false
  Interpolate: false
  DUNE10ktParameterization: true
  DoNotLoadLibrary: true

  LibraryBuildJob: false

  LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"
  XMin: -627
  XMax: -389
  YMin: -1.
  YMax: 1.
  ZMin: -1.00
  ZMax: 1.00

}

standard_library_vuv_prop_timing_photonvisibilityservice:
{
   # Start from the standard visibility service
   @table::standard_photonvisibilityservice

   # Flag to enable time parameterizations
   IncludePropTime: true

   # Generic VUV timing parameterization
   @table::common_vuv_timing_parameterization

}



END_PROLOG


# Contains information required for:
# Timing parameterisation Visible photons
# Corrections for semi-analytic number of hits models for VUV and visible light

# *************************************************************************************************
#          PARAMETERS SETS FOR SEMI-ANALYTIC SIMULATION ARE DEFINED HERE                        
# *************************************************************************************************     
BEGIN_PROLOG

# VUV/DIRECT LIGHT: TIMING PARAMETERISATION
# DUNE-SP
# Parameters of the Landau + Exponential (<= 400 cm) and Landau (> 400 cm) models
# Landau parameters
Distances_landau_dune: [0, 25, 50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 525, 550, 575, 600, 625, 650, 675, 700, 725]
Norm_over_entries_dune: [ [27.41, 27.41, 2.57134, 1.47775, 0.96034, 0.668723, 0.487808, 0.362789, 0.277659, 0.224883, 0.185199, 0.159048, 0.143393, 0.134121, 0.125978, 0.115751,
						   0.0921523, 0.0907023, 0.0856498, 0.0814134, 0.0750844, 0.0750844, 0.0750844, 0.0750844, 0.0750844, 0.0750844, 0.0750844, 0.0750844, 0.0750844, 0.0750844],
						  [3.79032, 3.79032, 1.25862, 0.928939, 0.566822, 0.319336, 0.331336, 0.219171, 0.178579, 0.135635, 0.119011, 0.109138, 0.0991792, 0.091753, 0.0787281, 0.0743768,
						   0.0663083, 0.0648284, 0.0608437, 0.0572599, 0.0561134, 0.0543579, 0.0529609, 0.0519021, 0.0510434, 0.0504866, 0.0503902, 0.0507405, 0.0503883, 0.0497511] ]	
Mpv_dune: [ [1.77134, 1.77134, 3.85131, 5.593, 7.46645, 9.44108, 11.5899, 13.8189, 16.2753, 18.8619, 21.6428, 24.4828, 27.189, 29.6607, 32.3706, 35.2212, 41.4392, 43.2475, 45.939, 48.5748,
			 51.4841, 51.4841, 51.4841, 51.4841, 51.4841, 51.4841, 51.4841, 51.4841, 51.4841, 51.4841],
			[1.91282, 1.91282, 4.31774, 5.90297, 8.90329, 11.8104, 12.9629, 17.0555, 19.5031, 24.7774, 27.175, 29.8128, 33.5619, 36.6553, 43.0021, 46.059, 52.6953, 55.1056, 59.9728, 65.2979,
			 67.9593, 71.0675, 74.7855, 79.689, 85.3232, 90.818, 97.0409, 103.2, 111.306, 117.6] ]
Width_dune: [ [0.10303, 0.10303, 0.313506, 0.525492, 0.716541, 0.969894, 1.29961, 1.73657, 2.30482, 2.94669, 3.71951, 4.53258, 5.24435, 5.79945, 6.53951, 7.34736, 12.0305, 12.4263, 13.4917,
			   14.7245, 16.6202, 16.6202, 16.6202, 16.6202, 16.6202, 16.6202, 16.6202, 16.6202, 16.6202, 16.6202],
			[0, 0.281535, 0.633816, 0.80694, 1.46701, 2.32209, 2.20895, 3.56751, 4.23966, 6.11748, 6.97923, 7.82035, 9.05225, 10.1422, 12.6053, 13.6305, 17.7093, 18.3244, 19.9961, 22.1072,
			 23.4653, 25.3052, 27.5297, 30.5683, 34.8304, 39.7456, 45.1447, 51.3363, 58.4681, 63.0122] ]
# Exponential parameters
Distances_exp_dune: [0, 25, 50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375]
Slope_dune: [ [-0.205783, -0.205783, -0.157344, -0.124546, -0.0949427, -0.0640574, -0.0509928, -0.0421876, -0.0360771, -0.0327956, -0.02997, -0.0280924, -0.0269181, -0.0259104, -0.0248679, -0.0233511],
			  [-0.157151, -0.157151, -0.10447, -0.0875509, -0.0605052, -0.0435416, -0.040128, -0.0325951, -0.0292046, -0.0255942, -0.0241776, -0.0226607, -0.0213594, -0.02037, -0.0181767, -0.0172752]	]
Expo_over_Landau_norm_dune:[ [0.00276789, 0.00276789, 0.0362807, 0.081067, 0.111523, 0.106485, 0.123852, 0.144239, 0.168534, 0.201111, 0.234443, 0.269284, 0.300041, 0.320541, 0.342403, 0.356125],
							 [0.0242526, 0.0242526, 0.086063, 0.101552, 0.134787, 0.171863, 0.152519, 0.203461, 0.224872, 0.279135, 0.304123, 0.317034, 0.341433, 0.360053, 0.382877, 0.391287]	]

dune_vuv_timing_parameterization:
{
  # Timing parameterisaion:
  #
  # Parameters of the Landau + Exponential (<= 400 cm) and Landau (> 400 cm) models
  # Landau parameters
  Distances_landau: @local::Distances_landau_dune
  Norm_over_entries: @local::Norm_over_entries_dune
  Mpv: @local::Mpv_dune
  Width: @local::Width_dune

  # Exponential parameters
  Distances_exp: @local::Distances_exp_dune
  Slope: @local::Slope_dune

  # Normalisations
  Expo_over_Landau_norm:  @local::Expo_over_Landau_norm_dune
  
  # Discretisation step size in cm
  step_size: 1.
  # Min and maximum distance in cm parameterisations are generated for (only generated when required to prevent long initial loading time)
  max_d: 2500.
  min_d: 25.
  # VUV group velocity in cm/ns
  vuv_vgroup_mean: 13.5
  vuv_vgroup_max: 18.
  # Distance in cm from "Landau + Expo" -> "Single Landau" model
  inflexion_point_distance: 400.

  # angular bin size in deg, must correspond to parameterisation set 
  angle_bin_timing_vuv: 45
}

# VISIBLE/REFLECTED LIGHT: TIMING PARAMETERISATION
# DUNE-SP
Distances_refl_dune: [38, 63, 88, 113, 138, 163, 188, 213, 238, 263, 288, 313, 338, 353, 358]
Distances_radial_refl_dune: [9.9, 155.0, 253.8, 360.4, 493.2, 594.6, 695.0, 793.2, 830.7]
Cut_off_dune: [
	[	[238.142, 262.539, 282.467, 304.103, 313.013, 337.946, 351.788, 370.942, 376.018, 399.713, 402.083, 408.105, 417.89, 412.451, 411.424],
		[234.078, 262.073, 276.731, 296.061, 311.584, 335.31, 343.996, 359.014, 388.386, 382.394, 405.658, 389.855, 391.849, 417.002, 391.142],
		[233.826, 252.701, 276.161, 295.549, 310.688, 335.343, 333.014, 337.877, 356.375, 365.452, 402.048, 391.411, 387.041, 413.637, 398.582],
		[225.568, 247.426, 269.423, 286.49, 303.236, 312.539, 326.313, 352.405, 354.358, 365.515, 378.07, 386.568, 398.617, 402.382, 395.867],
		[206.919, 228.745, 245.808, 264.952, 278.443, 288.442, 310.195, 322.811, 338.748, 343.625, 353.131, 355.457, 366.05, 369.961, 378.918],
		[195.67, 212.402, 231.2, 246.909, 260.37, 281.104, 290.402, 307.977, 319.123, 326.379, 335.987, 353.426, 346.63, 361.703, 363.194],
		[179.417, 194.449, 215.019, 226.811, 243.818, 255.429, 269.983, 283.393, 295.032, 322.433, 315.948, 318.471, 334.817, 334.004, 326.318],
		[154.088, 172.471, 186.44, 202.967, 218.924, 230.281, 238.207, 258.663, 271.877, 286.323, 291.957, 311.479, 303.508, 312.419, 309.705],
		[149.199, 155.503, 178.764, 184.767, 202.839, 224.528, 215.482, 254.813, 263.972, 284.013, 267.734, 296.432, 262.43, 290.437, 297.707]
	],
	[	[246.114, 267.915, 289.986, 310.104, 324.638, 338.566, 350.776, 359.952, 376.386, 397.82, 394.869, 401.497, 405.346, 414.755, 415.781],
		[241.62, 263.039, 289.868, 305.077, 313.714, 340.302, 356.721, 357.657, 371.048, 380.499, 398.234, 418.922, 405.413, 409.476, 417.102],
		[235.542, 261.916, 282.016, 291.492, 310.319, 327.492, 344.385, 347.677, 365.039, 377.724, 381.374, 386.969, 401.347, 400.177, 392.453],
		[231.138, 253.043, 267.715, 288.464, 302.387, 319.26, 336.987, 348.065, 356.25, 367.535, 380.868, 392.95, 401.268, 393.072, 398.283],
		[209.369, 229.45, 250.276, 264.609, 278.103, 297.421, 307.095, 318.774, 334.469, 347.171, 355.64, 367.906, 371.06, 370.87, 362.123],
		[196.244, 215.249, 230.764, 250.963, 266.498, 279.546, 291.107, 303.001, 318.605, 328.869, 342.382, 359.313, 366.458, 369.223, 358.119],
		[184.429, 199.611, 215.199, 233.223, 248.347, 259.588, 273.831, 280.22, 301.123, 309.877, 324.337, 322.588, 336.158, 348.089, 342.262],
		[163.799, 173.141, 186.3, 209.323, 218.793, 239.084, 248.589, 263.359, 280.873, 296.201, 302.956, 300.096, 338.428, 320.21, 347.723],
		[159.08, 168.789, 187.417, 191.038, 210.331, 228.405, 242.7, 236.532, 269.892, 260.173, 294.648, 297.787, 275.243, 302.138, 290.968]
	],
	[	[250.152, 271.721, 292.124, 311.523, 329.303, 343.734, 362.045, 366.858, 382.884, 400.433, 406.645, 409.91, 417.259, 428.088, 407.686],
		[252.276, 275.258, 288.838, 310.399, 327.316, 339.202, 351.951, 368.195, 375.032, 393.038, 393.904, 404.939, 417.412, 420.595, 422.597],
		[251.722, 266.857, 286.031, 308.488, 323.711, 346.602, 343.121, 357.83, 374.251, 381.872, 372.149, 387.304, 409.728, 411.447, 410.004],
		[240.087, 259.048, 275.438, 295.691, 305.374, 326.708, 336.045, 348.531, 358.766, 373.367, 382.088, 387.178, 391.358, 405.445, 395.087],
		[224.314, 240.819, 254.926, 275.897, 288.594, 299.172, 314.15, 330.417, 336.821, 344.778, 365.24, 371.447, 385.373, 375.14, 374.112],
		[205.355, 224.417, 239.403, 258.428, 271.66, 287.509, 297.811, 313.956, 320.703, 334.091, 344.374, 361.311, 366.204, 365.306, 367.546],
		[190.018, 208.128, 221.75, 239.984, 252.689, 266.927, 274.063, 294.34, 301.445, 320.925, 322.24, 323.328, 341.146, 346.377, 349.755],
		[170.674, 189.917, 202.617, 213.842, 236.233, 248.568, 258.162, 262.287, 276.896, 294.559, 316.76, 324.476, 311.464, 327.771, 331.841],
		[169.668, 183.312, 187.508, 200.981, 212.417, 236.757, 269.173, 245.208, 258.3, 271.882, 295.175, 301.368, 339.273, 303.657, 369.413]
	],
	[	[268.411, 287.711, 310.138, 327.283, 341.435, 357.335, 362.876, 376.574, 393.192, 405.168, 411.973, 415.355, 441.712, 432.722, 418.311],
		[266.584, 286.971, 305.596, 320.476, 337.923, 351.821, 366.981, 374.848, 385.234, 393.006, 404.982, 413.931, 425.926, 421.121, 425.801],
		[261.993, 280.575, 299.544, 318.33, 325.544, 344.972, 356.23, 373.51, 387.219, 396.378, 398.942, 411.78, 411.588, 415.474, 421.921],
		[252.691, 272.887, 290.423, 307.003, 321.859, 335.324, 348.868, 359.32, 369.915, 382.051, 390.864, 399.574, 406.162, 413.715, 408.825],
		[231.161, 250.362, 267.743, 282.66, 299.151, 311.695, 325.55, 339.417, 342.855, 360.101, 366.804, 376.354, 385.595, 383.735, 387.496],
		[223.802, 242.346, 258.778, 274.166, 289.391, 302.706, 314.21, 326.552, 339.073, 346.064, 358.127, 368.062, 370.487, 380.508, 379.736],
		[209.682, 226.531, 241.313, 256.21, 264.927, 281.465, 295.416, 309.286, 321.698, 328.597, 337.654, 353.108, 351.508, 359.492, 361.487],
		[187.512, 201.319, 218.477, 233.414, 244.586, 256.582, 279.252, 279.741, 295.446, 293.343, 320.52, 336.582, 339.989, 343.045, 340.432],
		[180.437, 197.944, 213.83, 224.059, 234.645, 247.69, 267.21, 282.661, 286.906, 313.713, 293.626, 312.821, 325.558, 328.303, 321.306]
	],
	[	[289.914, 310.613, 329.894, 346.834, 362.554, 372.419, 384.793, 393.546, 402.812, 411.007, 419.004, 430.365, 441.083, 441.259, 437.297],
		[286.756, 307.854, 324.357, 340.695, 354.491, 364.467, 379.269, 391.891, 402.363, 408.025, 419.366, 428.493, 434.019, 440.659, 436.065],
		[279.033, 296.285, 313.944, 331.667, 345.103, 354.968, 369.805, 382.226, 386.45, 396.353, 400.613, 407.224, 424.528, 432.519, 432.064],
		[273.681, 292.67, 310.219, 324.72, 342.19, 353.709, 365.811, 377.256, 386.862, 394.211, 401.592, 409.289, 416.512, 419.69, 423.459],
		[252.821, 275.881, 290.547, 305.052, 318.76, 335.804, 344.923, 356.796, 366.782, 381.396, 387.095, 399.874, 405.188, 395.59, 396.829],
		[241.638, 258.4, 275.728, 290.884, 304.633, 317.739, 328.808, 340.59, 348.825, 362.143, 368.125, 377.143, 385.422, 385.222, 386.957],
		[226.83, 244.956, 259.492, 274.426, 289.393, 302.835, 314.495, 322.783, 335.687, 355.561, 357.564, 357.478, 371.557, 378.319, 370.383],
		[212.082, 228.509, 236.565, 253.59, 267.431, 283.445, 284.471, 304.654, 296.006, 315.46, 308.214, 337.028, 363.737, 356.049, 373.881],
		[196.033, 212.916, 223.279, 251.964, 242.766, 263.733, 291.691, 279.277, 297.816, 324.128, 314.101, 307.537, 333.769, 315.3, 342.75]
	],
	[	[317.145, 339.108, 351.234, 370.602, 384.28, 396.29, 409.31, 413.407, 421.532, 434.873, 439.394, 443.384, 451.087, 456.285, 457.325],
		[315.413, 335.463, 348.423, 362.104, 377.276, 389.744, 403.802, 411.179, 422.892, 432.348, 438.45, 441.921, 448.542, 452.471, 451.429],
		[305.073, 328.132, 342.54, 362.058, 375.405, 385.718, 393.883, 408.134, 414.017, 418.398, 429.967, 435.605, 443.127, 440.059, 443.341],
		[300.377, 320.323, 338.408, 353.011, 366.344, 379.359, 389.862, 399.703, 411.283, 420.3, 424.452, 432.673, 434.343, 444.682, 440.862],
		[287.98, 307.368, 323.144, 334.702, 354.845, 362.485, 376.778, 389.867, 390.533, 407.059, 409.517, 425.574, 422.651, 423.41, 429.774],
		[276.238, 294.784, 309.133, 324.364, 337.144, 350.274, 361.762, 373.534, 382.108, 391.929, 401.297, 405.202, 413.818, 419.689, 416.02],
		[262.281, 279.619, 295.647, 310.085, 319.474, 334.1, 341.682, 356.275, 365.639, 373.632, 379.667, 386.258, 401.139, 396.662, 401.901],
		[245.975, 256.794, 270.759, 286.402, 294.829, 310.752, 311.267, 339.42, 343.369, 350.604, 366.277, 361.594, 368.364, 355.674, 369.305],
		[235.344, 257.089, 258.486, 281.143, 284.383, 303.073, 306.858, 326.585, 338.617, 321.156, 322.864, 329.046, 359.368, 355.674, 369.305]
	],
	[	[334.426, 352.052, 370.23, 385.701, 403.089, 408.619, 422.697, 433.641, 439.893, 445.838, 454.844, 458.215, 476.382, 464.554, 470.144],
		[340.243, 356.894, 377.823, 394.276, 405.493, 419.526, 434.314, 440.167, 443.042, 458.305, 468.73, 465.418, 472.132, 470.263, 462.614],
		[339.215, 362.833, 378.653, 395.823, 407.574, 422.286, 436.592, 441.063, 452.994, 456.981, 467.009, 470.162, 469.083, 459.116, 467.666],
		[344.218, 361.56, 381.444, 395.986, 411.238, 423.926, 432.097, 440.824, 447.115, 453.197, 458.719, 456.588, 457.549, 456.965, 458.706],
		[329.449, 354.474, 368.595, 384.864, 398.536, 404.866, 418.107, 418.085, 423.491, 437.099, 437.718, 438.779, 426.195, 417.562, 433.152],
		[318.299, 340.232, 356.692, 372.494, 381.415, 389.127, 399.887, 407.163, 416.273, 425.423, 425.546, 424.873, 427.99, 421.374, 426.463],
		[304.056, 324.602, 339.293, 354.503, 368.104, 371.605, 380.829, 394.825, 400.773, 399.075, 404.887, 395.319, 435.121, 421.374, 426.463],
		[289.905, 307.94, 320.584, 333.673, 342.04, 355.414, 350.113, 355.944, 374.679, 361.003, 344.637, 344.637, 344.637, 344.637, 344.637],
		[275.799, 301.852, 298.569, 322.502, 323.555, 313.801, 355.564, 356.182, 352.22, 361.003, 344.637, 344.637, 344.637, 344.637, 344.637]
	],
	[	[334.426, 352.052, 370.23, 385.701, 403.089, 408.619, 422.697, 433.641, 439.893, 445.838, 454.844, 458.215, 476.382, 464.554, 470.144],
		[340.243, 356.894, 377.823, 394.276, 405.493, 419.526, 434.314, 440.167, 443.042, 458.305, 468.73, 465.418, 472.132, 470.263, 462.614],
		[365.256, 359.335, 415.055, 443.803, 424.261, 416.686, 440.291, 418.294, 444.172, 459.347, 468.73, 465.418, 472.132, 470.263, 462.614],
		[360.086, 378.063, 406.997, 424.072, 432.338, 440.556, 433.113, 452.443, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[353.058, 373.677, 388.688, 397.716, 412.013, 421.769, 428.094, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[345.571, 367.631, 372.833, 394.278, 397.663, 403.512, 434.616, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[334.075, 347.187, 361.561, 384.265, 355.218, 380.568, 357.21, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[317.175, 328.915, 321.654, 347.725, 355.218, 380.568, 357.21, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[297.486, 328.915, 321.654, 347.725, 355.218, 380.568, 357.21, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614]
	],
	[	[334.426, 352.052, 370.23, 385.701, 403.089, 408.619, 422.697, 433.641, 439.893, 445.838, 454.844, 458.215, 476.382, 464.554, 470.144],
		[340.243, 356.894, 377.823, 394.276, 405.493, 419.526, 434.314, 440.167, 443.042, 458.305, 468.73, 465.418, 472.132, 470.263, 462.614],
		[365.256, 359.335, 415.055, 443.803, 424.261, 416.686, 440.291, 418.294, 444.172, 459.347, 468.73, 465.418, 472.132, 470.263, 462.614],
		[360.086, 378.063, 406.997, 424.072, 432.338, 440.556, 433.113, 452.443, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[353.058, 373.677, 388.688, 397.716, 412.013, 421.769, 428.094, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[345.571, 367.631, 372.833, 394.278, 397.663, 403.512, 434.616, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[334.075, 347.187, 361.561, 384.265, 355.218, 380.568, 357.21, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[317.175, 328.915, 321.654, 347.725, 355.218, 380.568, 357.21, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614],
		[297.486, 328.915, 321.654, 347.725, 355.218, 380.568, 357.21, 437.208, 453.272, 454.871, 468.73, 465.418, 472.132, 470.263, 462.614]
	] 
	]
Tau_dune: [
		[	[5.96457, 5.07719, 4.99409, 4.04206, 3.53897, 3.0151, 2.77687, 2.46537, 2.36831, 2.28361, 2.26549, 2.17181, 2.12092, 3.06882, 3.0436],
			[5.80839, 5.17184, 4.87524, 4.17199, 3.46809, 2.91644, 2.75975, 2.56292, 2.26832, 2.21301, 2.24002, 2.28156, 2.1818, 3.1583, 3.04179],
			[5.87934, 5.23502, 5.15792, 4.09652, 3.54772, 3.10177, 2.73277, 2.47171, 2.39474, 2.16523, 2.18489, 1.99915, 2.25365, 2.97022, 3.02243],
			[6.00006, 5.26829, 5.13125, 4.17978, 3.37219, 3.04936, 2.75519, 2.43612, 2.22506, 2.13109, 2.00007, 1.99631, 1.98842, 2.94804, 2.90546],
			[5.95748, 5.05141, 4.91095, 3.8922, 3.22227, 2.68021, 2.41203, 2.0989, 1.85643, 1.73013, 1.61917, 1.64845, 1.63141, 2.7203, 2.67036],
			[5.30483, 4.56571, 4.44116, 3.55242, 2.78611, 2.18762, 2.04502, 1.84214, 1.57797, 1.44502, 1.38835, 1.4049, 1.44472, 2.30442, 2.31722],
			[5.20936, 4.57521, 4.40278, 3.40163, 2.56094, 1.99053, 1.81989, 1.66047, 1.35575, 1.09994, 1.1028, 1.09432, 1.03686, 2.00878, 2.03789],
			[4.71532, 3.72214, 3.64817, 2.99707, 2.30805, 1.50375, 1.09049, 1.15702, 0.905575, 0.803875, 0.682886, 0.569838, 0.564455, 1.61338, 1.34808],
			[4.61481, 3.5, 3.48475, 2.63262, 2.20024, 1.3916, 0.912768, 0.831398, 0.6641, 0.683397, 0.342592, 0.459747, 0.543871, 1.19306, 1.00357]
		],
		[	[6.0354, 5.31897, 5.19515, 4.25833, 3.61615, 3.18563, 2.88475, 2.60235, 2.53525, 2.21919, 2.25335, 2.34856, 2.25909, 3.19966, 3.22475],
			[6.0464, 5.32945, 5.1932, 4.28896, 3.52898, 3.23512, 2.86296, 2.59209, 2.36866, 2.25528, 2.25007, 2.21974, 2.35047, 3.23254, 3.13224],
			[6.11222, 5.35441, 5.16441, 4.24574, 3.68976, 3.23508, 2.83299, 2.63325, 2.27689, 2.15337, 2.09911, 2.17209, 2.2334, 3.15524, 3.07361],
			[6.09937, 5.46468, 5.22791, 4.19851, 3.5083, 3.15777, 2.81754, 2.4285, 2.26929, 2.06762, 1.98974, 2.01879, 2.06496, 3.01153, 2.88765],
			[5.88905, 5.07605, 4.83864, 3.75214, 3.07813, 2.67385, 2.35779, 2.13925, 1.89796, 1.81738, 1.65085, 1.67909, 1.63433, 2.64777, 2.43649],
			[5.2949, 4.677, 4.43335, 3.52238, 2.78443, 2.21877, 2.04896, 1.84461, 1.60476, 1.51221, 1.36126, 1.4131, 1.40436, 2.37343, 2.33066],
			[5.21743, 4.7055, 4.31696, 3.47348, 2.52611, 2.12585, 1.83055, 1.58977, 1.37549, 1.3169, 1.16925, 1.16713, 1.20449, 2.10184, 1.99436],
			[4.82782, 4.04738, 3.91726, 3.02788, 2.32794, 1.45675, 1.27683, 1.16405, 0.9229, 0.780128, 0.703169, 0.60968, 0.714072, 1.50203, 1.37557],
			[4.55414, 3.75576, 3.41954, 2.76907, 2.30544, 0.894174, 0.750302, 0.700783, 0.903002, 0.878854, 0.378455, 0.36607, 0.431089, 1.22243, 1.09718]
		],
		[	[6.30532, 5.60024, 5.34123, 4.38091, 3.72383, 3.2309, 3.00245, 2.67961, 2.53174, 2.42812, 2.27821, 2.26919, 2.26511, 3.41929, 3.25572],
			[6.33204, 5.59122, 5.3709, 4.34319, 3.70327, 3.34205, 2.99071, 2.75068, 2.47161, 2.38718, 2.28385, 2.34122, 2.3472, 3.27431, 3.25456],
			[6.51237, 5.63528, 5.41695, 4.48751, 3.77619, 3.29131, 2.98481, 2.68307, 2.47005, 2.40157, 2.26803, 2.13715, 2.37985, 3.19582, 3.14273],
			[6.38164, 5.69179, 5.39082, 4.39664, 3.63624, 3.27547, 2.88184, 2.48285, 2.31915, 2.18514, 2.10008, 2.10826, 2.11103, 3.05862, 3.01733],
			[6.17303, 5.31955, 5.07852, 4.05035, 3.24062, 2.89892, 2.56912, 2.27691, 2.00998, 1.80968, 1.79265, 1.74122, 1.82872, 2.69963, 2.78144],
			[5.5858, 4.92838, 4.57836, 3.5107, 2.81288, 2.41324, 2.20307, 1.89004, 1.71106, 1.56746, 1.45846, 1.44826, 1.50469, 2.49477, 2.42593],
			[5.51546, 4.93658, 4.58396, 3.4126, 2.60389, 2.19155, 2.02662, 1.68914, 1.42189, 1.36414, 1.17042, 1.10321, 1.24776, 2.0897, 2.03952],
			[5.06723, 4.40759, 4.10753, 3.16073, 2.18927, 1.7288, 1.63416, 1.29918, 0.997631, 0.820509, 0.789512, 0.850946, 0.736224, 1.74511, 1.60892],
			[4.65552, 3.9, 3.64344, 2.54465, 1.80187, 1.31079, 1.33674, 0.891947, 0.593747, 0.4, 0.502183, 0.682269, 0.390691, 1.49123, 1.02849]
		],
		[	[6.75642, 6.06817, 5.87681, 4.80277, 4.23382, 3.75152, 3.30471, 2.95263, 2.71149, 2.57796, 2.44351, 2.54557, 2.41178, 3.53858, 3.48403],
			[6.83135, 6.05778, 5.81198, 4.84431, 4.14284, 3.70326, 3.32696, 2.99773, 2.72409, 2.56572, 2.47494, 2.49247, 2.50532, 3.46651, 3.36307],
			[6.84789, 6.08566, 5.83316, 4.81693, 4.1458, 3.69117, 3.23996, 2.93105, 2.68579, 2.47281, 2.37393, 2.45876, 2.39122, 3.35189, 3.29926],
			[6.84636, 6.08253, 5.69911, 4.6721, 4.08545, 3.58488, 3.12926, 2.74636, 2.54662, 2.31262, 2.2613, 2.26762, 2.25569, 3.19658, 3.18455],
			[6.49128, 5.78555, 5.32809, 4.24672, 3.70856, 3.17328, 2.73308, 2.36785, 2.15334, 1.97175, 1.90532, 1.87916, 1.91024, 2.78953, 2.71248],
			[6.24264, 5.45843, 5.03932, 3.88499, 3.34187, 2.90307, 2.51025, 2.18007, 1.94563, 1.7878, 1.70413, 1.70052, 1.71355, 2.63874, 2.6075],
			[6.01898, 5.22599, 4.75741, 3.61371, 3.08217, 2.68607, 2.2824, 1.87414, 1.66293, 1.4659, 1.3717, 1.42102, 1.38114, 2.37376, 2.21817],
			[5.44261, 4.75737, 4.25017, 3.09949, 2.43497, 2.21826, 1.97049, 1.50531, 1.3505, 1.08725, 1.04406, 1.07537, 0.983351, 2.02946, 1.82382],
			[5.08645, 4.34396, 4.06995, 3.01142, 2.27373, 2.05021, 1.67649, 1.35703, 1.07818, 0.942589, 0.686917, 0.733439, 0.771787, 1.50469, 1.44095]
		],
		[	[7.84001, 7.02445, 6.74358, 5.5386, 4.90811, 4.34112, 3.82917, 3.5689, 3.23996, 2.94809, 2.88278, 2.84453, 2.80638, 4.0044, 4.18463],
			[7.96009, 6.95661, 6.78903, 5.51254, 4.86418, 4.30601, 3.81578, 3.40455, 3.13029, 2.86049, 2.81298, 2.84908, 2.74574, 4.16914, 4.05354],
			[7.64827, 6.54719, 6.17865, 5.2985, 4.59742, 4.02522, 3.50602, 3.14964, 2.90949, 2.70429, 2.57336, 2.5472, 2.47571, 3.54201, 3.61743],
			[7.92974, 6.8201, 6.53271, 5.3015, 4.6803, 4.02622, 3.5493, 3.17292, 2.88242, 2.66675, 2.57216, 2.5529, 2.54433, 3.68363, 3.55278],
			[7.50926, 6.24039, 5.87378, 4.83272, 4.22972, 3.60808, 3.16498, 2.76932, 2.41256, 2.28326, 2.1555, 2.19621, 2.18935, 3.09921, 3.0988],
			[6.90993, 5.82666, 5.38618, 4.41604, 3.76803, 3.19472, 2.75083, 2.46497, 2.16963, 2.00052, 1.92475, 1.89236, 1.95252, 2.86288, 2.78449],
			[6.79507, 5.57163, 5.20405, 4.12369, 3.58091, 2.99103, 2.54424, 2.17971, 2.01767, 1.74572, 1.69754, 1.65578, 1.60057, 2.5256, 2.40649],
			[6.31946, 5.20894, 4.51979, 3.56933, 3.16501, 2.43612, 2.08959, 1.78385, 1.62104, 1.407, 1.39481, 1.20874, 1.09917, 2.25184, 2.24809],
			[5.33467, 4.6119, 4.10264, 3.11051, 2.61035, 2.16347, 1.86028, 1.27061, 1.10083, 0.850165, 0.939195, 0.866033, 0.690194, 1.64104, 1.80895]
		],
		[	[11.9489, 11.6668, 11.4536, 8.75265, 7.29591, 5.8583, 5.18062, 4.55981, 4.05805, 3.69915, 3.63494, 3.67833, 3.57395, 6.25726, 6.16591],
			[11.5272, 10.9288, 10.6557, 7.95326, 6.82772, 5.48559, 4.81446, 4.22457, 3.79079, 3.65687, 3.44221, 3.40137, 3.45342, 5.81608, 5.80147],
			[11.6217, 11.1327, 10.4278, 7.58228, 6.26671, 5.39903, 4.82228, 4.33599, 3.68319, 3.50228, 3.29511, 3.25208, 3.46974, 5.38972, 5.08396],
			[11.3782, 10.8611, 10.2243, 7.33279, 6.34183, 5.13152, 4.48945, 3.99859, 3.55543, 3.29182, 3.15649, 3.1397, 3.21847, 5.20982, 5.26709],
			[10.1716, 9.64567, 8.83558, 6.31549, 5.35836, 4.57666, 4.08414, 3.56821, 3.23444, 2.91008, 2.83799, 2.81835, 2.76454, 4.37497, 4.30567],
			[9.48217, 8.56376, 7.79515, 5.63876, 4.8723, 4.1671, 3.60072, 3.20289, 2.8427, 2.63474, 2.45615, 2.48961, 2.44924, 3.85715, 3.66625],
			[8.46821, 7.57236, 7.05438, 5.13544, 4.3476, 3.70969, 3.22497, 2.79637, 2.51378, 2.30093, 2.18766, 2.15998, 2.01708, 3.32403, 3.09411],
			[7.18484, 5.91973, 5.55348, 4.29947, 3.67089, 3.0072, 2.66158, 2.24491, 2.00604, 1.75675, 1.8134, 1.70376, 1.64657, 2.56667, 2.67337],
			[6.23207, 5.36007, 4.89431, 3.75472, 3.11033, 2.67796, 2.23625, 1.90829, 1.82338, 1.53467, 1.44333, 1.40512, 1.27021, 2.201, 1.92327]
		],
		[	[12.8483, 12.6112, 12.1786, 10.7614, 9.50222, 8.44859, 7.11133, 6.25161, 5.71591, 5.32326, 5.00089, 5.03042, 4.35032, 8.00854, 8.23766],
			[12.7549, 12.3904, 12.0204, 10.9497, 10.2474, 8.7457, 7.96587, 7.32252, 6.306, 5.67946, 5.73712, 5.93768, 5.79708, 8.65708, 8.56371],
			[12.8645, 12.3741, 12.2352, 11.1243, 10.5757, 9.44869, 8.23989, 7.92367, 7.0601, 6.47817, 6.18098, 6.55385, 6.19273, 8.82035, 8.99372],
			[12.6959, 12.2643, 11.8785, 11.114, 10.4208, 9.2111, 8.36877, 7.85155, 7.32856, 6.84506, 6.66631, 7.00608, 6.78541, 8.93225, 8.70316],
			[12.5452, 12.1665, 11.7269, 10.5075, 9.56439, 8.71867, 7.79231, 7.45348, 6.66866, 6.28284, 6.24135, 6.26647, 6.39461, 8.55639, 8.20468],
			[12.0541, 11.3451, 11.0524, 9.65751, 8.7969, 7.42591, 6.70033, 6.20258, 5.65834, 5.27534, 5.27716, 5.42423, 5.26033, 7.49567, 7.41311],
			[11.8893, 11.1326, 10.7512, 8.99326, 7.97202, 6.8874, 5.82871, 5.46771, 4.88342, 4.59128, 4.5547, 4.84998, 4.43973, 6.89836, 6.49232],
			[11.1333, 9.90586, 8.9442, 7.35071, 6.71618, 5.3712, 4.813, 4.33659, 3.7798, 4.04402, 4.32291, 4.15208, 4.78329, 6.53315, 6.18305],
			[9.94244, 8.48604, 8.53327, 6.53562, 5.64959, 4.67588, 4.18134, 3.98564, 3.30388, 2.98186, 2.92041, 3.63641, 4.14041, 6.11911, 5.40965]
		],
		[	[12.8483, 12.6112, 12.1786, 10.7614, 9.50222, 8.44859, 7.11133, 6.25161, 5.71591, 5.32326, 5.00089, 5.03042, 4.35032, 8.00854, 8.23766],
			[12.7549, 12.3904, 12.0204, 10.9497, 10.2474, 8.7457, 7.96587, 7.32252, 6.306, 5.67946, 5.73712, 5.93768, 5.79708, 8.65708, 8.56371],
			[13.4325, 12.4414, 12.0743, 11.6842, 12.2388, 11.4144, 9.28914, 9.97593, 12.2348, 9.23503, 8.62783, 6.85223, 9.81417, 8.79908, 11.2756],
			[12.6473, 12.3558, 12.0081, 11.4888, 11.3523, 10.3128, 10.0266, 10.0789, 9.05136, 9.28551, 8.64309, 8.74761, 8.55587, 9.7955, 9.75475],
			[12.4278, 12.2977, 12.0395, 11.353, 11.5152, 10.5393, 10.037, 9.54046, 9.11765, 8.77425, 8.45984, 8.54731, 7.86723, 9.67888, 9.54721],
			[12.5007, 12.0753, 11.7489, 11.1458, 10.678, 10.0927, 9.50329, 8.96, 8.76761, 8.53607, 7.89683, 7.93522, 7.75269, 9.07914, 8.74846],
			[12.3884, 11.8697, 11.624, 10.8656, 10.6545, 9.59602, 9.52584, 8.67707, 7.70351, 7.24507, 7.2763, 7.02563, 7.10897, 7.90916, 8.13517],
			[12.1068, 11.6689, 11.471, 10.1856, 9.82679, 8.55115, 8.34593, 7.57929, 6.29319, 6.88384, 6.11757, 5.89828, 5.9847, 7.454, 7.15065],
			[12.0139, 11.3105, 10.4283, 9.12612, 9.78714, 7.83548, 7.75834, 6.48438, 6.1277, 5.22, 5.56125, 4.61427, 5.17356, 6.55659, 6.21537]
		],
		[	[12.8483, 12.6112, 12.1786, 10.7614, 9.50222, 8.44859, 7.11133, 6.25161, 5.71591, 5.32326, 5.00089, 5.03042, 4.35032, 8.00854, 8.23766],
			[12.7549, 12.3904, 12.0204, 10.9497, 10.2474, 8.7457, 7.96587, 7.32252, 6.306, 5.67946, 5.73712, 5.93768, 5.79708, 8.65708, 8.56371],
			[13.4325, 12.4414, 12.0743, 11.6842, 12.2388, 11.4144, 9.28914, 9.97593, 12.2348, 9.23503, 8.62783, 6.85223, 9.81417, 8.79908, 11.2756],
			[12.6473, 12.3558, 12.0081, 11.4888, 11.3523, 10.3128, 10.0266, 10.0789, 9.05136, 9.28551, 8.64309, 8.74761, 8.55587, 9.7955, 9.75475],
			[12.4278, 12.2977, 12.0395, 11.353, 11.5152, 10.5393, 10.037, 9.54046, 9.11765, 8.77425, 8.45984, 8.54731, 7.86723, 9.67888, 9.54721],
			[12.5007, 12.0753, 11.7489, 11.1458, 10.678, 10.0927, 9.50329, 8.96, 8.76761, 8.53607, 7.89683, 7.93522, 7.75269, 9.07914, 8.74846],
			[12.3884, 11.8697, 11.624, 10.8656, 10.6545, 9.59602, 9.52584, 8.67707, 7.70351, 7.24507, 7.2763, 7.02563, 7.10897, 7.90916, 8.13517],
			[12.1068, 11.6689, 11.471, 10.1856, 9.82679, 8.55115, 8.34593, 7.57929, 6.29319, 6.88384, 6.11757, 5.89828, 5.9847, 7.454, 7.15065],
			[12.0139, 11.3105, 10.4283, 9.12612, 9.78714, 7.83548, 7.75834, 6.48438, 6.1277, 5.22, 5.56125, 4.61427, 5.17356, 6.55659, 6.21537]
		]
	]

dune_vis_timing_parameterization:
{
  # Timing parameterisation:
  #
  # Smearing parameters
  Distances_refl: @local::Distances_refl_dune
  Distances_radial_refl: @local::Distances_radial_refl_dune
  Cut_off: @local::Cut_off_dune
  Tau: @local::Tau_dune

  # vis velocity in cm/ns
  vis_vmean: 23.99
  
  # angular bin size in deg, must correspond to parameterisation set 
  angle_bin_timing_vis: 10
}


# VUV/DIRECT LIGHT: NUMBER OF HITS CORRECTIONS UPDATED MODEL
# DUNE-SP Gaisser-Hillas 
# Note: corrections include effects of fully simulated wire planes  

# Argon - default
GH_PARS_RS100cm_flat_dune: [ [1.23286, 1.20491, 1.1597, 1.08148, 0.986607, 0.868075, 0.725637, 0.633551, 0.469717],
    						 [150.325, 150.109, 156.294, 169.271, 179.642, 212.9, 232.173, 226.557, 215.166],
			     			 [19.0558, 18.8478, 18.8757, 18.7149, 50.8662, 49.2247, 57.6717, 157.92, 172.494],
			    			 [-3000, -3000, -3000, -3000, -1000, -1000, -1000, -100, -100] ]
GH_border_RS100cm_angulo_flat_dune: [5, 15, 25, 35, 45, 55, 65, 75, 85]
GH_border_RS100cm_flat_dune: [ [-9.63855e-05, -6.82604e-05, -9.63478e-05, -0.000121181, -0.000126611, -0.000115481, -8.61492e-05, -0.000112594, -7.80935e-05],
							   [-0.0662469, -0.0504497, -0.0596321, -0.0418021, -0.0342462, -0.0531668, -0.0522639, -0.0578887, -0.0591081],
							   [-0.00593207, -0.00672713, -0.0020843, -0.00216374, 0.00901291, 0.00385402, 0.0066081, 0.0341547, 0.0446519] ]

dune_vuv_RS100cm_hits_parameterization:
{
 FlatPDCorr: true
 GH_PARS_flat: @local::GH_PARS_RS100cm_flat_dune
 GH_border_angulo_flat: @local::GH_border_RS100cm_angulo_flat_dune
 GH_border_flat: @local::GH_border_RS100cm_flat_dune
 
 DomePDCorr: false

 delta_angulo_vuv: 10

 PMT_radius: 10.16
}

# Xenon
GH_PARS_Xenon_flat_dune: [ [0.959653, 0.92975, 0.874812, 0.790038, 0.685581, 0.566253, 0.433698, 0.31073, 0.197959],
  						   [94.2397, 94.5496, 104.245, 139.412, 189.763, 192.723, 340.598, 501.523, 503.954],
  						   [385.308, 413.922, 405.968, 371.839, 330.268, 484.33, 513.097, 512.926, 253.092],
  						   [-400, -400, -400, -400, -400, -400, -400, -400, -400] ]

GH_border_Xenon_angulo_flat_dune: [5, 15, 25, 35, 45, 55, 65, 75, 85]
GH_border_Xenon_flat_dune: [ [0.000212425, 0.000200659, 0.000179874, 0.000165088, 0.00015168, 0.000122913, 8.94813e-05, 3.98645e-05, 1.24325e-13],
							 [0.151348, 0.168286, 0.153929, 0.12419, 0.0834517, 0.0955464, -0.0175567, -0.112032, -1.98752e-10],
							 [-0.114771, -0.19272, -0.182644, -0.130611, -0.115369, -0.279817, -0.276752, -0.294378, 0.0783223] ]

dune_vuv_Xenon_hits_parameterization:
{
 FlatPDCorr: true
 GH_PARS_flat: @local::GH_PARS_Xenon_flat_dune
 GH_border_angulo_flat: @local::GH_border_Xenon_angulo_flat_dune
 GH_border_flat: @local::GH_border_Xenon_flat_dune
 
 DomePDCorr: false

 delta_angulo_vuv: 10

 PMT_radius: 10.16
}


# VIS/REFLECTED LIGHT: NUMBER OF HITS CORRECTIONS & PARAMETERS
# DUNE-SP Parameters
# Note: corrections include effects of fully simulated wire planes  

# Argon - default  
VIS_distances_x_flat_dune_argon: [3, 13, 38, 63, 88, 113, 138, 163, 188, 213, 238, 263, 288, 313, 338, 353]
VIS_distances_r_flat_dune_argon: [54.1115, 154.253, 269.706, 367.262, 496.739, 605.581, 693.216, 782.765, 862.208]

VIS_correction_flat_dune_argon: [ 
	[ [1.67995, 1.5023, 1.20657, 1.02106, 0.882746, 0.776639, 0.695785, 0.629938, 0.582714, 0.545081, 0.515464, 0.493708, 0.472181, 0.45963, 0.439441, 0.419622],
	  [1.68963, 1.51982, 1.23126, 1.03816, 0.900409, 0.796292, 0.713189, 0.649865, 0.602912, 0.564819, 0.539057, 0.517199, 0.505427, 0.492089, 0.481653, 0.449229],
	  [1.73304, 1.55607, 1.26007, 1.07054, 0.934781, 0.832277, 0.759501, 0.704314, 0.658422, 0.627825, 0.606923, 0.591168, 0.584167, 0.580226, 0.563891, 0.529764],
	  [1.78193, 1.60802, 1.31866, 1.1289, 0.9946, 0.893599, 0.81836, 0.762132, 0.722593, 0.690561, 0.67056, 0.655973, 0.654003, 0.647708, 0.640756, 0.605073],
	  [1.96176, 1.77259, 1.47397, 1.2754, 1.13531, 1.02732, 0.942267, 0.880779, 0.828975, 0.794916, 0.771843, 0.751323, 0.74329, 0.744061, 0.733977, 0.70005],
	  [2.21549, 2.04521, 1.72647, 1.48965, 1.31053, 1.17082, 1.06559, 0.98202, 0.921138, 0.873365, 0.841385, 0.81795, 0.807915, 0.803652, 0.795182, 0.753378],
	  [2.3808, 2.20671, 1.89092, 1.64262, 1.4475, 1.29706, 1.17708, 1.08489, 1.01635, 0.962341, 0.926461, 0.904984, 0.894703, 0.894324, 0.890895, 0.844522],
	  [2.7039, 2.5078, 2.18003, 1.93111, 1.71334, 1.54146, 1.39972, 1.29637, 1.19956, 1.13696, 1.08587, 1.04728, 1.03061, 1.03128, 1.04224, 1.06682],
	  [3.28429, 3.14942, 2.81891, 2.46231, 2.13464, 1.86717, 1.63899, 1.46508, 1.32431, 1.22158, 1.13801, 1.07975, 1.04774, 1.0268, 1.00872, 0.934299]	  
	],
	[ [1.61717, 1.45536, 1.18141, 1.00703, 0.877535, 0.778688, 0.700656, 0.640282, 0.593421, 0.554809, 0.526049, 0.504949, 0.486008, 0.471742, 0.454623, 0.438439],
	  [1.63238, 1.47453, 1.21037, 1.02925, 0.896804, 0.79514, 0.717278, 0.658347, 0.611546, 0.575992, 0.548571, 0.52959, 0.516161, 0.505923, 0.495831, 0.470395],
	  [1.67016, 1.50472, 1.23162, 1.05456, 0.927059, 0.833322, 0.761788, 0.709941, 0.667458, 0.638414, 0.61695, 0.600871, 0.595867, 0.589934, 0.576962, 0.547778],
	  [1.72845, 1.56667, 1.29773, 1.1202, 0.992758, 0.898139, 0.826881, 0.772625, 0.73407, 0.70565, 0.685211, 0.673677, 0.669364, 0.665694, 0.661327, 0.62945],
	  [1.93974, 1.75853, 1.4716, 1.28379, 1.14714, 1.04343, 0.963162, 0.902172, 0.851864, 0.820813, 0.796031, 0.78107, 0.77271, 0.768238, 0.767237, 0.738134],
	  [2.11276, 1.94999, 1.65909, 1.44723, 1.28647, 1.16348, 1.0694, 0.995028, 0.937634, 0.896204, 0.86791, 0.850113, 0.843451, 0.841015, 0.839559, 0.805772],
	  [2.27089, 2.10995, 1.82097, 1.60253, 1.42969, 1.2978, 1.18599, 1.10159, 1.03826, 0.991185, 0.957985, 0.940432, 0.930111, 0.936145, 0.929783, 0.895972],
	  [2.675, 2.49434, 2.18241, 1.9411, 1.7415, 1.57744, 1.43963, 1.33051, 1.24657, 1.17447, 1.13066, 1.09834, 1.08741, 1.0859, 1.10706, 1.12759],
	  [2.96947, 2.85863, 2.57822, 2.2702, 1.98558, 1.75909, 1.56001, 1.40263, 1.27867, 1.18196, 1.11067, 1.05927, 1.03217, 1.0172, 0.9976, 0.934535]	  
	],
	[ [1.50825, 1.36889, 1.13392, 0.98191, 0.866922, 0.77688, 0.707548, 0.651111, 0.606337, 0.572121, 0.544768, 0.525048, 0.509095, 0.494043, 0.47836, 0.45858],
	  [1.52415, 1.38959, 1.16104, 1.00319, 0.886744, 0.794913, 0.724086, 0.670173, 0.625644, 0.593862, 0.570216, 0.551808, 0.53998, 0.532302, 0.522777, 0.495825],
	  [1.56948, 1.42471, 1.18729, 1.03115, 0.919158, 0.834466, 0.770977, 0.72419, 0.686219, 0.660066, 0.641763, 0.630002, 0.623834, 0.621193, 0.608531, 0.576298],
	  [1.64288, 1.50027, 1.26387, 1.10682, 0.992256, 0.906822, 0.84274, 0.793871, 0.758439, 0.733316, 0.71634, 0.706797, 0.70469, 0.703601, 0.697613, 0.662949],
	  [1.86287, 1.70058, 1.44341, 1.27538, 1.15264, 1.05872, 0.986552, 0.931587, 0.88889, 0.860201, 0.839109, 0.827028, 0.82099, 0.820279, 0.818245, 0.783072],
	  [1.96894, 1.83178, 1.5845, 1.40403, 1.26573, 1.15779, 1.07672, 1.01293, 0.961107, 0.927483, 0.903816, 0.891158, 0.88809, 0.89041, 0.887703, 0.850857],
	  [2.11486, 1.98106, 1.74011, 1.55249, 1.40211, 1.28869, 1.18925, 1.11334, 1.0575, 1.01646, 0.989677, 0.978543, 0.972021, 0.97899, 0.974276, 0.938631],
	  [2.4422, 2.2967, 2.05021, 1.85131, 1.67819, 1.53385, 1.41887, 1.3196, 1.24542, 1.18909, 1.14934, 1.12965, 1.12177, 1.13114, 1.14473, 1.17223],
	  [2.5988, 2.52471, 2.32597, 2.09048, 1.86465, 1.67534, 1.50487, 1.3751, 1.26983, 1.18503, 1.1275, 1.08634, 1.06218, 1.05617, 1.042, 0.977655]	  
	],
	[ [1.36203, 1.25143, 1.06416, 0.940405, 0.846393, 0.770026, 0.710644, 0.663008, 0.625575, 0.597437, 0.572537, 0.555241, 0.5426, 0.528512, 0.515126, 0.496204],
	  [1.37792, 1.27147, 1.08773, 0.961108, 0.864395, 0.789027, 0.729774, 0.681964, 0.647106, 0.619295, 0.599427, 0.585466, 0.575829, 0.57062, 0.562177, 0.533077],
	  [1.43685, 1.32193, 1.12809, 1.00146, 0.908067, 0.837362, 0.783724, 0.745501, 0.715154, 0.694964, 0.681247, 0.673038, 0.671752, 0.672051, 0.6613, 0.626777],
	  [1.56602, 1.4446, 1.24389, 1.10849, 1.00957, 0.935897, 0.880299, 0.839168, 0.809274, 0.788491, 0.775715, 0.770102, 0.771824, 0.774011, 0.770752, 0.734038],
	  [1.65725, 1.52999, 1.32736, 1.19666, 1.10039, 1.0278, 0.972371, 0.929854, 0.898858, 0.878205, 0.86608, 0.860904, 0.861646, 0.866037, 0.86557, 0.831242],
	  [1.78054, 1.67683, 1.48465, 1.34081, 1.22965, 1.14298, 1.07772, 1.0273, 0.983856, 0.959071, 0.943603, 0.93805, 0.9416, 0.947582, 0.949896, 0.911353],
	  [1.86241, 1.76882, 1.59574, 1.45292, 1.33642, 1.24684, 1.16578, 1.10885, 1.06611, 1.03589, 1.01871, 1.01663, 1.01979, 1.03478, 1.04109, 0.997536],
	  [2.02194, 1.92338, 1.76362, 1.63216, 1.522, 1.41935, 1.33986, 1.27154, 1.22612, 1.18624, 1.16734, 1.16245, 1.16453, 1.18303, 1.20928, 1.24244],
	  [2.1917, 2.15394, 2.03866, 1.88331, 1.71926, 1.57749, 1.44916, 1.34803, 1.26762, 1.20227, 1.16045, 1.13188, 1.12252, 1.12368, 1.11628, 1.04992]	  
	],
	[ [1.21192, 1.12501, 0.981162, 0.886385, 0.81395, 0.755101, 0.708174, 0.671753, 0.641806, 0.61953, 0.602772, 0.590021, 0.580067, 0.570257, 0.558218, 0.538113],
	  [1.23759, 1.15185, 1.01135, 0.912632, 0.836856, 0.778859, 0.73174, 0.695823, 0.668569, 0.649014, 0.634208, 0.625161, 0.621106, 0.617743, 0.612021, 0.582028],
	  [1.3372, 1.24048, 1.08385, 0.981411, 0.906339, 0.850626, 0.809228, 0.780127, 0.757369, 0.744707, 0.737064, 0.735092, 0.739165, 0.743367, 0.733825, 0.697567],
	  [1.39625, 1.3, 1.14429, 1.04039, 0.966035, 0.911477, 0.870675, 0.841821, 0.823572, 0.812433, 0.809316, 0.811214, 0.81902, 0.827248, 0.827171, 0.788705],
	  [1.44179, 1.34299, 1.19297, 1.09814, 1.0303, 0.980126, 0.943691, 0.917849, 0.901886, 0.893587, 0.891415, 0.897052, 0.906638, 0.916486, 0.92216, 0.88791],
	  [1.49443, 1.42303, 1.29061, 1.1906, 1.11335, 1.054, 1.01118, 0.977035, 0.952696, 0.941875, 0.937759, 0.942588, 0.955226, 0.97001, 0.976097, 0.937184],
	  [1.59488, 1.52823, 1.40851, 1.31078, 1.22903, 1.1642, 1.1103, 1.07635, 1.05194, 1.03894, 1.03624, 1.0454, 1.0604, 1.08511, 1.09897, 1.0563],
	  [1.6671, 1.60158, 1.50068, 1.41958, 1.35017, 1.28541, 1.23678, 1.2002, 1.1771, 1.16522, 1.15902, 1.17343, 1.19414, 1.22399, 1.26039, 1.28191],
	  [1.80691, 1.78974, 1.73667, 1.63844, 1.53272, 1.43474, 1.34692, 1.27759, 1.22442, 1.1885, 1.16391, 1.15584, 1.16103, 1.1786, 1.18017, 1.11401]	  
	],
	[ [1.15524, 1.07988, 0.958385, 0.879462, 0.818869, 0.77138, 0.734666, 0.705303, 0.6833, 0.667096, 0.655951, 0.649252, 0.643192, 0.63591, 0.623073, 0.601985],
	  [1.1885, 1.11803, 0.996096, 0.912411, 0.849796, 0.800743, 0.762943, 0.734867, 0.71462, 0.699669, 0.692586, 0.688702, 0.689522, 0.690546, 0.68734, 0.654688],
	  [1.21943, 1.14146, 1.01304, 0.930509, 0.872149, 0.830513, 0.800824, 0.780524, 0.769998, 0.764595, 0.76575, 0.771854, 0.779683, 0.788188, 0.783455, 0.74605],
	  [1.20788, 1.1374, 1.016, 0.939093, 0.884635, 0.847011, 0.820966, 0.805591, 0.798819, 0.798217, 0.804501, 0.816042, 0.829053, 0.845455, 0.849412, 0.807885],
	  [1.22609, 1.15651, 1.04232, 0.974567, 0.928931, 0.897108, 0.877528, 0.866212, 0.863744, 0.866935, 0.876967, 0.892472, 0.910572, 0.927446, 0.932572, 0.902381],
	  [1.2411, 1.19224, 1.09978, 1.03027, 0.978537, 0.939776, 0.916201, 0.895056, 0.892352, 0.893211, 0.902722, 0.91799, 0.938479, 0.962924, 0.974229, 0.933753],
	  [1.26582, 1.22115, 1.14423, 1.08429, 1.0345, 0.996373, 0.971323, 0.956652, 0.952058, 0.956109, 0.968782, 0.993272, 1.02211, 1.05529, 1.07656, 1.03333],
	  [1.30958, 1.26597, 1.20323, 1.15558, 1.11544, 1.08319, 1.06375, 1.04858, 1.04532, 1.05349, 1.06848, 1.0941, 1.12702, 1.17656, 1.21581, 1.2369],
	  [1.4037, 1.39983, 1.37779, 1.32183, 1.25879, 1.19901, 1.1496, 1.11269, 1.0877, 1.07653, 1.07314, 1.08548, 1.10827, 1.1378, 1.15578, 1.08895]	  
	],
	[ [1.27426, 1.19175, 1.05934, 0.973038, 0.909823, 0.861483, 0.821608, 0.792506, 0.771765, 0.757368, 0.747217, 0.742414, 0.737547, 0.731485, 0.71678, 0.692145],
	  [1.20255, 1.13089, 1.00916, 0.927784, 0.866592, 0.821308, 0.786168, 0.762307, 0.744728, 0.735681, 0.730353, 0.731412, 0.734882, 0.737942, 0.735619, 0.700012],
	  [1.11775, 1.04616, 0.93068, 0.857827, 0.808068, 0.773642, 0.75082, 0.738697, 0.73243, 0.732565, 0.738754, 0.748695, 0.762565, 0.776194, 0.769628, 0.732771],
	  [1.07179, 1.00731, 0.90292, 0.837423, 0.793408, 0.763976, 0.745886, 0.737359, 0.736678, 0.742324, 0.753317, 0.769762, 0.790495, 0.807173, 0.813678, 0.775096],
	  [1.03601, 0.974732, 0.88131, 0.827123, 0.790807, 0.768682, 0.757436, 0.752386, 0.755774, 0.765491, 0.780436, 0.799704, 0.82227, 0.842884, 0.853788, 0.823337],
	  [1.03307, 0.991846, 0.91548, 0.859529, 0.820516, 0.793129, 0.777652, 0.768362, 0.770054, 0.779399, 0.79407, 0.814441, 0.839751, 0.866729, 0.880961, 0.845997],
	  [1.03008, 0.992874, 0.929713, 0.880949, 0.843799, 0.817422, 0.802006, 0.796185, 0.79869, 0.808495, 0.827176, 0.856709, 0.884164, 0.920383, 0.943264, 0.906534],
	  [1.02415, 0.989935, 0.938482, 0.901237, 0.870795, 0.848773, 0.834976, 0.830254, 0.834168, 0.845807, 0.865375, 0.892356, 0.929334, 0.969198, 1.00822, 1.02599],
	  [1.03957, 1.03493, 1.01538, 0.973857, 0.928619, 0.889948, 0.858456, 0.837881, 0.827436, 0.826027, 0.834931, 0.852386, 0.879559, 0.910994, 0.936875, 0.913504]	  
	],
	[ [1.27426, 1.19175, 1.05934, 0.973038, 0.909823, 0.861483, 0.821608, 0.792506, 0.771765, 0.757368, 0.747217, 0.742414, 0.737547, 0.731485, 0.71678, 0.692145],
	  [1.20255, 1.13089, 1.00916, 0.927784, 0.866592, 0.821308, 0.786168, 0.762307, 0.744728, 0.735681, 0.730353, 0.731412, 0.734882, 0.737942, 0.735619, 0.700012],
	  [1.27204, 1.18739, 1.05069, 0.967695, 0.90854, 0.865532, 0.834186, 0.818909, 0.812163, 0.810419, 0.819609, 0.833564, 0.843202, 0.852653, 0.848203, 0.808108],
	  [1.16399, 1.0912, 0.971812, 0.897956, 0.847812, 0.814007, 0.793112, 0.782349, 0.77974, 0.785083, 0.797298, 0.813708, 0.836949, 0.850748, 0.858756, 0.823327],
	  [1.0813, 1.01036, 0.908115, 0.84808, 0.807807, 0.782758, 0.769239, 0.763294, 0.761293, 0.773114, 0.787471, 0.805788, 0.826063, 0.847037, 0.862569, 0.827133],
	  [1.02045, 0.976022, 0.894052, 0.833797, 0.791417, 0.761919, 0.742856, 0.734295, 0.73183, 0.737728, 0.749916, 0.76965, 0.79265, 0.817232, 0.830053, 0.807644],
	  [0.975507, 0.937157, 0.869956, 0.817599, 0.777362, 0.749731, 0.72941, 0.719385, 0.718641, 0.725071, 0.738938, 0.762324, 0.788287, 0.822578, 0.847537, 0.840179],
	  [0.966222, 0.927697, 0.869503, 0.827392, 0.792519, 0.765055, 0.749054, 0.737671, 0.736818, 0.741364, 0.756918, 0.782049, 0.816928, 0.862733, 0.911826, 0.947701],
	  [0.941417, 0.931757, 0.901292, 0.852774, 0.802177, 0.759511, 0.726692, 0.705822, 0.699634, 0.699843, 0.718528, 0.749023, 0.787584, 0.845292, 0.91141, 0.966078]	  
	],
	[ [1.27426, 1.19175, 1.05934, 0.973038, 0.909823, 0.861483, 0.821608, 0.792506, 0.771765, 0.757368, 0.747217, 0.742414, 0.737547, 0.731485, 0.71678, 0.692145],
	  [1.20255, 1.13089, 1.00916, 0.927784, 0.866592, 0.821308, 0.786168, 0.762307, 0.744728, 0.735681, 0.730353, 0.731412, 0.734882, 0.737942, 0.735619, 0.700012],
	  [1.27204, 1.18739, 1.05069, 0.967695, 0.90854, 0.865532, 0.834186, 0.818909, 0.812163, 0.810419, 0.819609, 0.833564, 0.843202, 0.852653, 0.848203, 0.808108],
	  [1.16399, 1.0912, 0.971812, 0.897956, 0.847812, 0.814007, 0.793112, 0.782349, 0.77974, 0.785083, 0.797298, 0.813708, 0.836949, 0.850748, 0.858756, 0.823327],
	  [1.0813, 1.01036, 0.908115, 0.84808, 0.807807, 0.782758, 0.769239, 0.763294, 0.761293, 0.773114, 0.787471, 0.805788, 0.826063, 0.847037, 0.862569, 0.827133],
	  [1.02045, 0.976022, 0.894052, 0.833797, 0.791417, 0.761919, 0.742856, 0.734295, 0.73183, 0.737728, 0.749916, 0.76965, 0.79265, 0.817232, 0.830053, 0.807644],
	  [0.975507, 0.937157, 0.869956, 0.817599, 0.777362, 0.749731, 0.72941, 0.719385, 0.718641, 0.725071, 0.738938, 0.762324, 0.788287, 0.822578, 0.847537, 0.840179],
	  [0.966222, 0.927697, 0.869503, 0.827392, 0.792519, 0.765055, 0.749054, 0.737671, 0.736818, 0.741364, 0.756918, 0.782049, 0.816928, 0.862733, 0.911826, 0.947701],
	  [0.941417, 0.931757, 0.901292, 0.852774, 0.802177, 0.759511, 0.726692, 0.705822, 0.699634, 0.699843, 0.718528, 0.749023, 0.787584, 0.845292, 0.91141, 0.966078]	  
	]
]

dune_vis_RS100cm_hits_parameterization:
{
 FlatPDCorr: true
 VIS_distances_x_flat: @local::VIS_distances_x_flat_dune_argon
 VIS_distances_r_flat: @local::VIS_distances_r_flat_dune_argon
 VIS_correction_flat:  @local::VIS_correction_flat_dune_argon

 DomePDCorr: false
 
 delta_angulo_vis: 10

 PMT_radius: 10.16
}

# Xenon
VIS_distances_x_flat_dune_xenon: [3, 13, 38, 63, 88, 113, 138, 163, 188, 213, 238, 263, 288, 313, 338, 353]
VIS_distances_r_flat_dune_xenon: [54.1115, 154.253, 269.706, 367.262, 496.739, 605.581, 693.216, 782.765, 862.208]

VIS_correction_flat_dune_xenon: [ 
	[ [1.42292, 1.31942, 1.14314, 1.03354, 0.954893, 0.895668, 0.850742, 0.813135, 0.784575, 0.769604, 0.758446, 0.747137, 0.748827, 0.763408, 0.776546, 0.769917],
	  [1.41836, 1.32156, 1.15245, 1.03549, 0.955398, 0.893329, 0.844977, 0.803317, 0.780003, 0.762924, 0.754932, 0.749316, 0.753423, 0.764773, 0.775107, 0.73847],
	  [1.43064, 1.32918, 1.15538, 1.04562, 0.957868, 0.902, 0.858058, 0.82298, 0.798712, 0.783286, 0.772047, 0.764398, 0.775728, 0.790624, 0.797297, 0.75866],
	  [1.46201, 1.36552, 1.20406, 1.09302, 1.01223, 0.951456, 0.905415, 0.868787, 0.844916, 0.826713, 0.817526, 0.824628, 0.829448, 0.83788, 0.832992, 0.824314],
	  [1.61987, 1.52623, 1.38658, 1.22113, 1.1464, 1.07976, 1.02709, 0.986773, 0.953123, 0.935845, 0.913943, 0.91304, 0.915525, 0.925434, 0.93213, 0.955269],
	  [1.89154, 1.78597, 1.64064, 1.48965, 1.38724, 1.29546, 1.21908, 1.16388, 1.11387, 1.08341, 1.06077, 1.04836, 1.05, 1.05101, 1.04239, 0.983244],
	  [2.05023, 1.96241, 1.79936, 1.66012, 1.5446, 1.45309, 1.36128, 1.30031, 1.24959, 1.21221, 1.18766, 1.16757, 1.16475, 1.17336, 1.15028, 1.11875],
	  [2.40085, 2.26858, 2.10522, 1.95488, 1.82863, 1.72549, 1.63033, 1.55232, 1.49184, 1.43598, 1.41357, 1.38856, 1.39596, 1.37445, 1.40755, 1.47731],
	  [3.00131, 2.96722, 2.87576, 2.69863, 2.50406, 2.32312, 2.15486, 2.01486, 1.8907, 1.79851, 1.72108, 1.65956, 1.61751, 1.59252, 1.5179, 1.49579]
	],
	[ [1.37407, 1.2769, 1.11892, 1.02321, 0.954931, 0.900042, 0.86009, 0.828382, 0.803265, 0.789315, 0.775509, 0.768375, 0.775618, 0.786733, 0.805713, 0.810876],
	  [1.36715, 1.28218, 1.12903, 1.02615, 0.954457, 0.896786, 0.854357, 0.817711, 0.797061, 0.784298, 0.773302, 0.773805, 0.780595, 0.796419, 0.810985, 0.788883],
	  [1.37248, 1.28618, 1.12822, 1.03165, 0.953403, 0.905577, 0.865954, 0.833164, 0.812087, 0.797174, 0.790532, 0.78481, 0.794702, 0.811046, 0.826019, 0.800091],
	  [1.41499, 1.33017, 1.18144, 1.08634, 1.01416, 0.959179, 0.918611, 0.886187, 0.862766, 0.847704, 0.843878, 0.850882, 0.85918, 0.868345, 0.872051, 0.872198],
	  [1.60827, 1.5209, 1.40127, 1.23055, 1.16318, 1.09904, 1.05255, 1.01438, 0.986219, 0.967248, 0.94471, 0.946333, 0.954531, 0.96617, 0.985107, 1.00816],
	  [1.79109, 1.69186, 1.56698, 1.43749, 1.34995, 1.27419, 1.20955, 1.16172, 1.12054, 1.09672, 1.08068, 1.07198, 1.07992, 1.07807, 1.0831, 1.04207],
	  [1.94105, 1.86262, 1.72586, 1.61135, 1.51152, 1.43401, 1.35988, 1.30749, 1.26334, 1.23276, 1.2112, 1.19643, 1.19967, 1.20709, 1.18601, 1.1724],
	  [2.38598, 2.2534, 2.10385, 1.96647, 1.85609, 1.75645, 1.67094, 1.59531, 1.53349, 1.4914, 1.46947, 1.45301, 1.4647, 1.44839, 1.4737, 1.55239],
	  [2.72183, 2.68984, 2.63433, 2.50323, 2.34891, 2.2024, 2.06186, 1.93903, 1.8393, 1.75606, 1.69391, 1.6483, 1.60708, 1.58162, 1.50839, 1.48248]
	],
	[ [1.2794, 1.20006, 1.07694, 1.00277, 0.950365, 0.908544, 0.87576, 0.851775, 0.83527, 0.825862, 0.818268, 0.815444, 0.823338, 0.835547, 0.858962, 0.859531],
	  [1.27703, 1.20877, 1.08646, 1.00402, 0.948941, 0.906946, 0.870997, 0.842256, 0.829672, 0.820007, 0.815418, 0.818627, 0.828569, 0.844322, 0.862867, 0.833061],
	  [1.2874, 1.21515, 1.09059, 1.01232, 0.950562, 0.915758, 0.885219, 0.862458, 0.845484, 0.836697, 0.833105, 0.831037, 0.846697, 0.862853, 0.884124, 0.848749],
	  [1.34102, 1.27211, 1.15161, 1.07866, 1.02081, 0.97755, 0.94591, 0.920072, 0.903687, 0.893782, 0.892264, 0.905507, 0.916919, 0.927907, 0.932861, 0.928055],
	  [1.53413, 1.45896, 1.35954, 1.22871, 1.16754, 1.12509, 1.08659, 1.05639, 1.03529, 1.02295, 1.00668, 1.0114, 1.02304, 1.03636, 1.05397, 1.08081],
	  [1.65867, 1.59076, 1.49496, 1.39836, 1.3354, 1.27703, 1.22807, 1.19247, 1.16281, 1.14552, 1.13656, 1.13351, 1.14515, 1.15131, 1.15634, 1.11231],
	  [1.80453, 1.74518, 1.65345, 1.57666, 1.5019, 1.44094, 1.38424, 1.34313, 1.30982, 1.28811, 1.27395, 1.2624, 1.2718, 1.28459, 1.26347, 1.24585],
	  [2.10153, 2.05328, 1.97521, 1.90129, 1.82371, 1.75283, 1.68732, 1.63021, 1.58068, 1.54824, 1.52926, 1.5136, 1.50177, 1.52156, 1.55705, 1.62856],
	  [2.36231, 2.37399, 2.39017, 2.3408, 2.23382, 2.14055, 2.03151, 1.94209, 1.86046, 1.79827, 1.74587, 1.70999, 1.67968, 1.66205, 1.59837, 1.57015]
	],
	[ [1.1587, 1.10258, 1.01763, 0.972936, 0.942476, 0.918824, 0.90139, 0.890344, 0.883709, 0.88271, 0.886015, 0.890102, 0.902704, 0.920961, 0.950356, 0.959914],
	  [1.15581, 1.11106, 1.0278, 0.974191, 0.941421, 0.916465, 0.897497, 0.88092, 0.878494, 0.878512, 0.88354, 0.891103, 0.908239, 0.932995, 0.959165, 0.932838],
	  [1.18233, 1.13225, 1.04602, 0.996879, 0.954006, 0.937118, 0.921234, 0.909001, 0.903469, 0.905103, 0.90932, 0.91506, 0.936128, 0.962579, 0.989865, 0.955045],
	  [1.27987, 1.22599, 1.13806, 1.09147, 1.05338, 1.02533, 1.00669, 0.991285, 0.984225, 0.983176, 0.989949, 1.01319, 1.02911, 1.0466, 1.05565, 1.05465],
	  [1.37098, 1.31428, 1.25887, 1.16969, 1.13438, 1.11293, 1.09334, 1.082, 1.07498, 1.07414, 1.06876, 1.08114, 1.10154, 1.12102, 1.14582, 1.17267],
	  [1.50236, 1.46554, 1.41301, 1.36147, 1.32546, 1.29033, 1.26487, 1.24705, 1.23106, 1.2259, 1.22713, 1.23504, 1.25331, 1.26746, 1.28144, 1.23209],
	  [1.60315, 1.5783, 1.53919, 1.50024, 1.47074, 1.44497, 1.40436, 1.389, 1.372, 1.3651, 1.36882, 1.37046, 1.38737, 1.41173, 1.41223, 1.37083],
	  [1.75648, 1.73054, 1.71033, 1.69857, 1.67488, 1.65189, 1.62651, 1.60748, 1.59238, 1.58493, 1.57967, 1.59267, 1.61092, 1.62596, 1.65529, 1.74053],
	  [2.00571, 2.04056, 2.13422, 2.15003, 2.11537, 2.07883, 2.01903, 1.96674, 1.92093, 1.88048, 1.85433, 1.83814, 1.83025, 1.81992, 1.76921, 1.72067]
	],
	[ [1.04658, 1.00778, 0.95966, 0.942102, 0.936297, 0.934151, 0.935516, 0.940309, 0.949998, 0.962494, 0.977172, 0.990667, 1.01269, 1.03264, 1.07541, 1.09656],
	  [1.05348, 1.02322, 0.974812, 0.949217, 0.941289, 0.936595, 0.935076, 0.933571, 0.948089, 0.959977, 0.977878, 0.996721, 1.02375, 1.05695, 1.09578, 1.07113],
	  [1.11199, 1.07678, 1.02098, 0.99726, 0.977216, 0.981083, 0.982685, 0.987138, 0.995204, 1.00864, 1.02642, 1.0376, 1.07245, 1.10808, 1.1523, 1.11488],
	  [1.1551, 1.11778, 1.07282, 1.04944, 1.03799, 1.02988, 1.02786, 1.03494, 1.04407, 1.05898, 1.07942, 1.09781, 1.13716, 1.16616, 1.19515, 1.18285],
	  [1.20648, 1.16921, 1.15214, 1.10204, 1.08995, 1.09863, 1.10272, 1.11084, 1.12357, 1.14067, 1.15096, 1.17381, 1.20943, 1.23644, 1.2713, 1.30183],
	  [1.28456, 1.26706, 1.26798, 1.25408, 1.25225, 1.25116, 1.25023, 1.25701, 1.26068, 1.27704, 1.2955, 1.31538, 1.34945, 1.37064, 1.39389, 1.34066],
	  [1.38944, 1.38761, 1.39433, 1.40126, 1.40151, 1.40766, 1.40087, 1.40847, 1.41943, 1.43345, 1.45508, 1.48215, 1.51808, 1.55559, 1.57311, 1.5031],
	  [1.46756, 1.46635, 1.4887, 1.5255, 1.54733, 1.56291, 1.5749, 1.59327, 1.60871, 1.62682, 1.65092, 1.68253, 1.72136, 1.75329, 1.78396, 1.8622],
	  [1.66989, 1.72621, 1.86738, 1.94471, 1.96866, 1.98785, 1.97897, 1.97116, 1.96262, 1.96178, 1.96451, 1.97127, 1.98368, 2.00068, 1.9676, 1.88032]
	],
	[ [1.03118, 1.00281, 0.976428, 0.980169, 0.991869, 1.00883, 1.02906, 1.05058, 1.0795, 1.11169, 1.14202, 1.17375, 1.20765, 1.23382, 1.28736, 1.3177],
	  [1.04496, 1.02017, 0.997629, 0.995814, 1.00113, 1.01321, 1.03076, 1.05255, 1.0761, 1.1072, 1.13805, 1.17251, 1.21393, 1.25785, 1.31348, 1.29418],
	  [1.04761, 1.02269, 0.996304, 0.995023, 1.0007, 1.01443, 1.03109, 1.05143, 1.07711, 1.10826, 1.1405, 1.17231, 1.21302, 1.25633, 1.3085, 1.27693],
	  [1.03766, 1.01826, 0.994187, 0.991873, 0.998316, 1.0141, 1.03499, 1.05694, 1.0847, 1.11766, 1.15486, 1.20303, 1.24369, 1.28379, 1.31056, 1.30615],
	  [1.05731, 1.03858, 1.01847, 1.02548, 1.05105, 1.06778, 1.09361, 1.12376, 1.15584, 1.19305, 1.22445, 1.2704, 1.30898, 1.34238, 1.38562, 1.409],
	  [1.10877, 1.10754, 1.14076, 1.15307, 1.18504, 1.20609, 1.22933, 1.25754, 1.28835, 1.32514, 1.36309, 1.39769, 1.45247, 1.49321, 1.52081, 1.46434],
	  [1.1436, 1.15103, 1.18693, 1.22099, 1.25743, 1.29632, 1.31765, 1.35473, 1.39353, 1.4329, 1.48052, 1.53162, 1.58169, 1.64218, 1.67934, 1.59459],
	  [1.19421, 1.20256, 1.25152, 1.317, 1.36939, 1.41774, 1.46407, 1.51032, 1.55923, 1.60923, 1.66674, 1.71655, 1.77754, 1.83076, 1.8659, 1.93086],
	  [1.34172, 1.40313, 1.56572, 1.68537, 1.75519, 1.81807, 1.85753, 1.89438, 1.93073, 1.96484, 2.00243, 2.04032, 2.08798, 2.12176, 2.12229, 2.00869]
	],
	[ [1.16989, 1.14166, 1.11952, 1.12862, 1.15072, 1.1794, 1.21092, 1.24722, 1.28841, 1.33695, 1.38336, 1.42854, 1.47133, 1.49804, 1.54741, 1.60228],
	  [1.10141, 1.07998, 1.06145, 1.06426, 1.08325, 1.10846, 1.13749, 1.16747, 1.20553, 1.25047, 1.29551, 1.34354, 1.40275, 1.45218, 1.51533, 1.50297],
	  [1.01096, 0.991787, 0.971516, 0.976379, 0.991447, 1.0196, 1.05113, 1.08405, 1.12178, 1.1661, 1.21459, 1.25266, 1.3159, 1.36625, 1.42783, 1.38305],
	  [0.969217, 0.952436, 0.942125, 0.952499, 0.972033, 0.996329, 1.02925, 1.06522, 1.10686, 1.1524, 1.20293, 1.26395, 1.32181, 1.3664, 1.3952, 1.38077],
	  [0.947213, 0.934058, 0.939794, 0.941679, 0.973627, 1.00591, 1.04379, 1.08653, 1.13184, 1.1822, 1.22609, 1.28252, 1.33969, 1.38291, 1.42353, 1.43162],
	  [0.974022, 0.978218, 1.02104, 1.04427, 1.08599, 1.11956, 1.15665, 1.20023, 1.24537, 1.2971, 1.34998, 1.39711, 1.46284, 1.52256, 1.55725, 1.50591],
	  [0.983942, 0.997837, 1.03974, 1.0837, 1.12872, 1.17995, 1.21721, 1.26786, 1.3201, 1.37515, 1.43636, 1.50599, 1.57261, 1.639, 1.69817, 1.60824],
	  [0.986637, 1.00021, 1.05809, 1.12605, 1.18612, 1.24586, 1.30626, 1.36646, 1.42805, 1.49162, 1.55908, 1.62912, 1.70098, 1.77127, 1.82632, 1.83638],
	  [1.05328, 1.11283, 1.26775, 1.3846, 1.46585, 1.54778, 1.6025, 1.66216, 1.7191, 1.77506, 1.83249, 1.89588, 1.95564, 2.01094, 2.03729, 1.92352]
	],
	[ [1.16989, 1.14166, 1.11952, 1.12862, 1.15072, 1.1794, 1.21092, 1.24722, 1.28841, 1.33695, 1.38336, 1.42854, 1.47133, 1.49804, 1.54741, 1.60228],
	  [1.10141, 1.07998, 1.06145, 1.06426, 1.08325, 1.10846, 1.13749, 1.16747, 1.20553, 1.25047, 1.29551, 1.34354, 1.40275, 1.45218, 1.51533, 1.50297],
	  [1.18138, 1.14739, 1.12995, 1.13489, 1.15539, 1.18368, 1.21695, 1.25575, 1.29879, 1.35524, 1.41206, 1.46715, 1.5353, 1.58196, 1.64623, 1.61357],
	  [1.07715, 1.05718, 1.04135, 1.0538, 1.07493, 1.10168, 1.13983, 1.17895, 1.22699, 1.2772, 1.33161, 1.41493, 1.47309, 1.51852, 1.54152, 1.53889],
	  [1.02121, 1.00515, 1.03757, 1.0002, 1.03372, 1.07104, 1.11477, 1.15716, 1.20884, 1.26404, 1.30206, 1.36415, 1.43529, 1.4845, 1.53161, 1.54125],
	  [0.991434, 0.993547, 1.04104, 1.06174, 1.09845, 1.13584, 1.17396, 1.22239, 1.26504, 1.32346, 1.38022, 1.4284, 1.49953, 1.55411, 1.60144, 1.5439],
	  [0.958746, 0.973306, 1.01366, 1.05779, 1.09917, 1.14531, 1.18026, 1.23175, 1.28569, 1.33957, 1.40024, 1.45703, 1.52317, 1.60065, 1.64575, 1.56922],
	  [0.958867, 0.972587, 1.02301, 1.08662, 1.14244, 1.19739, 1.25631, 1.31383, 1.37222, 1.43563, 1.50117, 1.56715, 1.63567, 1.70922, 1.76777, 1.7753],
	  [0.986332, 1.04235, 1.18522, 1.29253, 1.36492, 1.43449, 1.4859, 1.53936, 1.59273, 1.64912, 1.70134, 1.7577, 1.81235, 1.86855, 1.89174, 1.80892]
	],
	[ [1.16989, 1.14166, 1.11952, 1.12862, 1.15072, 1.1794, 1.21092, 1.24722, 1.28841, 1.33695, 1.38336, 1.42854, 1.47133, 1.49804, 1.54741, 1.60228],
	  [1.10141, 1.07998, 1.06145, 1.06426, 1.08325, 1.10846, 1.13749, 1.16747, 1.20553, 1.25047, 1.29551, 1.34354, 1.40275, 1.45218, 1.51533, 1.50297],
	  [1.18138, 1.14739, 1.12995, 1.13489, 1.15539, 1.18368, 1.21695, 1.25575, 1.29879, 1.35524, 1.41206, 1.46715, 1.5353, 1.58196, 1.64623, 1.61357],
	  [1.07715, 1.05718, 1.04135, 1.0538, 1.07493, 1.10168, 1.13983, 1.17895, 1.22699, 1.2772, 1.33161, 1.41493, 1.47309, 1.51852, 1.54152, 1.53889],
	  [1.02121, 1.00515, 1.03757, 1.0002, 1.03372, 1.07104, 1.11477, 1.15716, 1.20884, 1.26404, 1.30206, 1.36415, 1.43529, 1.4845, 1.53161, 1.54125],
	  [0.991434, 0.993547, 1.04104, 1.06174, 1.09845, 1.13584, 1.17396, 1.22239, 1.26504, 1.32346, 1.38022, 1.4284, 1.49953, 1.55411, 1.60144, 1.5439],
	  [0.958746, 0.973306, 1.01366, 1.05779, 1.09917, 1.14531, 1.18026, 1.23175, 1.28569, 1.33957, 1.40024, 1.45703, 1.52317, 1.60065, 1.64575, 1.56922],
	  [0.958867, 0.972587, 1.02301, 1.08662, 1.14244, 1.19739, 1.25631, 1.31383, 1.37222, 1.43563, 1.50117, 1.56715, 1.63567, 1.70922, 1.76777, 1.7753],
	  [0.986332, 1.04235, 1.18522, 1.29253, 1.36492, 1.43449, 1.4859, 1.53936, 1.59273, 1.64912, 1.70134, 1.7577, 1.81235, 1.86855, 1.89174, 1.80892]
	]
]

dune_vis_xenon_hits_parameterization:
{
 FlatPDCorr: true
 VIS_distances_x_flat: @local::VIS_distances_x_flat_dune_xenon
 VIS_distances_r_flat: @local::VIS_distances_r_flat_dune_xenon
 VIS_correction_flat:  @local::VIS_correction_flat_dune_xenon

 DomePDCorr: false
 
 delta_angulo_vis: 10

 PMT_radius: 10.16
}

END_PROLOG

BEGIN_PROLOG

##########
# 35 ton #
##########

dune35t_photonvisibilityservice:
{

  NX: 100
  NY: 100
  NZ: 100
  UseCryoBoundary: true

  DoNotLoadLibrary: false

  LibraryBuildJob: false

  LibraryFile: "PhotonPropagation/LibraryData/lib_35ton_v5_20150721.root"

 #These are not used when usecryoboundary=true
  XMin: -120
  XMax: 120
  YMin: -120
  YMax: 120
  ZMin: 0
  ZMax: 1200
}

dune35t_photonvisibilityservice_buildlib: @local::dune35t_photonvisibilityservice
dune35t_photonvisibilityservice_buildlib.DoNotLoadLibrary: true
dune35t_photonvisibilityservice_buildlib.LibraryBuildJob: true
dune35t_photonvisibilityservice_buildlib.LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"	 







######################
# 1x2x6 SP Workspace #
######################

dune10kt_v1_1x2x6_photonvisibilityservice:
{

  NX: 100
  NY: 100
  NZ: 300
  UseCryoBoundary: true

  DoNotLoadLibrary: false

  LibraryBuildJob: false

  LibraryFile: "PhotonPropagation/LibraryData/lib_dune10kt_v1_1x2x6_20170412.root"
  

 #These are not used when usecryoboundary=true
  XMin: -120
  XMax: 120
  YMin: -120
  YMax: 120
  ZMin: 0
  ZMax: 1200
}


dune10kt_v2_1x2x6_photonvisibilityservice:                           @local::dune10kt_v1_1x2x6_photonvisibilityservice
dune10kt_v2_1x2x6_photonvisibilityservice.LibraryFile:               "PhotonPropagation/LibraryData/lib_dune10kt_v2_1x2x6_20171113.root"


dune10kt_1x2x6_xe_photonvisibilityservice: {
   
  NX: 100
  NY: 100
  NZ: 300

  # The boundaries of the cryostat are:
  # X = [-379.662, 379.662] cm
  # Y = [-658.099, 699.599] cm
  # Z = [-302.946, 1443.53] cm
  UseCryoBoundary: false
  XMin: 0
  XMax: 379.662
  YMin: -658.09
  YMax: 699.59
  ZMin: -302.946
  ZMax: 1443.5
  ReflectOverZeroX: true

  StoreReflected: false
  StoreReflT0: false
  IncludePropTime: false

  DoNotLoadLibrary: false
  LibraryBuildJob: false

  LibraryFile: "PhotonPropagation/LibraryData/lib_dune10kt_v3_1x2x6_Xe_photonvisibilityservice.root"
}



### Visibility services with ARAPUCAs and reflector foils
dune10kt_1x2x6_refl_v1_photonvisibilityservice: {

   NX: 75
   NY: 125
   NZ: 300

   # The boundaries of the cryostat are:
   # X = [-379.662, 379.662] cm
   # Y = [-658.099, 699.599] cm
   # Z = [-302.946, 1443.53] cm
   UseCryoBoundary: false
   XMin: 0
   XMax: 379.662
   YMin: -658.09
   YMax: 699.59
   ZMin: -302.946
   ZMax: 1443.5
   ReflectOverZeroX: true

   StoreReflected: true
   StoreReflT0: true
   IncludePropTime: false

   DoNotLoadLibrary: false
   LibraryBuildJob: false

   LibraryFile: "PhotonPropagation/LibraryData/lib_dune10kt_v4_1x2x6_withfoils_lib.root"
}


##############
#
# Enable direct and reflected timing parameterization on top of a photon library.
# Works only for DUNE SP.
#
dunesp_library_vuv_vis_prop_timing_photonvisibilityservice:
{
   # This will need to be repalced in dunetpc with
   # dunesp-specific library settings
   @table::dune10kt_1x2x6_refl_v1_photonvisibilityservice

   # Flag to enable time parameterizations
   IncludePropTime: true

   # DUNE-specific VUV timing parameterization
   @table::dune_vuv_timing_parameterization

   # Flag to enable visible light simulation
   StoreReflected: true
   
   # DUNE-specific VIS parameterization
   @table::dune_vis_timing_parameterization

}

#
# Enable direct timing parameterization and Nhits model estimation.
# Works only for DUNE SP.
#
# xenon doped argon case
dunesp_Nhits_vuv_Xe_photonvisibilityservice:
{
   # Flags to enable parameterizations, disable library
   IncludePropTime: false	# timing parameterisation does not exist for Xe doped case
   UseNhitsModel: true
   DoNotLoadLibrary: true

   # Semi-analytic VUV Nhits parameters
   @table::dune_vuv_Xenon_hits_parameterization
}

#
# Enable direct and reflected timing parameterization and Nhits model estimation.
# Works only for DUNE SP.
#
# default case is 100cm Rayleigh scattering length for the VUV light
dunesp_Nhits_vuv_vis_prop_timing_RS100cm_photonvisibilityservice:
{
   # Flags to enable parameterizations, disable library
   IncludePropTime: true
   UseNhitsModel: true
   DoNotLoadLibrary: true

   # DUNE-specific VUV time parameterization
   @table::dune_vuv_timing_parameterization

   # DUNE-specific VUV semi-analytic Nhits parameters
   @table::dune_vuv_RS100cm_hits_parameterization

   # Flag to enable visible light simulation
   StoreReflected: true
 
   # DUNE-specific VIS time parameterization
   @table::dune_vis_timing_parameterization

   # DUNE-specific VIS semi-analytic Nhits parameters
   @table::dune_vis_RS100cm_hits_parameterization

}
# xenon doped argon case
dunesp_Nhits_vuv_vis_Xe_photonvisibilityservice:
{
   # DUNE-SP VUV timing and Nhits settings - note: timing is disabled, parameterisation does not exist for Xe doped case
   @table::dunesp_Nhits_vuv_Xe_photonvisibilityservice

   # Flag to enable visible light simulation
   StoreReflected: true
 
   # DUNE-specific VIS semi-analytic Nhits parameters
   @table::dune_vis_xenon_hits_parameterization
}

##############


# Make a choice here among the above for *the* FD 1x2x6 PVS
# Use the pre-defined DUNE SP configuration for paramterized simulation
# Default case is with 90cm Rayleigh scattering length @ 128nm
dune10kt_1x2x6_photonvisibilityservice: @local::dunesp_Nhits_vuv_vis_prop_timing_RS100cm_photonvisibilityservice

# Make choice here for Xenon doped FD 1x2x6 PVS
# Use pre-defined DUNE SP configuration for paramterized simulation
dune10kt_1x2x6_xenon_photonvisibilityservice: @local::dunesp_Nhits_vuv_vis_Xe_photonvisibilityservice



# Jobs for building libraries:
dune10kt_1x2x6_photonvisibilityservice_buildlib:                  @local::dune10kt_v1_1x2x6_photonvisibilityservice
dune10kt_1x2x6_photonvisibilityservice_buildlib.DoNotLoadLibrary: true
dune10kt_1x2x6_photonvisibilityservice_buildlib.LibraryBuildJob:  true
dune10kt_1x2x6_photonvisibilityservice_buildlib.LibraryFile:      "PhotonPropagation/LibraryData/Not_A_Library.root"

dune10kt_1x2x6_refl_photonvisibilityservice_buildlib:                  @local::dune10kt_1x2x6_refl_v1_photonvisibilityservice
dune10kt_1x2x6_refl_photonvisibilityservice_buildlib.DoNotLoadLibrary: true
dune10kt_1x2x6_refl_photonvisibilityservice_buildlib.LibraryBuildJob:  true
dune10kt_1x2x6_refl_photonvisibilityservice_buildlib.LibraryFile:      "PhotonPropagation/LibraryData/Not_A_Library.root"




##########################
# ProtoDUNE Single Phase #
##########################


protodunev4_photonvisibilityservice:
{

  NX: 100
  NY: 100
  NZ: 100
   
  UseCryoBoundary: true
  DoNotLoadLibrary: false
  LibraryBuildJob: false
  LibraryFile: "PhotonPropagation/LibraryData/lib_protodune_v4_20171214.root"

  #These are not used when usecryoboundary=true
  XMin: -120
  XMax: 120
  YMin: -120
  YMax: 120
  ZMin: 0
  ZMax: 1200
}




########################################
# ProtoDUNE Single Phase  with arapucas#
########################################

protodunev7_photonvisibilityservice:
{

  NX: 140
  NY: 120
  NZ: 140
   
  UseCryoBoundary: true
  DoNotLoadLibrary: false
  LibraryBuildJob: false
  LibraryFile: "PhotonPropagation/LibraryData/lib_Protodunev7_merged_avg.root"

  #These are not used when usecryoboundary=true
  XMin: -120
  XMax: 120
  YMin: -120
  YMax: 120
  ZMin: 0
  ZMax: 1200
}

# Uses a library with fewer voxels for less memory
protodunev7small_photonvisibilityservice: @local::protodunev7_photonvisibilityservice
protodunev7small_photonvisibilityservice.NX: 100
protodunev7small_photonvisibilityservice.NY: 100
protodunev7small_photonvisibilityservice.NZ: 100 
protodunev7small_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/lib_Protodunev7_small.root"


# Uses library with 90cm Rayleigh scattering
protodunev7l90cm_photonvisibilityservice: @local::protodunev7_photonvisibilityservice
protodunev7l90cm_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/lib_Protodunev7_90cm.root"

# Make the v7 visibility service the default

protodune_photonvisibilityservice: @local::protodunev7_photonvisibilityservice





########################
# ProtoDUNE Dual Phase #
########################

protodunedp_photonvisibilityservice_buildlib:
{

  NX: 29
  NY: 24
  NZ: 24
  UseCryoBoundary: false

  DoNotLoadLibrary: true

  LibraryBuildJob: true

  LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"

 #These are not used when usecryoboundary=true
  XMin: -420.5
  XMax: 304.5
  YMin: -300
  YMax: 300
  ZMin: 0
  ZMax: 600

  ParametrisedTimePropagation: true
  ParametrisedTimePropagationNParameters: 3
  ParametrisedTimePropagationFittedFormula: "TMath::Landau(x,[0],[1])"
}


protodunedp_photonvisibilityservice: @local::protodunedp_photonvisibilityservice_buildlib
protodunedp_photonvisibilityservice.DoNotLoadLibrary: false
protodunedp_photonvisibilityservice.LibraryBuildJob: false
protodunedp_photonvisibilityservice.Interpolate: true
#protodunedp_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/lib_protodunedp_lightsim_nonuni_20171213.root"
#protodunedp_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/lib_protodunedp_lightsim_20171204.root"
protodunedp_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_protodunedp_lightsim_20180420.root"


protodunedp_driftY_photonvisibilityservice:
{
  NX: 25
  NY: 25
  NZ: 25
  UseCryoBoundary: true
  DoNotLoadLibrary: false
  LibraryBuildJob: false
  LibraryFile: "PhotonPropagation/LibraryData/libext_protodunedphase_driftY_CRYO_RL91CM_v08_41_01_1e8_25x25x25_20200416.root"
  ParametrisedTimePropagation: true
  ParametrisedTimePropagationNParameters: 3
  ParametrisedTimePropagationMaxRange: 2000
}

protodunedp_driftY_RL99CM_VUVREF_photonvisibilityservice: @local::protodunedp_driftY_photonvisibilityservice
protodunedp_driftY_RL99CM_VUVREF_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_protodunedphase_driftY_CRYO_RL99CM_VUVREF_v08_41_01_1e8_25x25x25_20200624.root"

protodunedp_driftY_RL61CM_photonvisibilityservice: @local::protodunedp_driftY_photonvisibilityservice
protodunedp_driftY_RL61CM_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_protodunedphase_driftY_CRYO_RL61CM_v08_41_01_1e8_25x25x25_20200416.root"


protodunedp_driftY_AV_photonvisibilityservice:
{
  NX: 30
  NY: 30
  NZ: 30
  UseCryoBoundary: true
  DoNotLoadLibrary: false
  LibraryBuildJob: false
  XMin:300    XMax: 300    YMin: -407    YMax: 300    ZMin: 0    ZMax: 600
  LibraryFile: "PhotonPropagation/LibraryData/libext_protodunedphase_driftY_AV_RL91CM_v08_41_01_1e8_30x30x30_20200416.root"
  ParametrisedTimePropagation: true
  ParametrisedTimePropagationNParameters: 3
  ParametrisedTimePropagationMaxRange: 2000
}
protodunedp_driftY_AV_RL61CM_photonvisibilityservice: @local::protodunedp_driftY_AV_photonvisibilityservice
protodunedp_driftY_AV_RL61CM_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_protodunedphase_driftY_AV_RL61CM_v08_41_01_1e8_30x30x30_20200416.root"



####################
# Dual Phase 3x1x1 #
####################

dunedphase3x1x1_photonvisibilityservice_buildlib:
{

  NX: 4
  NY: 4
  NZ: 12
  UseCryoBoundary: false

  DoNotLoadLibrary: true

  LibraryBuildJob: true

  LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"

 #These are not used when usecryoboundary=true
  XMin: -50
  XMax: 50
  YMin: -50
  YMax: 50
  ZMin: 0
  ZMax: 300

  ParametrisedTimePropagation: true
  ParametrisedTimePropagationNParameters: 4
  ParametrisedTimePropagationFittedFormula: "TMath::Exp([0]*x) + [2]*TMath::Exp([1]*x)"

}

dunedphase3x1x1_photonvisibilityservice: @local::dunedphase3x1x1_photonvisibilityservice_buildlib
dunedphase3x1x1_photonvisibilityservice.DoNotLoadLibrary: false
dunedphase3x1x1_photonvisibilityservice.Interpolate: true
dunedphase3x1x1_photonvisibilityservice.LibraryBuildJob: false
#dunedphase3x1x1_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/lib_dunedphase3x1x1_lightsim_20171213.root"
dunedphase3x1x1_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_dunedphase3x1x1_lightsim_20171213.root"





#################
# Dual Phase FD #
#################

dunefddphase_photonvisibilityservice_buildlib:
{

  NX: 16
  NY: 16
  NZ: 81
  UseCryoBoundary: false

  DoNotLoadLibrary: true

  LibraryBuildJob: true

  LibraryFile: "PhotonPropagation/LibraryData/Not_A_Library.root"

 #These are not used when usecryoboundary=true
  XMin: -600
  XMax: 600
  YMin: -600
  YMax: 600
  ZMin: 0
  ZMax: 6000

  ParametrisedTimePropagation: false
}


dunefddphase_photonvisibilityservice: @local::dunefddphase_photonvisibilityservice_buildlib
dunefddphase_photonvisibilityservice.DoNotLoadLibrary: false
dunefddphase_photonvisibilityservice.Interpolate: true
dunefddphase_photonvisibilityservice.LibraryBuildJob: false
#dunefddphase_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/lib_FD_300_000_16_16_81.root"
dunefddphase_photonvisibilityservice.UseCryoBoundary: true
dunefddphase_photonvisibilityservice.NX: 15
dunefddphase_photonvisibilityservice.NY: 15
dunefddphase_photonvisibilityservice.NZ: 62
dunefddphase_photonvisibilityservice.ParametrisedTimePropagationMaxRange: 1000
dunefddphase_photonvisibilityservice.ParametrisedTimePropagationNParameters: 3
dunefddphase_photonvisibilityservice.ParametrisedTimePropagation: true
#dunefddphase_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_dunedp_1M_15x15x62_20180913.root"#not use this old library
dunefddphase_photonvisibilityservice.LibraryFile: "PhotonPropagation/LibraryData/libext_dunedp_1M_15x15x62_20181122.root"




####################################
# S2 visibility service parameters #
####################################

dunedphase3x1x1_photonvisibilityserviceS2:
{
  NX: 1
  NY: 4
  NZ: 12
  UseCryoBoundary: false
  DoNotLoadLibrary: false
  LibraryBuildJob: false
  LibraryFile: "libext_dunedphase3x1x1_lightsim_S2_20171213.root"
 #These are not used when usecryoboundary=true
  XMin: 50
  XMax: 52
  YMin: -50
  YMax: 50
  ZMin: 0
  ZMax: 300
  ParametrisedTimePropagation: true
  ParametrisedTimePropagationNParameters: 4
}

protodunedp_photonvisibilityserviceS2:
{

  NX: 1
  NY: 24
  NZ: 24
  UseCryoBoundary: false
  DoNotLoadLibrary: false
  LibraryBuildJob: false
  LibraryFile: "libext_protodunedp_lightsim_S2_20171220.root"
 #These are not used when usecryoboundary=true
  XMin: 296
  XMax: 302
  YMin: -300
  YMax: 300
  ZMin: 0
  ZMax: 300
  ParametrisedTimePropagation: true
  ParametrisedTimePropagationNParameters: 3
}

END_PROLOG
BEGIN_PROLOG

# Standard configurations for art's built-in FileCatalogMetadata service.
# Metadata fields are standard, but values are still dune-specific.

art_file_catalog:
{
  # Note sam application name is taken from "process_name" fcl parameter in main job file.
  applicationFamily:   "art"
  applicationVersion:  "development"
  group:               "dune"
  runType:             "physics"
  fileType:            "unknown"
}

art_file_catalog_mc:           @local::art_file_catalog
art_file_catalog_mc.fileType:  "mc"

art_file_catalog_data:           @local::art_file_catalog
art_file_catalog_data.fileType:  "data"

# standard configurations for the TFileMetadataDUNE service

dune_tfile_metadata:
{
  JSONFileName:          "ana_hist.root.json"
  GenerateTFileMetadata: true
  dataTier:              "root-tuple"
  fileFormat:            "root"
}

END_PROLOG
BEGIN_PROLOG

###################################################################
# Added July-2013: These are the parameters/modules associated with
# the MicroBooNE PMT ADCs.
###################################################################

standard_opdigiproperties:
{
  SampleFreq:    64       # ADC sampling frequency in MHz
  TimeBegin:     0        # Where readout frame starts, relative to simulation t0 in micro-seconds
  TimeEnd:       1600     # Where readout frame ends, relative to simulation t0 in micro-seconds

  # Parameter of PMT & shaper
  UseEmpiricalGain:        false # boolean control to load empirical gain or not
  QE:                      0.01  # Quantum efficiency
  DarkRate:                1.e4  # Dark noise rate in Hz
  GainSpread:              0.05  # Intrinsic spread in each PMT's gain in fraction (percentile/100)
  GainSpread_PMT2PMT:      0.05  # PMT-to-PMT spread in the gain mean values in fraction (percentile/100)
  HighGainMean:            20    # ADC count per p.e.
  LowGainMean:             2     # ADC count per p.e.
  
  # Option to provide empirical data files
  HighGainFile:            "OpticalDetector/toyHighGain.txt"   # PMT high gain given in a file
  LowGainFile:             "OpticalDetector/toyLowGain.txt"    # PMT low gain given in a file
  GainSpreadFile:          "OpticalDetector/toyGainSpread.txt" # PMT intrinsic gain spread in a file

  # Parameter of digitizer
  SaturationScale:         4097  # waveform saturation point
  PedFlucRate:             1.e7  # Rate of ADC count fluctuation in Hz
  PedFlucAmp:              1     # Amplitude of ADC count fluctuation
  ADCBaseline:             2048  # ADC Basline
  ADCBaseSpread:           3.4   # ADC Basline mean spread in double
  
  # Parameters for waveform generation
  UseEmpiricalShape: false # true = use text file SPE shape, false = use an analytical model
  WFLength:          2     # Maximum Duration of sahpe sampling period [us]
  PERescale:         0.2   # Rescaling factor to be applied on file input 
  WaveformFile:  "OpticalDetector/toyWaveform.txt" # a toy text file for SPE shape
  
  # Parameters for analytical waveform
  WFPowerFactor:           10    # "(n-1)" factor in shape
  WFTimeConstant:          0.006 # 60 ns
  VoltageAmpForSPE:        0.04  # 40mV/p.e.  
}


standard_opdigiproperties_3windows: @local::standard_opdigiproperties
standard_opdigiproperties_3windows.TimeBegin: -1600
standard_opdigiproperties_3windows.TimeEnd:    4800


standard_opdetresponse:
{
   service_provider:        DefaultOpDetResponse
}


END_PROLOG
BEGIN_PROLOG

PIProv: {
  G4ModuleLabel: "largeant"
  EveIdCalculator: "EmEveIdCalculator"
}
standard_particleinventoryservice: {
  ParticleInventory: @local::PIProv
}

jp250L_particleinventoryservice:     @local::standard_particleinventoryservice
bo_particleinventoryservice:         @local::standard_particleinventoryservice
argoneut_particleinventoryservice:   @local::standard_particleinventoryservice
microboone_particleinventoryservice: @local::standard_particleinventoryservice
#dune35t_particleinventoryservice:    @local::standard_particleinventoryservice
#dunefd_particleinventoryservice:     @local::standard_particleinventoryservice

END_PROLOG


BEGIN_PROLOG

providerPBKConf:{
 G4ModuleLabel:            "largeant" # module that produced the sim::Particle and sim::SimChannel objects
 MinimumHitEnergyFraction: 0.1        # minimum fraction of energy a G4 trackID contributes to a hit to be 
                                      # counted in hit based efficiency and purity calculations
 Delay:                    0          #This number is the difference between when light arrives at the detector, and the time recorded in OpHits. This number is experiment specific and should be set by each experiment. 
}

standard_photonbacktrackerservice:
{
 PhotonBackTracker: @local::providerPBKConf
}

END_PROLOG



BEGIN_PROLOG


#
## dune photon backtracker
#

dune_providerPBKConf:{
   G4ModuleLabel:            "largeant" # module that produced the sim::Particle and sim::SimChannel objects
   MinimumHitEnergyFraction: 0.1        # minimum fraction of energy a G4 trackID contributes to a hit to be
   Delay:                    260          #This number is the difference between when light arrives at the detector, and the time recorded in OpHits. This number is experiment specific and should be set by each experiment.
}

dunefd_photonbacktrackerservice:
{
  PhotonBackTracker: @local::dune_providerPBKConf
}

dune35t_photonbacktrackerservice:
{
  PhotonBackTracker: @local::dune_providerPBKConf
}

##
# FD op det response services, nominal and reference
##

dunefd_opdetresponse_iuradiator:
{
   
   service_provider:        DUNEOpDetResponse
   
   WavelengthCutLow:        0 
   WavelengthCutHigh:       10000
   
   LightGuideAttenuation:   true

   # New IU Radiator Parameters from arXiv:1710.11233
   # Pending a new library to go along with them
   QuantumEfficiency:       0.00287 # 0.0041 * 70% for mesh transmission
   LambdaShort:                4.3 # cm
   LambdaLong:               225.0 # cm
   FracShort:                 0.29
   FracLong:                  0.71
   
   LongAxis:                z
   
   # Convert geometry to readout channels
   # when reading in fast simulation
   ChannelConversion:       fast

   # QE here includes:
   #   Measured response at SiPM end, corrected for 12-SiPM coverage: 0.005
   #   Mesh transmission: 70%
   #   Attenuation in bars already in library response

}

dunefd_opdetresponse_arapuca:
{
   
   service_provider:        DUNEOpDetResponse
   
   QuantumEfficiency:       0.035 # 3.5% efficiency, no corrections
   
   WavelengthCutLow:        0 
   WavelengthCutHigh:       10000
   
   # No light guide attenuation
   LightGuideAttenuation:   false
   LambdaShort:             0
   LambdaLong:              0
   FracShort:               0
   FracLong:                0
   LongAxis:                z
   
   # No need to convert ARAPUCA channels
   ChannelConversion:       none
}

# Use the IU radiator design by default
dunefd_opdetresponse: @local::dunefd_opdetresponse_arapuca
protodune_opdetresponse: @local::dunefd_opdetresponse_iuradiator



##
# 35ton op det response service
##

dune35t_opdetresponse:
{
   service_provider:        DUNE35tonOpDetResponse
   QuantumEfficiency:       0.0023 #0.0016/0.6961, the normalization factor for the bars in DUNE35tOpDetResponse_service
   WavelengthCutLow:        0 
   WavelengthCutHigh:       10000
   LightGuideAttenuation:   true

   LongAxis:                y
   
   # Convert geometry to readout channels
   # when reading in fast simulation
   ChannelConversion:       fast

   # QE here includes:
   #   SiPMQE: 35%
   #   SiPM Coverage: 71%
   #   Surface Conversion: 2% (conservative estimate for new bars)
   #   Mesh transmission: 83%
   #   Attenuation in bars already in library response

}

dunedphase3x1x1_opdigiproperties:
{
  SampleFreq:    250       # ADC sampling frequency in MHz
  TimeBegin:     -200        # Where readout frame starts, relative to simulation t0 in micro-seconds
  TimeEnd:       800     # Where readout frame ends, relative to simulation t0 in micro-seconds
  # Parameter of PMT & shaper
  UseEmpiricalGain:        false # boolean control to load empirical gain or not
  QE:                      0.2  # Quantum efficiency
  DarkRate:                1.7e3  # Dark noise rate in Hz - as stablished in arXiv:1806.04571
  GainSpread:              0.05  # Intrinsic spread in each PMT's gain in fraction (percentile/100)
  GainSpread_PMT2PMT:      0.05  # PMT-to-PMT spread in the gain mean values in fraction (percentile/100)
  HighGainMean:            20    # ADC count per p.e.
  LowGainMean:             2     # ADC count per p.e

  # Option to provide empirical data files
  HighGainFile:            ""   # PMT high gain given in a file
  LowGainFile:             ""    # PMT low gain given in a file
  GainSpreadFile:          "" # PMT intrinsic gain spread in a file
  # Parameter of digitizer
  SaturationScale:         4096  # waveform saturation point
  PedFlucRate:             1.e7  # Rate of ADC count fluctuation in Hz
  PedFlucAmp:              1     # Amplitude of ADC count fluctuation
  ADCBaseline:             100  # ADC Basline
  ADCBaseSpread:           3.4   # ADC Basline mean spread in double

  # Parameters for waveform generation
  UseEmpiricalShape: true # true = use text file SPE shape, false = use an analytical model
  WFLength:          2     # Maximum Duration of sahpe sampling period [us]
  PERescale:         4.1   # Rescaling factor to be applied on file input 4.1 for a gain of 1.e6
  WaveformFile:  "PhotonPropagation/PMTResponse/protoDUNEDP_waveform_20180927.txt" # a toy text file for SPE shape

  # Parameters for analytical waveform
  WFPowerFactor:           10    # "(n-1)" factor in shape
  WFTimeConstant:          0.006 # 60 ns
  VoltageAmpForSPE:        0.04  # 40mV/p.e.
  WaveformChargeNormalized: true
}

protodunedphase_opdigiproperties:           @local::dunedphase3x1x1_opdigiproperties
protodunedphase_opdigiproperties.QE: 0.036  #
protodunedphase_opdigiproperties.SampleFreq: 62.5  #  https://www.caen.it/products/v1740/
protodunedphase_opdigiproperties.TimeBegin: -4000  #
protodunedphase_opdigiproperties.TimeEnd: 4000  #

dunefddphase_opdigiproperties:           @local::dunedphase3x1x1_opdigiproperties
dunefddphase_opdigiproperties.QE: 0.12  # as stablished in arxiv:1807.07123
END_PROLOG
# channelmapping_dune.fcl
#
# David Adams
# May 2016
#
# Configurations for the ChannelMappingService.

BEGIN_PROLOG

# For 35t data, we use the service provided in lbne_raw_data.
dune35t_channelmapping: {
  service_provider:  Dune35tChannelMappingService
}

END_PROLOG
#
# Channel filter service configuration for DUNE
#
#
BEGIN_PROLOG

dune35t_channel_status_may2016: {
# implements IChannelStatusService
service_provider: SimpleChannelStatusService

#THIS IS A LIST OF OFFLINE CHANNEL NUMBERS WHICH SUFFER FROM BAD STUCK CODES, THEY CAN BE ADDED TO THE BAD CHANNEL LIST IF REQUIRED.
#858, 861, 943, 952, 980, 1413, 1442, 1992
#OFFLINE CHANNEL NUMBERS HIGHLIGHTED AS BAD BY DAN WAHL AND AARON. ALSO HAND SELECTED FROM THE EVENT DISPLAY. COLLECTION PLANE CORRECT
#AS OF 05/03.
  BadChannels: [
    4,
   39,
   51,
   84,
   92,
  110,
  120,
  145,
  146,
  204,
  213,
  240,
  357,
  432,
  433,
  446,
  496,
  451,
  500,
  520,
  524,
  530,
  547,
  574,
  575,
  576,
  577,
  578,
  579,
  580,
  581,
  582,
  583,
  611,
  632,
  656,
  657,
  658,
  659,
  660,
  661,
  662,
  663,
  664,
  665,
  666,
  693,
  694,
  730,
  732,
  744,
  809,
  828,
  829,
  830,
  831,
  832,
  833,
  834,
  835,
  836,
  837,
  838,
  839,
  840,
  841,
  842,
  843,
  844,
  845,
  846,
  847,
  848,
  849,
  850,
  851,
  852,
  853,
  854,
  855,
  884,
  886,
  887,
  888,
  889,
  890,
  891,
  892,
  893,
  894,
  895,
  896,
  897,
  898,
  899,
  900,
  901,
  902,
  903,
  904,
  905,
  906,
  907,
  908,
  909,
  910,
  911,
  965,
  992,
  993,
  1021,
  1062,
  1105,
  1134,
  1145,
  1149,
  1206,
  1209,
  1240,
  1259,
  1272,
  1440,
  1461,
  1486,
  1494,
  1495,
  1496,
  1497,
  1498,
  1499,
  1500,
  1501,
  1502,
  1503,
  1504,
  1505,
  1506,
  1507,
  1510,
  1546,
  1555,
  1556,
  1557,
  1558,
  1559,
  1560,
  1561,
  1562,
  1563,
  1564,
  1565,
  1566,
  1567,
  1568,
  1569,
  1570,
  1571,
  1599,
  1607,
  1617,
  1625,
  1646,
  1660,
  1671,
  1679,
  1694,
  1716,
  1717,
  1718,
  1719,
  1720,
  1721,
  1722,
  1723,
  1724,
  1725,
  1726,
  1727,
  1728,
  1729,
  1730,
  1731,
  1732,
  1733,
  1740,
  1741,
  1742,
  1824,
  1825,
  1826,
  1827,
  1828,
  1829,
  1830,
  1831,
  1832,
  1833,
  1834,
  1835,
  1836,
  1837,
  1880,
  1881,
  1882,
  1883,
  1884,
  1885,
  1886,
  1887,
  1888,
  1889,
  1890,
  1891,
  1892,
  1893,
  1894,
  1895,
  1896,
  1897,
  1898,
  1899,
  1900,
  1901,
  1902,
  1903,
  1904,
  1905,
  1906,
  1907,
  1936,
  1950,
  1951,
  1952,
  1953,
  1954,
  1955,
  1956,
  1957,
  1958,
  1959,
  1960,
  1961,
  1962,
  1963,
  2029,
  2034,
  2035,
  2036,
  2037,
  2038,
  2039,
  2040,
  2041,
  2042,
  2043,
  2044,
  2045,
  2046,
  2047
]

#ONLINE CHANNEL NUMBERS HIGHLIGHTED AS BAD BY DAN AND AARON.
#BadChannels: [
#25,   
#27,   
#29,   
#31,	  
#38,   
#63,   
#78,   
#83,   
#85,   
#244,  
#253,  
#262,  
#281,  
#283,  
#285,  
#337,  
#339,  
#341,  
#383,	 
#406,  
#413,  
#415,  
#427,  
#448,  
#449,  
#450,  
#451,  
#464,  
#543,  
#555,  
#589,  
#595,  
#597,	 
#598,  
#631,  
#678,  
#721,  
#723,	 
#751,  
#817,  
#829,  
#851,  
#853,	 
#923,  
#925,  
#927,  
#1083, 
#1091, 
#1094, 
#1107, 
#1109, 
#1155, 
#1193, 
#1194, 
#1206, 
#1209, 
#1222, 
#1307, 
#1356, 
#1363, 
#1365, 
#1435, 
#1469, 
#1475, 
#1492, 
#1495, 
#1520, 
#1559, 
#1563, 
#1565, 
#1567, 
#1584,	
#1606, 
#1619, 
#1621,	
#1659, 
#1665, 
#1675, 
#1678, 
#1680, 
#1682, 
#1686, 
#1693, 
#1695,	
#1696, 
#1707, 
#1708, 
#1711, 
#1726, 
#1727, 
#1742, 
#1743, 
#1744,	
#1758, 
#1775, 
#1786, 
#1787,
#1790,
#1791, 
#1815, 
#1817, 
#1819, 
#1821, 
#1823,	
#1837, 
#1846, 
#1849, 
#1859, 
#1861, 
#1873, 
#1875, 
#1877, 
#1919,	
#1947, 
#1968,	
#1981, 
#1990, 
#2001,	
#2003,	
#2032, 
#2038, 
#2047  
#]		

  NoisyChannels: []
} 

# Bad channel list from David Adams
# January 2017
# Many runs over the course of my dataset list were studied.
# Channels are typically declared bad if any fail.
# Notes made when runs look good before or after power failure.
# Bad channels from the wahl list (above) are retained and have less indentation.
# Annotation:
#   SB - Four-consecutive sticky code fraction is greater than 30%
#   NSB - Four-consectuve non-sticky code repeat fraction is greater than 5%
#   RMS>X - RMS with 3*RMS truncation is greater than X

dune35t_channel_status_dla: {
# implements IChannelStatusService
service_provider: SimpleChannelStatusService

  BadChannels: [
# APA 0u 0-143
       2,   # SB
    4,      # NSB
       9,   # NSB
      31,   # SB
      36,   # RMS>=45
   39,      # RMS=2
   51,      # RMS=1
      65,   # SB
      80,   # RMS>=40
   84,      # RMS=2
      88,   # SB (OK for 2nd half)
      92,   # SB (OK for 2nd half)
   92,      # RMS=2
     100,   # SB
     101,   # SB
     102,   # SB
     103,   # SB
     104,   # SB
     105,   # SB
     106,   # SB
     111,   # RMS>=40
  110,      # RMS=5
     117,   # NSB
  120,
# APA 0v 144-287
  145,      # RMS=3
  146,      # RMS=1
     147,   # RMS>=50
     148,   # NSB
     183,   # SB
  204,      # SB, RMS=2
  213,      # RMS=3
     215,   # SB, RMS=40
     216,   # RMS=6
     217,   # RMS=6
     218,   # RMS=6
     219,   # RMS=40
     238,   # SB (2nd half OK)
     236,   # SB (2nd half OK)
  240,      # RMS=3
     249,   # SB
     252,   # NSB
     253,   # SB
     254,   # SB
     255,   # SB
     256,   # NSB
     257,   # SB
     258,   # SB
     259,   # SB
     260,   # SB
     280,   # SB
     287,   # RMS>=45
# APA 0z1  288-399
     319,   # SB
     346,   # SB (intermittent)
     347,   # SB (intermittent)
     348,   # SB (intermittent)
  357,      # NSB
# APA 0z2  400-511
     400,   # RMS>35
     401,   # RMS>35, sticks on 0x1
     402,   # RMS>35
     403,   # RMS>35
     404,   # RMS>35
     405,   # RMS>35
     406,   # RMS>35
     407,   # RMS>35
     408,   # RMS>35
     409,   # RMS>35
     410,   # RMS>35
     411,   # RMS>35
  432,      # RMS=5
  433,      # RMS=3
     434,   # SB (intermittent)
     441,   # SB (intermittent)
     444,   # SB
  446,      # RMS=5
  451,      # RMS=2
     458,   # SB (intermittent)
     460,   # SB (intermittent)
     469,   # SB (intermittent)
     493,   # SB (intermittent)
  496,      # SB (intermittent), RMS OK
  500,      # RMS=2
# APA 1u  512-655
     513,   # SB
     517,   # SB
  520,      # SB, RMS=0
  524,      # NSB, RMS = 1
  530,      # RMS=2
     533,   # SB
     538,   # SB, RMS=2
     539,   # SB, RMS=1
  547,      # RMS=2
     548,   # SB
     560,   # SB
     561,   # SB
     564,   # SB, RMS>30
     565,   # RMS>30
     566,   # NSB, RMS>50,RMS=1
     567,   # NSB
     568,   # NSB
     569,   # NSB
     560,   # NSB
     571,   # NSB
     572,   # NSB
     573,   # NSB
  574,      # RMS>50
  575,      # RMS>50
  576,      # RMS>50
  577,      # RMS>50
  578,      # RMS>50
  579,      # RMS>50
  580,      # RMS>50
  581,      # RMS>50
  582,      # RMS>50
  583,      # RMS>50
  611,      # RMS=3
     619,   # SB
     620,   # RMS=6
     621,   # RMS=6dd
     622,   # RMS=6
     623,   # SB
     626,   # SB
  632,      # RMS=0
     649,   # SB
     650,   # SB
     651,   # SB
     652,   # SB
     653,   # SB
     654,   # SB
# APA 1v  656-799
  656,      # NSB, RMS>50
  657,      # RMS>50
  658,      # RMS>50
  659,      # RMS>50
  660,      # RMS>50
  661,      # RMS>50
  662,      # RMS>50
  663,      # RMS>50
  664,      # RMS>50
  665,      # RMS>50
  666,      # SB OK, RMS OK
     669,   # SB
     675,   # SB
     692,   # RMS>40
  693,      # SB OK, RMS OK
  694,
     728,   # NSB
     729,   # SB, RMS=3
  730,      # SB, RMS=3
     731,   # SB, RMS=3
  732,      # NSB
     736,   # SB
     738,   # RMS>50 (intermittent)
  744,      # SB OK, RMS OK
     760,   # SB
     771,   # SB (OK for 1st half)
     776,   # SB (OK for 1st half)
     788,   # SB
     792,   # SB
# APA 1z1 800-911
     804,   # SB (OK for 1st half)
  809,      # RMS=1
     819,   # SB
     821,   # SB
     822,   # SB (OK for 1st half)
     826,   # SB
  828,      # RMS=2
  829,      # RMS=2
  830,      # RMS=2
  831,      # RMS=2
  832,      # RMS=2
  833,      # RMS=2
  834,      # RMS=2
  835,      # RMS=2
  836,      # RMS=2
  837,      # RMS=2
  838,      # RMS=2
  839,      # RMS=2
  840,      # RMS=2
  841,      # RMS=2
  842,      # RMS=2
  843,      # RMS=2
  844,      # RMS=2
  845,      # RMS=2
  846,      # RMS=2
  847,      # RMS=2
  848,      # RMS=2
  849,      # RMS=2
  850,      # RMS=2
  851,      # RMS=2
  852,      # RMS=2
  853,      # RMS=2
  854,      # RMS=2
  855,      # RMS=2
     856,   # SB
     857,   # SB
     858,   # SB
     859,   # SB
     860,   # SB
     861,   # SB
     862,   # SB
     863,   # SB
     864,   # SB
     865,   # SB
     866,   # SB
     867,   # SB
     868,   # SB
     869,   # SB
     826,   # SB
     826,   # SB
     826,   # SB
     826,   # SB
     826,   # SB
     826,   # SB
     826,   # SB
  884,      # RMS>50
     885,   # RMS>50
  886,      # RMS>50
  887,      # RMS>50
  888,      # RMS>50
  889,      # RMS>50
  890,      # RMS>50
  891,      # RMS>50
  892,      # RMS>50
  893,      # RMS>50
  894,      # RMS>50
  895,      # RMS>50
  896,      # RMS>50
  897,      # RMS>50
  898,      # RMS>50
  899,      # RMS>50
  900,      # RMS>50
  901,      # RMS>50
  902,      # RMS>50
  903,      # RMS>50
  904,      # RMS>50
  905,      # RMS>50
  906,      # RMS>50
  907,      # RMS>50
  908,      # RMS>50
  909,      # RMS>50
  910,      # RMS>50
  911,      # RMS>50
# APA 1z2 912-1023
     940,   # SB (OK for 1st half)
     943,   # SB
     948,   # SB
     952,   # SB
  965,      # RMS=3
     978,   # SB
     980,   # SB
  992,      # RMS=0
  993,      # RMS=1
    1016,   # SB
  1021,     # RMS=1
    1023,   # SB (OK for 1st half)
# APA 2u 1024-1167
    1025,   # SB
    1026,   # SB
    1047,   # SB (OK for 2nd half of run)
    1051,   # SB (OK for 1st half of run)
    1055,   # SB
    1058,   # NSB
  1062,     # SB OK
    1063,   # SB (OK for 2nd half of run)
    1077,   # SB
    1087,   # SB
    1088,   # SB
    1089,   # SB
    1090,   # SB
    1091,   # SB
    1092,   # SB
    1093,   # SB
    1094,   # SB
    1095,   # NSB
    1097,   # SB OK, RMS=8, missing intermediate freq noise
    1102,   # SB (OK for 2nd half of run)
  1105,     # SB OK
    1122,   # SB (OK for 2nd half of run)
    1126,   # SB (OK for 1st half of run)
  1134,     # NSB
    1141,   # SB
  1145,     # SB OK
  1149,     # SB
    1160,   # SB
    1161,   # SB
    1162,   # SB
    1163,   # SB
    1164,   # SB
    1165,   # SB
    1166,   # SB
# APA 2v 1168-1311
    1169,   # SB
    1170,   # SB
    1171,   # SB
    1172,   # SB
    1173,   # SB
    1174,   # SB
    1175,   # SB
    1176,   # SB
    1189,   # SB, OK for 1st half of run
    1194,   # SB
    1204,   # NSB
    1205,   # SB
  1206,     # wahl, NSB, RMS=2
    1207,   # SB, OK for 1st half of run
    1208,   # NSB
  1209,     # wahl, SB, RMS=8 for run 13843
    1210,   # SB, OK for 2nd half of run
    1211,   # NSB
    1216,   # SB, OK for 2nd half of run
    1217,   # SB, OK for 2nd half of run
    1226,   # SB
  1240,     # wahl, SB OK, RMS=0
    1241,   # SB
    1242,   # SB
    1243,   # SB
    1244,   # SB
    1245,   # SB
    1246,   # SB
    1247,   # SB
    1254,   # SB, OK for 1st half of run
    1255,   # SB, OK for 2nd half of run
  1259,     # wahl, SB OK, RMS=3
  1272,     # wahl, SB OK, RMS=9
    1273,   # SB
    1279,   # SB
    1295,   # SB
    1298,   # SB, OK for 1st half of run
    1299,   # NSB
    1310,   # SB
# APA 2z1 1312-1423
    1312,   # NSB
    1313,   # NSB
    1314,   # NSB
    1315,   # NSB
    1316,   # NSB
    1317,   # NSB
    1318,   # NSB
    1319,   # NSB
    1320,   # NSB
    1321,   # NSB
    1322,   # NSB
    1323,   # NSB
    1324,   # NSB
    1325,   # NSB
    1340,   # SB
    1358,   # SB, OK for 2nd half of run
    1378,   # SB
    1382,   # SB
    1388,   # SB
    1397,   # SB, OK for 1st half of run
    1407,   # SB, OK for 1st half of run
    1413,   # SB, OK for 2nd half of run
    1421,   # SB
# APA 2z2 1424-1535
    1430,   # SB, OK for 1st half of run
    1439,   # SB
    1439,   # SB
  1440,     # wahl, SB
    1442,   # SB
    1447,   # SB, OK for 1st half
    1450,   # SB
    1458,   # SB
  1461,
    1468,   # SB, OK for 1st half of run
    1472,   # SB, OK for 1st half of run
    1472,   # SB
    1478,   # SB
  1486,     # wahl, SB
  1494,     # wahl, RMS low and jumpy
  1495,     # wahl, RMS low and jumpy
  1496,     # wahl, RMS low and jumpy
  1497,     # wahl, RMS low and jumpy
  1498,     # wahl, RMS low and jumpy
  1499,     # wahl, RMS low and jumpy
  1500,     # wahl, RMS low and jumpy
  1501,     # wahl, RMS low and jumpy
  1502,     # wahl, RMS low and jumpy
  1503,     # wahl, RMS low and jumpy
  1504,     # wahl
  1505,     # wahl, RMS low and jumpy
  1506,     # wahl, RMS low and jumpy
  1507,     # wahl, RMS low and jumpy
  1510,     # wahl, NSB
    1511,   # SB, OK for 2nd half
    1520,   # SB, OK for 2nd half
    1528,   # SB
# APA 3u 1536-1679
  1546,     # NSB, RMS=1
    1547,   # NSB, RMS=5
    1554,   # RMS=0
  1555,     # RMS=0
  1556,     # RMS=0
  1557,     # RMS=0
  1558,     # RMS=0
  1559,     # RMS=0
  1560,     # RMS=0
  1561,     # RMS=0
  1562,     # RMS=0
  1563,     # RMS=0
  1564,     # RMS=0
  1565,     # RMS=0
  1566,     # RMS=0
  1567,     # RMS=0
  1568,     # RMS=0
  1569,     # RMS=0
  1570,     # RMS=0
  1571,     # RMS=0
    1574,   # RMS=7
    1575,   # RMS>45
    1588,   # SB
    1589,   # RMS>40
  1599,     # RMS=2
    1606,   # SB
  1607,     # RMS=1
  1617,     # RMS=2
    1621,   # SB
  1625,     # RMS=2
    1637,   # SB (OK for 1st half)
    1638,   # SB (OK for 1st half)
    1639,   # SB (OK for 1st half)
    1640,   # SB (OK for 1st half)
    1641,   # SB (OK for 1st half)
    1642,   # SB (OK for 1st half)
    1643,   # SB (OK for 1st half)
  1646,     # RMS=5
    1647,   # RMS>45
  1660,     # RMS=2
    1661,   # RMS>45
  1671,     # NSB, RMS=2
    1672,   # SB (OK for 2nd half)
    1673,   # SB (OK for 2nd half)
    1674,   # SB (OK for 2nd half)
    1675,   # SB (OK for 2nd half)
    1676,   # SB (OK for 2nd half)
    1677,   # SB (OK for 2nd half)
    1678,   # SB (OK for 2nd half)
  1679,     # RMS=2
# APA 3v 1680-1823
  1694,     # RMS=3
  1716,     # RMS=0
  1717,     # RMS=0
  1718,     # RMS=0
  1719,     # RMS=0
  1720,     # RMS=0
  1721,     # RMS=0
  1722,     # RMS=0
  1723,     # RMS=0
  1724,     # RMS=0
  1725,     # RMS=0
  1726,     # RMS=0
  1727,     # RMS=0
  1728,     # RMS=0
  1729,     # RMS=0
  1730,     # RMS=0
  1731,     # RMS=0
  1732,     # RMS=0
  1733,     # RMS=0
  1740,     # RMS=2
  1741,     # RMS=2
  1742,     # RMS=2
    1752,   # NSB
    1753,   # SB, RMS=3
    1754,   # SB
    1755,   # SB
    1756,   # NSB
    1757,   # SB
    1758,   # SB
    1759,   # SB
    1788,   # NSB (intermittent)
    1792,   # NSB (intermittent)
# APA 3z1 1824-1935
  1824,     # RMS=2
  1825,     # RMS=2
  1826,     # RMS=2
  1827,     # RMS=2
  1828,     # RMS=2
  1829,     # RMS=2
  1830,     # RMS=2
  1831,     # RMS=2
  1832,     # RMS=2
  1833,     # RMS=2
  1834,     # RMS=2
  1835,     # RMS=2
  1836,     # RMS=2
  1837,     # RMS=2
    1843,   # SB (OK for 1st half)
    1866,   # SB
    1870,   # SB
  1880,     # RMS=0
  1881,     # RMS=0
  1882,     # RMS=0
  1883,     # RMS=0
  1884,     # RMS=0
  1885,     # RMS=0
  1886,     # RMS=0
  1887,     # RMS=0
  1888,     # RMS=0
  1889,     # RMS=0
  1890,     # RMS=0
  1891,     # RMS=0
  1892,     # RMS=0
  1893,     # RMS=0
  1894,     # RMS=0
  1895,     # RMS=0
  1896,     # RMS=0
  1897,     # RMS=0
  1898,     # RMS=0
  1899,     # RMS=0
  1900,     # RMS=0
  1901,     # RMS=0
  1902,     # RMS=0
  1903,     # RMS=0
  1904,     # RMS=0
  1905,     # RMS=0
  1906,     # RMS=0
  1907,     # RMS=0
    1909,   # SB (1st half OK)
# APA 3z2 1936-2047
  1936,     # RMS=2
    1946,   # SB
    1948,   # SB (OK for 2nd half)
  1950,     # RMS=2
  1951,     # RMS=2
  1952,     # RMS=2
  1953,     # RMS=2
  1954,     # RMS=2
  1955,     # RMS=2
  1956,     # RMS=2
  1957,     # RMS=2
  1958,     # RMS=2
  1959,     # RMS=2
  1960,     # RMS=2
  1961,     # RMS=2
  1962,     # RMS=2
  1963,     # RMS=2
    1974,   # SB (OK for 1st half)
    1992,   # SB
    1995,   # SB (OK for 2nd half)
    2004,   # SB
  2029,     # RMS=3
  2034,     # RMS=2
  2035,     # RMS=2
  2036,     # RMS=2
  2037,     # RMS=2
  2038,     # RMS=2
  2039,     # RMS=2
  2040,     # RMS=2
  2041,     # RMS=2
  2042,     # RMS=2
  2043,     # RMS=2
  2044,     # RMS=2
  2045,     # RMS=2
  2046,     # RMS=2
  2047      # RMS=2
]

  NoisyChannels: []
} 

dunedphase3x1x1_channel_status: {
# implements IChannelStatusService
service_provider: SimpleChannelStatusService

# list of bad channels:
                    BadChannels:   [
#view 0
0,    #blind
#49,
#77, 
#122,
159,  #blind
160,  #blind
#172,
#178,
#183,
#184,
#216,
#218,
#288,
319,  #blind
#view 1
320,  #blind
#477,
479,  #blind
480,  #blind
#550,
#569,
639,  #blind
640,  #blind
#674,
799,  #blind
800,  #blind
#828,
959,  #blind
960,  #blind
#1144,
1119, #blind
1120, #blind
#1275,
1279  #blind
]

# list of bad noisy channels:
                    NoisyChannels: [
#plane 0:
41    #constantly high noise
#plane 1:
]

                       } 

dunefd_channel_status: {
# implements IChannelStatusService
service_provider: SimpleChannelStatusService

# list of bad channels:
                    BadChannels:   [
]

# list of bad noisy channels:
                    NoisyChannels: [
]

                       } 

END_PROLOG
# channelstatus_pdsp.fcl
#
# David Adams
# October 2018
#
# Bad and noisy channels for protDUNE single phase.

# Include bad channel maps.
# channelstatus_pdsp_2081.fcl
#
# David Adams
# October 2018
#
# Bad and noisy channels for protDUNE single phase.

BEGIN_PROLOG

pdsp_channel_status_2018: {
 
  # implements IChannelStatusService
  service_provider: SimpleChannelStatusService

  # list of bad channels:
  BadChannels:   [
    # CE group: Inactive FE
     4411,  # femb515x12
     4412,  # femb515x13
     9990,  # femb605x10
    11842,  # femb120x03
    # CE group: Broken connection
        1,  # femb311u39
      400,  # femb301u40
      401,  # femb301u39
      800,  # femb320v01
      801,  # femb320v02
      876,  # femb319v37
     1200,  # femb310v01
     2961,  # femb501u39
     5321,  # femb216u39
     5363,  # femb217u37
     6132,  # femb215v13
     7058,  # femb213x03
     7295,  # femb202x01
     7681,  # femb611u39
     8080,  # femb601u40
     8328,  # femb607u32
     8480,  # femb620v01
     9282,  # femb620x03
     9283,  # femb620x04
     9736,  # femb611x25
     9854,  # femb602x02
    10800,  # femb105u40
    11024,  # femb110u16
    11457,  # femb110v18
    11459,  # femb110v20
    11463,  # femb110v24
    11469,  # femb110v30: bad in 4875-185-1500, ok in 5803-76-3200
    11517,  # femb109v38
    11669,  # femb105v30
    11679,  # femb105v40
    12756,  # femb110x44
    12801,  # femb411u39
    13001,  # femb416u39
    13081,  # femb418u39
    # CE group: ENC > 2000e
     4410,  # femb515x11: High noise, no signal 5008-76
    #-----
    # CE group excessive sticky
    #femb318x
     1719,  # femb318x24
     5125,  # femb211u35
     7551,  # femb208x33
     7190,  # femb211x39
     7194,  # femb211x43
     7918,  # femb616u02, sticky pedestal (three peaks)
    #-----
    # CE group: good.
    # femb311
        2,  # femb311u38, no signal
        4,  # femb311u36, very sticky pedestal 5308-76
     1632,  # femb320x33, very sticky pedestal 5308-76
     2169,  # femb302x07, Mostly stuck on one bad code, 5308-76
     2450,  # femb308x14, Very noisy (1000 ADC) in run 5759 (20nov2019)
     3541,  # femb516v22, very sticky--signal near zero half the time (5308-81)
     3543,  # femb516v24, very sticky--signal near zero half the time (5308-81)
     3661,  # femb513v22, most signal near zero (5308-81)
     3663,  # femb513v24, most signal near zero (5308-81)
     4061,  # femb503v22, most signal near zero (5308-81)
     4063,  # femb503v24, most signal near zero (5308-81)
     4141,  # femb501v22, signal near zero half the time (5308-81)
     4143,  # femb501v24, signal sometimes near zero (5308-81)
     4377,  # femb516x26, very sticky pedestal
     4379,  # femb516x28, very sticky pedestal
     4381,  # femb516x30, very sticky pedestal
     4383,  # femb516x32, very sticky pedestal
     4385,  # femb516x34, very sticky pedestal
     4387,  # femb516x36, very sticky pedestal
     4521,  # femb513x26, very sticky pedestal
     4523,  # femb513x28, very sticky pedestal
     4525,  # femb513x30, very sticky pedestal
     4527,  # femb513x32, very sticky pedestal
     4529,  # femb513x34, very sticky pedestal
     4531,  # femb513x36, very sticky pedestal
     4652,  # femb501x36, very sticky pedestal
     4654,  # femb501x34, very sticky pedestal
     4656,  # femb501x32, very sticky pedestal
     4658,  # femb501x30, very sticky pedestal
     4660,  # femb501x28, very sticky pedestal
     4748,  # femb503x36, very sticky pedestal
     4750,  # femb503x34, very sticky pedestal
     4752,  # femb503x32, very sticky pedestal
     4754,  # femb503x30, very sticky pedestal
     4756,  # femb503x28, very sticky pedestal
     4758,  # femb503x26, very sticky pedestal
     5361,  # femb217u39, no signal
     7680,  # femb611u40: No signal in 5308-76, end wire
     8501,  # femb620v22, very sticky pedestal
     8503,  # femb620v24, very sticky pedestal
     8821,  # femb612v22, very sticky pedestal
     8823,  # femb612v24, very sticky pedestal
     9261,  # femb601v22, very sticky pedestal
     9263,  # femb601v24, very sticky pedestal
     9305,  # femb620x26, very sticky pedestal
     9307,  # femb620x28, very sticky pedestal
     9309,  # femb620x30, very sticky pedestal
     9311,  # femb620x32, very sticky pedestal
     9313,  # femb620x34, very sticky pedestal
     9315,  # femb620x36, very sticky pedestal
     9689,  # femb612x26, very sticky pedestal
     9691,  # femb612x28, very sticky pedestal
     9693,  # femb612x30, very sticky pedestal
     9695,  # femb612x32, very sticky pedestal
     9697,  # femb612x34, very sticky pedestal
     9699,  # femb612x36, very sticky pedestal
     9772,  # femb601x26, very sticky pedestal
     9774,  # femb601x28, very sticky pedestal
     9776,  # femb601x30, very sticky pedestal
     9778,  # femb601x32, very sticky pedestal
     9780,  # femb601x34, very sticky pedestal
     9782,  # femb601x36, very sticky pedestal
    10102,  # femb608x42, mostly stuck on one code
    10189,  # femb609x03, mostly stuck on one code
    10697,  # femb102u23, mostly stuck on a few classic codes
    10907,  # femb107u13, mostly stuck on one code
    11203,  # femb116v04, stuck on many classic codes
    11270,  # femb115v31, stuck on many classic codes
    11902,  # femb119x15, stuck on two classic codes
    12324,  # femb101x44, stuck on many classic codes
    12333,  # femb101x35, stuck on many classic codes
    12744,  # femb109x08, stuck on many classic codes
    13363,  # femb405u37, very noisy, nosignal 5308-76-4800

    #-----
    # These 16 channels are an intermitently bad ASIC.
    # Matt W. 19oct2018.
    # femb316u
      200,   # femb316u40
      202,   # femb316u38
      204,   # femb316u36
      206,   # femb316u34
      208,   # femb316u32
    # femb316v
      991,   # femb316v32
      993,   # femb316v34
      995,   # femb316v36
      997,   # femb316v38
      999,   # femb316v40
    # femb316x
     1829,   # femb316x38
     1831,   # femb316x40
     1833,   # femb316x42
     1835,   # femb316x44
     1837,   # femb316x46
     1839    # femb316x48
    #-----
  ]

  # list of bad noisy channels:
  NoisyChannels: [
    # CE group: ENC > 2000e
     9569,
    # CE group: sticky.
     2318,
    # DLA sticky
    # femb311u
        4,
    # femb313u
       94,
    # femb319u
      325,  # femb319u35, 2020-02-27: Mostly stuck on one bad code 5141, 5795, 8764, ...
    # femb302u
      442,
      447,
      453,
      455,
      456,
      472,
      477,
    # femb304u
      571,
      573,
    # femb302v
     1534,
     1539,
     1546,
    # femb315x
     1864,
     #1864,  # acceptable??
    # femb302x
     2135,
     2146,
     2158,
     2161,
    # femb513u
     2674,  # 2-value pedestal
   # femb518u
     2833,  # Noisy adc pedestal
   # femb516x
     4377,  # Pedestal very sticky
   # femb503x
     4654,  # sticky pedestal
     4658,  # sticky pedestal
     4662,  # sticky pedestal
   # femb503x
     4752,  # sticky pedestal
   # femb214u
     5271,  # sticky pedestal
   # femb217u
     5377,  # sticky pedestal
   # femb218u
     5400,  # sticky pedestal
     5423,  # sticky pedestal
   # femb201x
     7220, # Pedestal stuck on 980
   # femb203x
     7334, # Pedestal stuck on 980,981
   # femb204x
     7347, # Pedestal stuck on 979
   # femb207x
     7396, # Sticky pedestal
   # femb607x
     8341 # Sticky pedestal
  ]

}

END_PROLOG
# channelstatus_pdsp.fcl
#
# David Adams
# October 2018
#
# Bad and noisy channels for protDUNE single phase.

# Include old bad channel maps.
# channelstatus_pdsp_2081.fcl
#
# David Adams
# October 2018
#
# Bad and noisy channels for protDUNE single phase.

BEGIN_PROLOG

pdsp_channel_status_2018: {
 
  # implements IChannelStatusService
  service_provider: SimpleChannelStatusService

  # list of bad channels:
  BadChannels:   [
    # CE group: Inactive FE
     4411,  # femb515x12
     4412,  # femb515x13
     9990,  # femb605x10
    11842,  # femb120x03
    # CE group: Broken connection
        1,  # femb311u39
      400,  # femb301u40
      401,  # femb301u39
      800,  # femb320v01
      801,  # femb320v02
      876,  # femb319v37
     1200,  # femb310v01
     2961,  # femb501u39
     5321,  # femb216u39
     5363,  # femb217u37
     6132,  # femb215v13
     7058,  # femb213x03
     7295,  # femb202x01
     7681,  # femb611u39
     8080,  # femb601u40
     8328,  # femb607u32
     8480,  # femb620v01
     9282,  # femb620x03
     9283,  # femb620x04
     9736,  # femb611x25
     9854,  # femb602x02
    10800,  # femb105u40
    11024,  # femb110u16
    11457,  # femb110v18
    11459,  # femb110v20
    11463,  # femb110v24
    11469,  # femb110v30: bad in 4875-185-1500, ok in 5803-76-3200
    11517,  # femb109v38
    11669,  # femb105v30
    11679,  # femb105v40
    12756,  # femb110x44
    12801,  # femb411u39
    13001,  # femb416u39
    13081,  # femb418u39
    # CE group: ENC > 2000e
     4410,  # femb515x11: High noise, no signal 5008-76
    #-----
    # CE group excessive sticky
    #femb318x
     1719,  # femb318x24
     5125,  # femb211u35
     7551,  # femb208x33
     7190,  # femb211x39
     7194,  # femb211x43
     7918,  # femb616u02, sticky pedestal (three peaks)
    #-----
    # CE group: good.
    # femb311
        2,  # femb311u38, no signal
        4,  # femb311u36, very sticky pedestal 5308-76
     1632,  # femb320x33, very sticky pedestal 5308-76
     2169,  # femb302x07, Mostly stuck on one bad code, 5308-76
     2450,  # femb308x14, Very noisy (1000 ADC) in run 5759 (20nov2019)
     3541,  # femb516v22, very sticky--signal near zero half the time (5308-81)
     3543,  # femb516v24, very sticky--signal near zero half the time (5308-81)
     3661,  # femb513v22, most signal near zero (5308-81)
     3663,  # femb513v24, most signal near zero (5308-81)
     4061,  # femb503v22, most signal near zero (5308-81)
     4063,  # femb503v24, most signal near zero (5308-81)
     4141,  # femb501v22, signal near zero half the time (5308-81)
     4143,  # femb501v24, signal sometimes near zero (5308-81)
     4377,  # femb516x26, very sticky pedestal
     4379,  # femb516x28, very sticky pedestal
     4381,  # femb516x30, very sticky pedestal
     4383,  # femb516x32, very sticky pedestal
     4385,  # femb516x34, very sticky pedestal
     4387,  # femb516x36, very sticky pedestal
     4521,  # femb513x26, very sticky pedestal
     4523,  # femb513x28, very sticky pedestal
     4525,  # femb513x30, very sticky pedestal
     4527,  # femb513x32, very sticky pedestal
     4529,  # femb513x34, very sticky pedestal
     4531,  # femb513x36, very sticky pedestal
     4652,  # femb501x36, very sticky pedestal
     4654,  # femb501x34, very sticky pedestal
     4656,  # femb501x32, very sticky pedestal
     4658,  # femb501x30, very sticky pedestal
     4660,  # femb501x28, very sticky pedestal
     4748,  # femb503x36, very sticky pedestal
     4750,  # femb503x34, very sticky pedestal
     4752,  # femb503x32, very sticky pedestal
     4754,  # femb503x30, very sticky pedestal
     4756,  # femb503x28, very sticky pedestal
     4758,  # femb503x26, very sticky pedestal
     5361,  # femb217u39, no signal
     7680,  # femb611u40: No signal in 5308-76, end wire
     8501,  # femb620v22, very sticky pedestal
     8503,  # femb620v24, very sticky pedestal
     8821,  # femb612v22, very sticky pedestal
     8823,  # femb612v24, very sticky pedestal
     9261,  # femb601v22, very sticky pedestal
     9263,  # femb601v24, very sticky pedestal
     9305,  # femb620x26, very sticky pedestal
     9307,  # femb620x28, very sticky pedestal
     9309,  # femb620x30, very sticky pedestal
     9311,  # femb620x32, very sticky pedestal
     9313,  # femb620x34, very sticky pedestal
     9315,  # femb620x36, very sticky pedestal
     9689,  # femb612x26, very sticky pedestal
     9691,  # femb612x28, very sticky pedestal
     9693,  # femb612x30, very sticky pedestal
     9695,  # femb612x32, very sticky pedestal
     9697,  # femb612x34, very sticky pedestal
     9699,  # femb612x36, very sticky pedestal
     9772,  # femb601x26, very sticky pedestal
     9774,  # femb601x28, very sticky pedestal
     9776,  # femb601x30, very sticky pedestal
     9778,  # femb601x32, very sticky pedestal
     9780,  # femb601x34, very sticky pedestal
     9782,  # femb601x36, very sticky pedestal
    10102,  # femb608x42, mostly stuck on one code
    10189,  # femb609x03, mostly stuck on one code
    10697,  # femb102u23, mostly stuck on a few classic codes
    10907,  # femb107u13, mostly stuck on one code
    11203,  # femb116v04, stuck on many classic codes
    11270,  # femb115v31, stuck on many classic codes
    11902,  # femb119x15, stuck on two classic codes
    12324,  # femb101x44, stuck on many classic codes
    12333,  # femb101x35, stuck on many classic codes
    12744,  # femb109x08, stuck on many classic codes
    13363,  # femb405u37, very noisy, nosignal 5308-76-4800

    #-----
    # These 16 channels are an intermitently bad ASIC.
    # Matt W. 19oct2018.
    # femb316u
      200,   # femb316u40
      202,   # femb316u38
      204,   # femb316u36
      206,   # femb316u34
      208,   # femb316u32
    # femb316v
      991,   # femb316v32
      993,   # femb316v34
      995,   # femb316v36
      997,   # femb316v38
      999,   # femb316v40
    # femb316x
     1829,   # femb316x38
     1831,   # femb316x40
     1833,   # femb316x42
     1835,   # femb316x44
     1837,   # femb316x46
     1839    # femb316x48
    #-----
  ]

  # list of bad noisy channels:
  NoisyChannels: [
    # CE group: ENC > 2000e
     9569,
    # CE group: sticky.
     2318,
    # DLA sticky
    # femb311u
        4,
    # femb313u
       94,
    # femb319u
      325,  # femb319u35, 2020-02-27: Mostly stuck on one bad code 5141, 5795, 8764, ...
    # femb302u
      442,
      447,
      453,
      455,
      456,
      472,
      477,
    # femb304u
      571,
      573,
    # femb302v
     1534,
     1539,
     1546,
    # femb315x
     1864,
     #1864,  # acceptable??
    # femb302x
     2135,
     2146,
     2158,
     2161,
    # femb513u
     2674,  # 2-value pedestal
   # femb518u
     2833,  # Noisy adc pedestal
   # femb516x
     4377,  # Pedestal very sticky
   # femb503x
     4654,  # sticky pedestal
     4658,  # sticky pedestal
     4662,  # sticky pedestal
   # femb503x
     4752,  # sticky pedestal
   # femb214u
     5271,  # sticky pedestal
   # femb217u
     5377,  # sticky pedestal
   # femb218u
     5400,  # sticky pedestal
     5423,  # sticky pedestal
   # femb201x
     7220, # Pedestal stuck on 980
   # femb203x
     7334, # Pedestal stuck on 980,981
   # femb204x
     7347, # Pedestal stuck on 979
   # femb207x
     7396, # Sticky pedestal
   # femb607x
     8341 # Sticky pedestal
  ]

}

END_PROLOG

BEGIN_PROLOG

pdsp_channel_status_nov2019: {
 
  # implements IChannelStatusService
  service_provider: SimpleChannelStatusService

  # list of bad channels:
  BadChannels:   [
    # CE group: Inactive FE
     4411,  # femb515x12
     4412,  # femb515x13
     9990,  # femb605x10
    11842,  # femb120x03
    # CE group: Broken connection
        1,  # femb311u39
      400,  # femb301u40
      401,  # femb301u39
      800,  # femb320v01
      801,  # femb320v02
      876,  # femb319v37
     1200,  # femb310v01
     2961,  # femb501u39
     5321,  # femb216u39
     5363,  # femb217u37
     6132,  # femb215v13
     7058,  # femb213x03
     7295,  # femb202x01
     7681,  # femb611u39
     7715,  # femb611u05 Very, very noisy in run 10527 (nov 2019)
     8080,  # femb601u40
     8328,  # femb607u32
     8480,  # femb620v01
     9282,  # femb620x03
     9283,  # femb620x04
     9736,  # femb611x25
     9854,  # femb602x02
    10033,  # femb106x15  low RMS, no response to pulser in 10493 (nov 2019)
    10800,  # femb105u40
    11001,  # femb110u39  v. low RMS in run 10419, 10527; no sig in 10527; responds to pulser (nov 2019)
    11011,  # femb110x39  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11014,  # femb110u26  v. low RMS in run 10419, 10527; no sig in 10527; responds to pulser (nov 2019)
    11013,  # femb110x37  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11015,  # femb110x35  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11017,  # femb110x33  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11018,  # femb110u32  v. low RMS in run 10404, 10527; no sig in 10527; responds to pulser (nov 2019)
    11019,  # femb110x31  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11024,  # femb110u16
    11457,  # femb110v18
    11459,  # femb110v20
    11460,  # femb110v21  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11462,  # femb110v23  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11463,  # femb110v24  (looks good in 10527 event 1 tick 1000)
    11464,  # femb110v25  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11466,  # femb110v27  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11467,  # femb110v28  v. low RMS in 10417; no signal in 10527 (nov 2019)
    11468,  # femb110v29  severe sticky code or stuck bit in run 10417, 10527 (nov 2019)
    11469,  # femb110v30: bad in 4875-185-1500, ok in 5803-76-3200; bad in 10527
    11501,  # femb109v22  v. low RMS in 10417; no signal in 10527 (nov 2019)
    11517,  # femb109v38
    12765,  # femb110x35  bad in run 10417 (nov 2019)
    11669,  # femb105v30
    12756,  # femb110x44
    12756,  # femb110x44
    12767,  # femb110x33  bad in run 10417 (nov 2019)
    12769,  # femb110x31  bad in run 10417 (nov 2019)
    12771,  # femb110x29  bad in run 10417 (nov 2019)
    12773,  # femb110x27  bad in run 10417 (nov 2019)
    12775,  # femb110x25  bad in run 10417 (nov 2019)
    12801,  # femb411u39
    13001,  # femb416u39
    13081,  # femb418u39
    # CE group: ENC > 2000e
     4410,  # femb515x11: High noise, no signal 5008-76
    #-----
    # CE group excessive sticky
    #femb318x
     1719,  # femb318x24
     5125,  # femb211u35
     7551,  # femb208x33
     7190,  # femb211x39
     7194,  # femb211x43
     7918,  # femb616u02, sticky pedestal (three peaks)
    #-----
    # CE group: good.
    # femb311
        2,  # femb311u38, no signal
        4,  # femb311u36, very sticky pedestal 5308-76
     1632,  # femb320x33, very sticky pedestal 5308-76
     2169,  # femb302x07, Mostly stuck on one bad code, 5308-76
     2450,  # femb308x14, Very noisy (1000 ADC) in run 5759 (nov 2019)
     3541,  # femb516v22, very sticky--signal near zero half the time (5308-81)
     3543,  # femb516v24, very sticky--signal near zero half the time (5308-81)
     3661,  # femb513v22, most signal near zero (5308-81)
     3663,  # femb513v24, most signal near zero (5308-81)
     4061,  # femb503v22, most signal near zero (5308-81)
     4063,  # femb503v24, most signal near zero (5308-81)
     4141,  # femb501v22, signal near zero half the time (5308-81)
     4143,  # femb501v24, signal sometimes near zero (5308-81)
     4377,  # femb516x26, very sticky pedestal
     4379,  # femb516x28, very sticky pedestal
     4381,  # femb516x30, very sticky pedestal
     4383,  # femb516x32, very sticky pedestal
     4385,  # femb516x34, very sticky pedestal
     4387,  # femb516x36, very sticky pedestal
     4521,  # femb513x26, very sticky pedestal
     4523,  # femb513x28, very sticky pedestal
     4525,  # femb513x30, very sticky pedestal
     4527,  # femb513x32, very sticky pedestal
     4529,  # femb513x34, very sticky pedestal
     4531,  # femb513x36, very sticky pedestal
     4652,  # femb501x36, very sticky pedestal
     4654,  # femb501x34, very sticky pedestal
     4656,  # femb501x32, very sticky pedestal
     4658,  # femb501x30, very sticky pedestal
     4660,  # femb501x28, very sticky pedestal
     4658,  # femb501x26, very sticky pedestal
     4748,  # femb503x36, very sticky pedestal
     4750,  # femb503x34, very sticky pedestal
     4752,  # femb503x32, very sticky pedestal
     4754,  # femb503x30, very sticky pedestal
     4756,  # femb503x28, very sticky pedestal
     4758,  # femb503x26, very sticky pedestal
     5361,  # femb217u39, no signal
     7680,  # femb611u40: No signal in 5308-76, end wire
     8501,  # femb620v22, very sticky pedestal
     8503,  # femb620v24, very sticky pedestal
     8821,  # femb612v22, very sticky pedestal
     8823,  # femb612v24, very sticky pedestal
     9261,  # femb601v22, very sticky pedestal
     9263,  # femb601v24, very sticky pedestal
     9305,  # femb620x26, very sticky pedestal
     9307,  # femb620x28, very sticky pedestal
     9309,  # femb620x30, very sticky pedestal
     9311,  # femb620x32, very sticky pedestal
     9313,  # femb620x34, very sticky pedestal
     9315,  # femb620x36, very sticky pedestal
     9689,  # femb612x26, very sticky pedestal
     9691,  # femb612x28, very sticky pedestal
     9693,  # femb612x30, very sticky pedestal
     9695,  # femb612x32, very sticky pedestal
     9697,  # femb612x34, very sticky pedestal
     9699,  # femb612x36, very sticky pedestal
     9772,  # femb601x26, very sticky pedestal
     9774,  # femb601x28, very sticky pedestal
     9776,  # femb601x30, very sticky pedestal
     9778,  # femb601x32, very sticky pedestal
     9780,  # femb601x34, very sticky pedestal
     9782,  # femb601x36, very sticky pedestal
    10102,  # femb608x42, mostly stuck on one code
    10189,  # femb609x03, mostly stuck on one code
    10697,  # femb102u23, mostly stuck on a few classic codes
    10907,  # femb107u13, mostly stuck on one code
    11203,  # femb116v04, stuck on many classic codes
    11270,  # femb115v31, stuck on many classic codes
    11902,  # femb119x15, stuck on two classic codes
    12324,  # femb101x44, stuck on many classic codes
    12333,  # femb101x35, stuck on many classic codes
    12744,  # femb109x08, stuck on many classic codes
    13363,  # femb405u37, very noisy, nosignal 5308-76-4800

    #-----
    # These 16 channels are an intermitently bad ASIC.
    # Matt W. 19oct2018.
    # femb316u
      200,   # femb316u40
      202,   # femb316u38
      204,   # femb316u36
      206,   # femb316u34
      208,   # femb316u32
    # femb316v
      991,   # femb316v32
      993,   # femb316v34
      995,   # femb316v36
      997,   # femb316v38
      999,   # femb316v40
    # femb316x
     1829,   # femb316x38
     1831,   # femb316x40
     1833,   # femb316x42
     1835,   # femb316x44
     1837,   # femb316x46
     1839    # femb316x48
    #-----
  ]

  # list of bad noisy channels:
  NoisyChannels: [
    # CE group: ENC > 2000e
     9569,
    # CE group: sticky.
     2318,
    # DLA sticky
    # femb311u
        4,
    # femb313u
       94,
    # femb319u
      325,  # femb319u35, 2020-02-27: Mostly stuck on one bad code 5141, 5795, 8764, ...
    # femb302u
      442,
      447,
      453,
      455,
      456,
      472,
      477,
    # femb304u
      571,
      573,
    # femb302v
     1534,
     1539,
     1546,
    # femb315x
     1864,
     #1864,  # acceptable??
    # femb302x
     2135,
     2146,
     2158,
     2161,
    # femb513u
     2674,  # 2-value pedestal
   # femb518u
     2833,  # Noisy adc pedestal
   # femb516x
     4377,  # Pedestal very sticky
   # femb503x
     4654,  # sticky pedestal
     4658,  # sticky pedestal
     4662,  # sticky pedestal
   # femb503x
     4752,  # sticky pedestal
   # femb214u
     5271,  # sticky pedestal
   # femb217u
     5377,  # sticky pedestal
   # femb218u
     5400,  # sticky pedestal
     5423,  # sticky pedestal
   # femb201x
     7220, # Pedestal stuck on 980
   # femb203x
     7334, # Pedestal stuck on 980,981
   # femb204x
     7347, # Pedestal stuck on 979
   # femb207x
     7396, # Sticky pedestal
   # femb607x
     8341, # Sticky pedestal
   # femb112x
   #  12252,  # nov 2019 pulser area is very noisy
   # femb102x
   #  12382   # nov 2019 pulser area is very noisy
     4473,  # femb514x26  Nonlinear response in nov 2019 calibration
     9641   # femb613x26  Nonlinear response in nov 2019 calibration
  ]

}

# Add channels with bad calibration pulser.
# Channel 4413 had bad fit in feb2019 calib but looks ok in nov.
pdsp_channel_status_nov2019_goodpulser: @local::pdsp_channel_status_nov2019
pdsp_channel_status_nov2019_goodpulser.BadChannels: [
  @sequence::pdsp_channel_status_nov2019_goodpulser.BadChannels,
  4232, 4234, 4236, 4238, 4240, 4242,   # femb519x (apa5z, feb2018 values in fix01)
  4472, 4474, 4476, 4478, 4480, 4482,   # femb514x (apa5z, feb2018 values in fix01)
  9545, 9547, 9549, 9551, 9553, 9555,   # femb615x (apa5z, feb2018 values in fxi01)
  4473,                                 # femb514x
  9260,                                 # femb601v (feb2018 values in fix01)
  9641                                  # femb613x
]

END_PROLOG

BEGIN_PROLOG

pdsp_channel_status: @local::pdsp_channel_status_2018
#pdsp_channel_status: @local::pdsp_channel_status_nov2019

END_PROLOG
# pedestals_dune.fcl
#
# David Adams
# March 2016
#
# File now holds the full service configuration instead of only the provider.

BEGIN_PROLOG

dune_dbpeds: {
}

dune_fixedpeds: {
  service_provider: FixedDetPedestalService
  FixedDetPedestal: {
    PedMeanU: 1800.0
    PedMeanV: 1800.0
    PedMeanZ:  500.0
    PedRmsU:     2.5
    PedRmsV:     2.5
    PedRmsZ:     2.5
    PedMeanErrU: 0.1
    PedMeanErrV: 0.1
    PedMeanErrZ: 0.1
    PedRmsErrU:  0.1
    PedRmsErrV:  0.1
    PedRmsErrZ:  0.1
  }
}

dunedp_fixedpeds: {
  service_provider: DPhaseFixedDetPedestalService
  FixedDetPedestal: {
    PedMeanX: 10.0
    PedMeanY: 10.0
    PedMeanZ: 10.0
    PedRmsX:     1.0
    PedRmsY:     1.0
    PedRmsZ:     1.0
    PedMeanErrX: 0.1
    PedMeanErrY: 0.1
    PedMeanErrZ: 0.1
    PedRmsErrX:  0.1
    PedRmsErrY:  0.1
    PedRmsErrZ:  0.1
  }
}

END_PROLOG
# dunetpc/dune/Daq/daq_dune.fcl
#
# David Adams
# February 2016

BEGIN_PROLOG

#***********************************************************************

# 35-ton online/offline channel mapping.

chmap35t: {
  service_provider: FileChannelMappingService
  FileName:         "rce_channel_map_dune35t.txt"
  FilePathEnv:      FW_SEARCH_PATH
  LogLevel:         1
}

#***********************************************************************

END_PROLOG
# detsimmodules_dune.fcl
#
#
# David Adams
# April 2016
#
# This FCL prolog file holds a minimal default configuration for the
# DetSim module and configuration options for the services used by that
# module.
#
# See dunetpc/fcl/dune35t/detsim/standard_detsim_dune35t for top-level
# FCL that uses this configuration.

BEGIN_PROLOG

standard_simwire:
{
  module_type:        "SimWire"
  DriftEModuleLabel:  "largeant"
  NoiseFact:           0.0132      # Noise Scale
  NoiseWidth:         62.4         # Exponential Noise width (kHz)
  LowCutoff:           7.5         # Low frequency filter cutoff (kHz)
  FieldBins:          75
  Col3DCorrection:    2.5
  Ind3DCorrection:    1.5
  ColFieldRespAmp:    0.0354
  IndFieldRespAmp:    0.018
  ShapeTimeConst:     [ 3000., 900. ]
  CompressionType:    "none"
}


standard_simwireana:
{ 
 module_type:       "SimWireAna"
 DetSimModuleLabel: "daq"
}
# extra comment to test check-in

microboone_simwire:  
{ 
 module_type:        "SimWireMicroBooNE"
 DriftEModuleLabel:  "largeant"
 NoiseFact:          0.0132       #Noise Scale
 #NoiseFact:          0.15       #Noise Scale to use with histogram
 NoiseWidth:         62.4         #Exponential Noise width (kHz)
 LowCutoff:          7.5          #Low frequency filter cutoff (kHz)
 CompressionType:    "none"       #could also be none
 GetNoiseFromHisto:   false  
 NoiseFileFname:      "uboone_noise_v0.1.root"
 NoiseHistoName:      "NoiseFreq"    

}
microboone_simwireana: @local::standard_simwireana

standard_wienerfilterana: 
{
 module_type:        "WienerFilterAna"
 DetSimModuleLabel:  "daq"
}

bo_wienerfilterana:         @local::standard_wienerfilterana
argoneut_wienerfilterana:   @local::standard_wienerfilterana
microboone_wienerfilterana: @local::standard_wienerfilterana



END_PROLOG

BEGIN_PROLOG

#***********************************************************************

# DetSim module

dune_detsim: {
  module_type:       "SimWireDUNE"
  SimChannelLabel:   "largeant"
  NoiseOn:           false
  PedestalOn:        false
  DistortOn:         false
  SuppressOn:        false
  KeepEmptyChannels: false
  AdcSimulator:      "adcsim_ideal"
}

#***********************************************************************

# SimChannelExtractService converts GEANT output to TPC signals.

# Simple single-phase extractor.
scxgeneric: {
  service_provider: GenericSimChannelExtractService
}

# Signal extractor service for dune dual-phase detector
scxdp: {
  service_provider: DPhaseSimChannelExtractService
}

# Single-phase extractor with special handling of signal near and beyond
# TPC active boundaries.
scx35t: {
  service_provider: Dune35tSimChannelExtractService
  FractHorizGapUCollect: [ 0.1, 0.0 ]
  FractHorizGapUMiss: [ 0.8, 0.0 ]
  FractHorizGapVCollect: [ 0.1, 0.0 ]
  FractHorizGapVMiss: [ 0.8, 0.0 ]
  FractHorizGapZMiss: [ 0.8, 0.0 ]
  FractUUCollect: [ 0.5, 0.0 ]
  FractUUMiss: [ 0.2, 0.0 ]
  FractUVCollect: [ 0.1, 0.0 ]
  FractUVMiss: [ 0.2, 0.0 ]
  FractVUCollect: [ 0.5, 0.0 ]
  FractVUMiss: [ 0.2, 0.0 ]
  FractVVCollect: [ 0.1, 0.0 ]
  FractVVMiss: [ 0.2, 0.0 ]
  FractVertGapUCollect: [ 0.1, 0.0 ]
  FractVertGapUMiss: [ 0.8, 0.0 ]
  FractVertGapVCollect: [ 0.1, 0.0 ]
  FractVertGapVMiss: [ 0.8, 0.0 ]
  FractVertGapZMiss: [ 0.8, 0.0 ]
  FractZUMiss: [ 0.2, 0.0 ]
  FractZVMiss: [ 0.2, 0.0 ]
}

#***********************************************************************

# ChannelNoiseService adds noise to channel-tick bins.

# Option 1 from the old DetSim module.
chnoiseold: {
  service_provider: ExponentialChannelNoiseService
  NoiseNormU: 3.16
  NoiseNormV: 3.16
  NoiseNormZ: 3.16
  NoiseWidthU: 2000
  NoiseWidthV: 2000
  NoiseWidthZ: 2000
  LowCutoffU: 7.5
  LowCutoffV: 7.5
  LowCutoffZ: 7.5
  WhiteNoiseU: 0.0
  WhiteNoiseV: 0.0
  WhiteNoiseZ: 0.0
  NoiseArrayPoints: 1000
  OldNoiseIndex: true
}

# Option 2 from the old DetSim module.
chnoisewhite: {
  service_provider: WhiteChannelNoiseService
}

# Tune from October 2016.
# See D. Adams talk at the 26oct 35t sim/reco meeting.
# Option 1 from the old DetSim module.
chnoise35t: {
  service_provider: ExponentialChannelNoiseService
  NoiseNormU:   30.0
  NoiseNormV:   30.0
  NoiseNormZ:   15.0
  NoiseWidthU: 150.0
  NoiseWidthV: 150.0
  NoiseWidthZ: 150.0
  LowCutoffU:    0.0
  LowCutoffV:    0.0
  LowCutoffZ:    0.0
  WhiteNoiseU:   1.6
  WhiteNoiseV:   1.6
  WhiteNoiseZ:   1.6
  NoiseArrayPoints: 1000
  OldNoiseIndex: false
}

# Tune from August 2018. Based on protoDUNE run 3775.
# Requires dunetpc v07_05_00 or later.
# See https://cdcvs.fnal.gov/redmine/issues/20621.
pdsp_chnoiseAug2018: {
  service_provider: ExponentialChannelNoiseService
  NoiseNormU:   25
  NoiseNormV:   25
  NoiseNormZ:   20
  LowCutoffU: -180
  LowCutoffV: -180
  LowCutoffZ: -180
  WhiteNoiseU:  0.8
  WhiteNoiseV:  0.8
  WhiteNoiseZ:  0.8
  NoiseWidthU: 150.0
  NoiseWidthV: 150.0
  NoiseWidthZ: 150.0
  NoiseArrayPoints: 1000
  OldNoiseIndex: false
}

#Configure realistic noise service for DP detectors based on the 311 data
#A.Scarpelli andrea.scarpelli@cern.ch November 2017
#NB: Hardcoded unrotated geometry:

dprealisticnoise:{
  service_provider: DPhaseRealisticNoiseService
  NoiseModel:       "$MRB_SOURCE/dunetpc/dune/DetSim/NoiseModels/729-0_fft_mirror.root"
  RandomizeX:       15.0     #amplitude randomization sigma
  RandomizeY:       15.0     #amplitude randomization sigma
  Smooth:           1000      #smoothing factor when mirroring
  SetFirst0:        false    #set first bin of the fft model to 0
  SetBaseline:      false    #if true, baseline added to real noise model
  NoiseArrayPoints: 1000     #number of pre-generated waveforms
  OldNoiseIndex:    false    #From ExponentialChannelNoiseService. Keep false
}

dpcoherentnoise:{
  service_provider: DPhaseCoherentNoiseService
  NoiseModel:       "$MRB_SOURCE/dunetpc/dune/DetSim/NoiseModels/729-0-model-fft.root"
  AmplitudeCut:     50                       #select frequencies above this threshold
  Normalization:    1                        #amplitude normalizations
  Randomize:        [ 1, 1 ]                 #rms amplitude ( different for every channel and frequency )
  PhaseShift:       [ -1, 1 ]                #phase shift per group of channels in radiants
  ChannelGroup:     [ 0, 320, 1280 ]         #list here the first channel of every significant correlation pattern
  InchoerentNoise:  [ 0.7, 1.1, 0.7, 1.1 ]   #rms and sigma of a small incohrent noise ( or very high frequency )
  NumberOfPhases:   1000                     #number of random phases array to produce
  LogLevel:         0                        #Verbosity level
}

chnoiseprotodune: {
  service_provider: ProtoDUNEChannelNoiseService
  LowCutoffU:    0.0
  LowCutoffV:    0.0
  LowCutoffZ:    0.0
  WhiteNoiseU:   0.0
  WhiteNoiseV:   0.0
  WhiteNoiseZ:   0.0
  NoiseArrayPoints: 1000
  OldNoiseIndex: false
  WireLengthZ:    598.39
  WireLengthU:    740.06
  WireLengthV:    737.36
  EffectiveNBits: 10.6
}

#***********************************************************************


# PedestalAdditionService adds pedestals to signals.

# Takes pedestal mean and RMS and from the DetPedestalService provider.
# Incoherent noise is added with Gaussian sigma = NoiseScale*RMS.
padprovided: {
  service_provider: ProvidedPedestalAdditionService
  NoiseScale: 0.0
}

#***********************************************************************

# AdcDistortService adds distortions to the digitized signals.

# Add 35-ton stuck bits.
stuckbits: {
  service_provider: StuckBitAdcDistortionService
  StuckBitsOverflowProbHistoName: "pCorrFracOverflowVsInputLsbCell"
  StuckBitsProbabilitiesFname: "ADCStuckCodeProbabilities35t/output_produceDcScanSummaryPlots_20150827_coldTest_0p1to1p4_step0p0010.root"
  StuckBitsUnderflowProbHistoName: "pCorrFracUnderflowVsInputLsbCell"
}

#***********************************************************************

# AdcSuppressService indicates which channel-tick bins should be
# ignored (i.e. zero-suppressed).

# No suppression.
zsnone: {
  service_provider: FixedZeroSuppressService
}

# Simple window supression. Same as the old module.
zslegacy: {
  service_provider: Legacy35tZeroSuppressService
  AdcThreshold: 10.0
  TickRange: 10
  MinTickGap: 2
  SuppressStickyBits: false
}

# Algorithm developed for use with the 35-ton detector with original
# (low) thresholds.
zsonline: {
  service_provider: Dune35tZeroSuppressService
  NS:  5
  NL: 15
  ND:  5
  NT:  3
  TS:  3
  TL:  7
  TD:  5
}

# Algorithm developed for use with the 35-ton detector with high
# thresholds.
zsonline_nhi: {
  service_provider: Dune35tZeroSuppressService
  NS:  5
  NL: 15
  ND:  5
  NT:  3
  TS:  6
  TL: 10
  TD: 10
}

#***********************************************************************

# AdcCompressService applies supression and converts digititzed signals
# to the final raw data format.

# Replaces suppressed bins with value Zero.
# Use this to effectively skip compression.
cmpreplace: {
  service_provider: ReplaceCompressService
  Zero: 0
}

# Larsoft block formatting. This removes the suppressed bins.
cmpblock: {
  service_provider: "LarsoftHuffmanCompressService"
  UseBlock:         "true"
  UseHuffman:       "false"
}

# Larsoft block formatting with Larsoft Huffman compression.
cmphuffman: {
  service_provider: "LarsoftHuffmanCompressService"
  UseBlock:         "true"
  UseHuffman:       "true"
}

#***********************************************************************
# Below are configurations for the old (and soon to be obsolete) DetSim
# modules. These can be removed when the old modules
# SimWireDUNE35t_module.cc and SimWireDUNE10kt_module.cc are dropped.
#***********************************************************************

dunefd_simwire:
{
 module_type:        "SimWireDUNE10kt"
 DriftEModuleLabel:  "largeant"
 NoiseFactU:          0.0349     # Noise Scale for U plane. Reset by DLA 26apr16.
 NoiseWidthU:         2000         #Exponential Noise width (kHz) for U plane
 LowCutoffU:          7.5          #Low frequency filter cutoff (kHz) for U plane
 NoiseFactV:          0.0349     #Noise Scale for V plane, should produce RMS of 2.5 ADC counts. Reset by DLA 26apr16.
 NoiseWidthV:         2000         #Exponential Noise width (kHz) for V plane, should produce RMS of 2.5 ADC counts
 LowCutoffV:          7.5          #Low frequency filter cutoff (kHz) for V plane
 NoiseFactZ:          0.0349     #Noise Scale for Z plane, should produce RMS of 2.5 ADC counts. Reset by DLA 26apr16.
 NoiseWidthZ:         2000         #Exponential Noise width (kHz) for Z plane
 LowCutoffZ:          7.5          #Low frequency filter cutoff (kHz) for Z plane
 CompressionType:    "ZeroSuppression"       #could also be none
 #CompressionType:    ""       #could also be none
 ZeroThreshold:       10        #Threshold for zero suppression
 NearestNeighbor:     10        #Maximum distance between hits above threshold before they are separated into different blocks
 NeighboringChannels: 0        #Number of neighboring channels on either side allowed to influence zero suppression
 NoiseArrayPoints:    1000     #number of points in noise array
 NoiseOn:             1        #1 for noise on, 0 for noise off
 NoiseModel:          1        #1 for original model, 2 for a model similar to uBooNE

 CollectionPed:       400         #ADC baseline for coll plane
 CollectionPedRMS:    0        #ADC baseline RMS for coll plane
 InductionPed:        2048        #ADC baseline for ind plane
 InductionPedRMS:     0        #ADC baseline RMS for ind plane

 CollectionCalibPed:     400      #Assumed measured value for coll plane pedestal
 CollectionCalibPedRMS:  0        #Assumed measured value for coll plane pedestal RMS
 InductionCalibPed:      2048     #Assumed measured value for ind plane pedestal
 InductionCalibPedRMS:   0        #Assumed measured value for ind plane pedestal RMS

 PedestalOn:          true     #add pedestal value to ADC vector

 SimCombs:           false
 SaveEmptyChannel:   false      #if channel's ADC vector is entirely full of zeros, save it in RawDigit collection (true) or discard (false)
 SimStuckBits:       false        #simulate stuck bits

 StuckBitsProbabilitiesFname:     "ADCStuckCodeProbabilities35t/output_produceDcScanSummaryPlots_20150827_coldTest_0p1to1p4_step0p0010.root"
 StuckBitsOverflowProbHistoName:     "pCorrFracOverflowVsInputLsbCell"
 StuckBitsUnderflowProbHistoName:     "pCorrFracUnderflowVsInputLsbCell"

# random initial guesses for charge inefficiency and wrong-type collection on the induction-plane wires
# the second number is for the gap with the deflector

 FractUUCollect:        [ 0.5, 0 ]        # fraction of charge that collects on U (non-transparency) when charge drifts over the comb holding U wires
 FractUVCollect:        [ 0.1, 0 ]        # fraction of charge that collects on U (non-transparency) when charge drifts over the comb holding V wires
 FractVUCollect:        [ 0.5, 0 ]        # fraction of charge that collects on V (non-transparency) when charge drifts over the comb holding U wires
 FractVVCollect:        [ 0.1, 0 ]        # fraction of charge that collects on V (non-transparency) when charge drifts over the comb holding V wires
 FractUUMiss:           [ 0.2, 0 ]        # fraction of charge that gets missed on U when charge drifts over the comb holding U
 FractUVMiss:           [ 0.2, 0 ]        # fraction of charge that gets missed on U when charge drifts over the comb holding V
 FractVUMiss:           [ 0.2, 0 ]        # fraction of charge that gets missed on V when charge drifts over the comb holding U
 FractVVMiss:           [ 0.2, 0 ]        # fraction of charge that gets missed on V when charge drifts over the comb holding V
 FractZUMiss:           [ 0.2, 0 ]        # fraction of charge that gets missed on Z (collection) when charge drifts over the comb holding U
 FractZVMiss:           [ 0.2, 0 ]        # fraction of charge that gets missed on Z (collection) when charge drifts over the comb holding V
 FractHorizGapUMiss:    [ 0.8, 0 ]        # fraction of charge in the horizontal gap that is missing on U
 FractVertGapUMiss:     [ 0.8, 0 ]        # fraction of charge in the horizontal gaps that is missing on U
 FractHorizGapVMiss:    [ 0.8, 0 ]        # fraction of charge in the horizontal gap that is missing on V
 FractVertGapVMiss:     [ 0.8, 0 ]        # fraction of charge in the horizontal gaps that is missing on V
 FractHorizGapZMiss:    [ 0.8, 0 ]        # fraction of charge in the horizontal gap that is missing on Z
 FractVertGapZMiss:     [ 0.8, 0 ]        # fraction of charge in the horizontal gaps that is missing on Z
 FractHorizGapUCollect: [ 0.1, 0 ]        # fraction of charge in the horizontal gap that collects on U
 FractHorizGapVCollect: [ 0.1, 0 ]        # fraction of charge in the horizontal gap that collects on V
 FractVertGapUCollect:  [ 0.1, 0 ]        # fraction of charge in the vertical gap that collects on U
 FractVertGapVCollect:  [ 0.1, 0 ]        # fraction of charge in the vertical gap that collects on V
}

dunefd_simwireana:            @local::standard_simwireana
dunefd_wienerfilterana:       @local::standard_wienerfilterana


# For now treat the other dune geometries like FD

dune35t_simwire:		@local::dunefd_simwire
dune35t_simwire.PedestalOn:     true        #add pedestal value to ADC vector
dune35t_simwire.CollectionPed:  500         #ADC baseline for coll plane
dune35t_simwire.CollectionPedRMS:    0.0    #ADC baseline RMS for coll plane
dune35t_simwire.InductionPed:   1800        #ADC baseline for ind plane
dune35t_simwire.InductionPedRMS:    0.0    #ADC baseline RMS for ind plane
dune35t_simwire.CollectionCalibPed:  500         #Assumed measured value for coll plane pedestal
dune35t_simwire.CollectionCalibPedRMS:  0.0     #Assumed measured value for coll plane pedestal RMS
dune35t_simwire.InductionCalibPed:   1800        #Assumed measured value for ind plane pedestal
dune35t_simwire.InductionCalibPedRMS:   0.0        #Assumed measured value for ind plane pedestal RMS
#dune35t_simwire.CompressionType:    "none"      #no data compression for noise test

dune35t_simwire.ZeroThreshold:  5
dune35t_simwire.NoiseModel:     1
dune35t_simwire.NoiseWidthU:  2000  # If turn NoiseModel to 1 use these numbers..
dune35t_simwire.NoiseWidthV:  2000  # If turn NoiseModel to 1 use these numbers..
dune35t_simwire.NoiseWidthZ:  2000  # If turn NoiseModel to 1 use these numbers..
dune35t_simwire.NoiseFactU:   0.05  # Should produce RMS of 2.5 ADC counts
dune35t_simwire.NoiseFactV:   0.05  # Should produce RMS of 2.5 ADC counts
dune35t_simwire.NoiseFactZ:   0.05  # Should produce RMS of 2.5 ADC counts
#dune35t_simwire.NoiseFactU:   0.1  # Should produce RMS of 5 ADC counts
#dune35t_simwire.NoiseFactV:   0.1  # Should produce RMS of 5 ADC counts
#dune35t_simwire.NoiseFactZ:   0.1  # Should produce RMS of 5 ADC counts
dune35t_simwire.LowCutoffU:    7.5  # If turn NoiseModel to 1 use these numbers..
dune35t_simwire.LowCutoffV:    7.5  # If turn NoiseModel to 1 use these numbers..
dune35t_simwire.LowCutoffZ:    7.5  # If turn NoiseModel to 1 use these numbers..
dune35t_simwire.SimStuckBits:    false   # Simulate stuck bits
dune35t_simwireana:             @local::dunefd_simwireana
dune35t_wienerfilterana:        @local::dunefd_wienerfilterana
dune35t_simwire.module_type:    "SimWireDUNE35t"

dune35t_simcounter:
{
    module_type:           "SimCounter35t"
    LArGeantModuleLabel:   "largeant"
    MakeTree:              false
    BSUTriggerThreshold:   0.5 # MeV
    TSUTriggerThreshold:   0.25 # MeV
    TriggerEfficiency:     1.0
# below changed on Feb. 1 2016 to match data . .
#    ClockSpeedCounter:     31.25 # MHz
    ClockSpeedCounter:     64.0 # MHz
    CombinedTimeDelay:     160 # ns. cable length delay + various electronics delays
}

END_PROLOG
BEGIN_PROLOG

standard_spacecharge:
{
  EnableSimSpatialSCE:       false
  EnableSimEfieldSCE:        false
  EnableCalSpatialSCE:       false
  EnableCalEfieldSCE:        false
  EnableCorrSCE:			 false
  RepresentationType:       "Parametric"
  InputFilename:            "SCEoffsets.root"
  CalibrationInputFilename: "SCEoffsets.root"
  service_provider:          SpaceChargeServiceStandard
}

bo_spacecharge:         @local::standard_spacecharge
jp250L_spacecharge:     @local::standard_spacecharge
argoneut_spacecharge:   @local::standard_spacecharge
microboone_spacecharge: @local::standard_spacecharge
dune35t_spacecharge:    @local::standard_spacecharge
dunefd_spacecharge:     @local::standard_spacecharge

END_PROLOG

BEGIN_PROLOG

dunefd_spacecharge:   @local::standard_spacecharge

dunefddphase_spacecharge:   @local::standard_spacecharge

protodune_spacecharge:   				@local::standard_spacecharge
protodune_spacecharge.InputFilename:  			"SpaceChargeProtoDUNE/SCE_DataDriven_180kV_v4.root"
protodune_spacecharge.CalibrationInputFilename:	        "SpaceChargeProtoDUNE/SCE_DataDriven_180kV_v4.root"
protodune_spacecharge.RepresentationType:               "Splines_TH3"
protodune_spacecharge.service_provider:  		SpaceChargeServiceProtoDUNE

protodunedp_spacecharge:                                                  @local::standard_spacecharge
protodunedp_spacecharge.InputFilename:                    "666_short_50kV.root"
protodunedp_spacecharge.RepresentationType:       "Voxelized_TH3"
protodunedp_spacecharge.service_provider:                 SpaceChargeServiceProtoDUNEdp


dune35t_spacecharge:   @local::standard_spacecharge
dune35t_spacecharge.InputFilename:  "SpaceCharge35t/SCEoffsets_DUNE35t_E500.root"
dune35t_spacecharge.service_provider:  SpaceChargeServiceDUNE35t

dphase3x1x1_spacecharge:   @local::standard_spacecharge
dphase3x1x1_spacecharge.InputFilename:  "SpaceCharge35t/SCEOffsets_311_Fieldcage_E500.root"
dphase3x1x1_spacecharge.service_provider:  SpaceChargeService3x1x1dphase

END_PROLOG
# dataprep_dune.fcl
#
# David Adams
# August 2016
#
# This holds all the prolog for dataprep.

BEGIN_PROLOG

#***********************************************************************

# AdcChannelDataCopyService copies AdcChannelData.

adccopy: {
  service_provider: ConfigurableAdcChannelDataCopyService
  LogLevel:           1
  CopyChannel:     true
  CopyPedestal:    true
  CopyRaw:        false
  CopySamples:     true
  CopyFlags:      false
  CopyRois:       false
  CopyDigit:       true
  CopyWire:       false
  CopyDigitIndex:  true
  CopyWireIndex:  false
}

#***********************************************************************

# RawDigitExtractService pulls ADC signals (raw:RawDigit) out of the lar
# container, converts to float, flags bad channels and subtracts pedestals.

rdx_std: {
  service_provider: StandardRawDigitExtractService
  LogLevel: 1
  DigitReadTool: digitReader
  PedestalOption: 1
  FlagStuckOff: false
  FlagStuckOn: false
}

rdx_35tdata: {
  service_provider: StandardRawDigitExtractService
  LogLevel: 1
  DigitReadTool: digitReader
  PedestalOption: 1
  FlagStuckOff: true
  FlagStuckOn: true
}

#***********************************************************************

# AdcMitigationService is used to mitigate ADC signals, e.g.
# interpolate between good values to deal with stuck bits.

adcmit_dune35t: {
  service_provider: InterpolatingAdcMitigationService
  LogLevel: 1
  SkipUnderflows:      true
  SkipOverflows:       true
  MaxConsecutiveSamples:  5
  MaxConsecutiveFlag:     0
}

#***********************************************************************

# AdcSuppressService is used by AdcSuppressSignalFindingService (below).

adcsuppress_legacy35t: {
  service_provider: Legacy35tZeroSuppressService
  AdcThreshold: 30.0
  TickRange: 4
  MinTickGap: 2
  SuppressStickyBits: false
}

#***********************************************************************

# AdcSuppressSignalFindingService is used to remove noise from ADC signals.

# This implementation uses AdcSuppressService.
adcsigfind_suppress: {
  service_provider: AdcSuppressSignalFindingService
}

#***********************************************************************

# AdcNoiseRemovalService is used to remove noise from ADC signals.

adcnr_dune35tlegacy: {
}

adcnr_dunedphase3x1x1: {
  service_provider: DuneDPhase3x1x1NoiseRemovalService
  CorrMode:                         "median" # mean or median
  DoTwoPassFilter:                      false
  BinsToSkip: 				2
  Coherent32:                           true
  Coherent32Groups:                       [] # do all groups if empty list
  Coherent16:                           true
  Coherent16Groups:   [6, 7, 16, 17, 18, 19] # do all groups if empty list
  UseBasicROIForCNR:			 true
  RoiStartThreshold:                       7
  RoiEndThreshold:                         6
  RoiPadLow:                               8
  RoiPadHigh:                             40
  Flatten:                              true
  FlattenExtrapolate:			false
  LowPassFlt:                           false
  LowPassFltSecondPass:                 false
  LowPassFltFCut:                       0.5
  LowPassFltExpo:                       8
}

#***********************************************************************

# PedestalEvaluationService is used to evaluate pedestals from the
# ADC signals.

adcped_median: {
  service_provider: MedianPedestalService
  LogLevel:              1
  UseMean:            false
  SkipFlaggedSamples: true
  SkipSignals:        true
}

adcped_mean: {
  service_provider: MedianPedestalService
  LogLevel:              1
  UseMean:            true
  SkipFlaggedSamples: true
  SkipSignals:        true
}

#***********************************************************************

# AdcDeconvolutionService is used to deconvolute the ADC signals.

adcdco_dune35t: {
  service_provider: DuneDeconvolutionService
  LogLevel:              1
}

adcdco_dunefd: @local::adcdco_dune35t

adcdco_dunefddphase: {
  service_provider: DuneDPhaseDeconvolutionService
  LogLevel:              1
}

#***********************************************************************

# AdcRoiBuildingService is used to define ROIs for the ADC signals.

adcroi_dune35t: {
  service_provider: DuneRoiBuildingService
  NSigmaStart:        3.0
  NSigmaEnd:          1.0
  PadLow:              50
  PadHigh:             50
  LogLevel:             1
}

adcroi_dunefd: @local::adcroi_dune35t

adcroi_dunefddphase: {
  service_provider: DuneDPhaseRoiBuildingService
  UseFilter:                 false
  FltCoeffs:     [0.1, 0.75, 0.95]
  NSigmaStart:                 3.0
  NSigmaEnd:                   1.0
  PadLow:                       50
  PadHigh:                      50
  LogLevel:                      1
}

adcroi_keepall: {
  service_provider: KeepAllRoiBuildingService
  LogLevel:              1
}

#***********************************************************************

# AdcWireBuildingService constructs lar outputs (recob::Wire) from ADC
# signals.

adcwire_std: {
  service_provider: StandardAdcWireBuildingService
  LogLevel:              1
}

#***********************************************************************

# RawDigitPrepService is the high level service that uses the above
# services to prepare ADC signals including the conversion of
# raw::RawDigit to recob::Wire.

# Read raw data and subtract pedestals without any other preparation.
adcprep_readraw: {
  service_provider: StandardRawDigitPrepService
  LogLevel: 1
  SkipBad:               false
  SkipNoisy:             false
  DoMitigation:          false
  DoEarlySignalFinding:  false
  DoNoiseRemoval:        false
  DoPedestalAdjustment:  false
  DoDeconvolution:       false
  DoROI:                 false
  DoWires:               false
  DoIntermediateStates:  false
  DisplayTools:             []
}

# Process simulation using service-based dataprep.
adcprep_with_services_sim: {
  service_provider: StandardRawDigitPrepService
  LogLevel: 1
  SkipBad:                true
  SkipNoisy:             false
  DoMitigation:          false
  DoEarlySignalFinding:  false
  DoNoiseRemoval:        false
  DoPedestalAdjustment:  false
  DoDeconvolution:        true
  DoROI:                  true
  DoWires:                true
  DoIntermediateStates:  false
  DisplayTools:             []
}

# Process simulation using tool-based dataprep.
adcprep_with_tools_sim: {
  service_provider: ToolBasedRawDigitPrepService
  LogLevel: 3
  DoWires: true
  AdcChannelToolNames: [
    "digitReader",
    "adcSampleFiller",
    "adcVintageDeconvoluter",
    "adcThresholdSignalFinder"
  ]
  CallgrindToolNames: []
}

# Process data using tool-based dataprep.
adcprep_with_tools_data: {
  service_provider: ToolBasedRawDigitPrepService
  LogLevel: 3
  DoWires: true
  AdcChannelToolNames: [
    "digitReader",
    "adcSampleFiller",
    "adcVintageDeconvoluter",
    "adcThresholdSignalFinder"
  ]
  CallgrindToolNames: []
}

# Process DP 3x1x1 data.
adcprep_dunedphase3x1x1: {
  service_provider: StandardRawDigitPrepService
  LogLevel: 1
  SkipBad:               false
  SkipNoisy:              true
  DoMitigation:          false
  DoEarlySignalFinding:  false
  DoNoiseRemoval:         true
  DoPedestalAdjustment:  false
  DoDeconvolution:        true
  DoROI:                  true
  DoWires:                true
  DoIntermediateStates:  false
  DisplayTools:             []
}

# Process 35-ton data
adcprep_dune35tdata: {
  service_provider: StandardRawDigitPrepService
  LogLevel: 1
  SkipBad:                true
  SkipNoisy:             false
  DoMitigation:           true
  DoEarlySignalFinding:   true
  DoNoiseRemoval:         true
  DoPedestalAdjustment:  false
  DoDeconvolution:        true
  DoROI:                  true
  DoWires:                true
  DoIntermediateStates:  false
  DisplayTools:             []
}

#***********************************************************************

# Channel groups.

# Process by APA keeping all ROPs.
changroup_apa_keepall: {
  service_provider: GeoApaChannelGroupService
  LogLevel: 1
  ApaRops: []
}

# Process by APA dropping the protoDUNE cryostat-side collection plane.
changroup_apa_pd_drop_outer: {
  service_provider: GeoApaChannelGroupService
  LogLevel: 1
  ApaRops: [11, 7]
}

# Process by APA keeping only the protoDUNE TPC-side collection plane.
changroup_apa_pd_tpccoll: {
  service_provider: GeoApaChannelGroupService
  LogLevel: 1
  ApaRops: [ 8, 4]
}

changroup_rop: {
  service_provider: GeoRopChannelGroupService
}

#***********************************************************************

# DataPrepModule is the producer that calls RawDigitPrepService

# This configuration does not make use of the decoding tool.
# Input is raw::RawDigit vector DigitLabel in the event data store.
# Use with MC. Can be used with data if the decoder module is called first.
producer_adcprep_notool: {
  module_type:   "DataPrepModule"
  LogLevel:                     1
  DecoderTool:                 ""       # Non-blank reads digits with named tool.
  DigitLabel:               "daq"       # Label for input digits if decoder tool is not used
  TimeStampName:               ""       # Non-blank writes RDTimeStamps if decoder tool is used
  OutputDigitName:             ""       # Non-blank writes digits if decoder tool is used
  WireName:                    ""
  DoAssns:                   true
  DoGroups:                  true
  ChannelRanges:               []
  BeamEventLabel:              ""
  IntermediateStates:          []
  OnlineChannelMapTool:  pd_onlineChannelMapByFemb
}

# This configuration uses the decoding tool and the old module.
# All APAs are decoded in one call to the tool.
# Obsolete. Use the byAPA module instead.
producer_adcprep_tool_old: {
  module_type: "DataPrepModule"
  LogLevel:                   1
  DecoderTool:   "pdsp_decoder"      # Non-blank reads digits with named tool.
  DigitLabel:                ""       # Label for input digits if decoder tool is not used
  TimeStampName:     "dataprep"       # Non-blank writes RDTimeStamps if decoder tool is used
  OutputDigitName:           ""       # Non-blank writes digits if decoder tool is used
  WireName:                  ""
  DoAssns:                 true
  DoGroups:                true
  ChannelRanges:             []
  BeamEventLabel:            ""
  IntermediateStates:        []
  OnlineChannelMapTool:  pd_onlineChannelMapByFemb
}

# This configuration uses the decoding tool and the new byAPA module.
# All APAs are decoded in one call to the tool if ChannelGroups = ["all"]
# Use ChannelGroups = ["apas"] to process one APA at a time.
producer_adcprep_byapa: {
  module_type: "DataPrepByApaModule"
  LogLevel:                     1
  DecoderTool:     "pdsp_decoder"       # Tool that reads digits.
  OutputTimeStampName: "dataprep"       # Non-blank writes digit RDTimeStamps
  OutputDigitName:             ""       # Non-blank writes digits
  OutputWireName:      "dataprep"       # Non-blank writes wires (processed digits)
  ChannelGroups:         ["apas"]
  BeamEventLabel:              ""
  KeepChannels:                []       # Channels to keep (all if empty).
  SkipChannels:                []       # Channels to skip.
  SkipEmptyChannels:         true       # If true, empty channels are not processed and do not produce wires
  DeltaTickCount:           0.005       # If true, empty channels are not processed and do not produce wires
  ApaChannelCounts:        [2560]       # # of channels in each APA. Last value used for later values.
  OnlineChannelMapTool: pd_onlineChannelMapByFemb
}

producer_adcprep: @local::producer_adcprep_notool

#***********************************************************************

END_PROLOG
# protodune_dataprep_services.fcl
#
# David Adams
# February 2010
#
# Dataprep service configurations.
#
# Dataprep is now mostly tool-based but one important service remains:
# ToolBasedRawDigitPrepService with interface RawDigitPrepService.
# It is called by each of the dataprep modules to run an ADC channel tool
# sequence to process the TPC data.
#
# Some standard sequences are defined here.
#
###################################################################################
# Dataprep tool sequences for protoDUNE SP data.
###################################################################################

BEGIN_PROLOG

# No calibration, no noise removal.
protodune_dataprep_tools_nocal_tail: [
  "digitReader",                # Read RawDigit
  "pdsp_sticky_codes_ped",      # Flag sticky codes
  "pd_adcPedestalFit",          # Find pedestal
  "adcSampleFiller",            # Subtract pedestal, trivial calibration
  "pdsp_adcMitigate",           # Mitigate sticky codes
  "pdsp_timingMitigate",        # Mitigate FEMB302 timing
  "adcCorrectUndershootAdc"     # correct undershoot
]

# Charge calibration; no mitigation or tail or noise removal.
protodune_dataprep_tools_calib_only: [
  "digitReader",                # Read RawDigit
  "pdsp_sticky_codes_ped",      # Flag sticky codes
  "pd_adcPedestalFit",          # Find pedestal
  "adcSampleCalibration",       # Subtract pedestal and apply charge calibration
  "pdsp_gainCorrection"         # Correct gain calibration
]

# Charge calibration and mitigation, no tail or noise removal.
protodune_dataprep_tools_calib_mit: [
  "digitReader",                # Read RawDigit
  "pdsp_sticky_codes_ped",      # Flag sticky codes
  "pd_adcPedestalFit",          # Find pedestal
  "adcSampleCalibration",       # Subtract pedestal and apply charge calibration
  "pdsp_gainCorrection",        # Correct gain calibration
  "pdsp_adcMitigate",           # Mitigate sticky codes
  "pdsp_timingMitigate"         # Mitigate FEMB302 timing
]

# Charge calibration, mitigation, obsolete tail removal, no noise removal.
protodune_dataprep_tools_calib_oldtail: [
  "digitReader",                # Read RawDigit
  "pdsp_sticky_codes_ped",      # Flag sticky codes
  "pd_adcPedestalFit",          # Find pedestal
  "adcSampleCalibration",       # Subtract pedestal and apply charge calibration
  "pdsp_gainCorrection",        # Correct gain calibration
  "pdsp_adcMitigate",           # Mitigate sticky codes
  "pdsp_timingMitigate",        # Mitigate FEMB302 timing
  "adcCorrectUndershootKe"      # correct undershoot
]

# Charge calibration, mitigation, tail removal, no noise removal.
protodune_dataprep_tools_calib_tail: [
  "digitReader",                # Read RawDigit
  "pdsp_sticky_codes_ped",      # Flag sticky codes
  "pd_adcPedestalFit",          # Find pedestal
  "adcSampleCalibration",       # Subtract pedestal and apply charge calibration
  "pdsp_gainCorrection",        # Correct gain calibration
  "pdsp_adcMitigate",           # Mitigate sticky codes
  "pdsp_timingMitigate",        # Mitigate FEMB302 timing
  "pdspTailPedRemovalZKe"       # Tail removal
]

# Charge calibration, noise removal.
protodune_dataprep_tools_calib_noiserem: [
  "digitReader",                # Read RawDigit
  "pdsp_sticky_codes_ped",      # Flag sticky codes
  "pd_adcPedestalFit",          # Find pedestal
  "adcSampleCalibration",       # Subtract pedestal and apply charge calibration
  "pdsp_gainCorrection",        # Correct gain calibration
  "pdsp_adcMitigate",           # Mitigate sticky codes
  "pdsp_timingMitigate",        # Mitigate FEMB302 timing
  "pdspTailPedRemovalZKe",      # Tail removal
  "pdsp_noiseRemovalKe"         # Remove high frequency noise and coherent noise
]

# Drop ROIs, scale back to ADC and zero bad/noisy channels for wirecell processing.
protodune_dataprep_tools_wirecell: [
  @sequence::protodune_dataprep_tools_calib_noiserem,
  "adcKeepAllSignalFinder",     # Keep all signal (no ROIs)
  "adcScaleKeToAdc",            # Scale samples to nominal ADC counts
  "pdsp_RemoveBadChannels"      # Set bad channels to 0 ADC
]

###################################################################################
# Dataprep tool sequences for protoDUNE SP simulation.
###################################################################################

pdsim_dataprep_tools_vintage: [
    "digitReader",              # Read RawDigit
    "adcSampleFiller",          # Subtract pedestal, trivial calibration
    "adcVintageDeconvoluter",   # Deconvolution
    "adcThresholdSignalFinder", # ROI
    "pdsp_RemoveBadChannels"    # Set bad channels to 0 ADC
]

# ProtoDUNE sim dataprep leaving samples at ADC scale. Passthru for wirecell.
pdsim_dataprep_tools_adc: [
  "digitReader"                 # Read RawDigit
]

# ProtoDUNE sim dataprep converted to ke scale.
pdsim_dataprep_tools_calib: [
  "digitReader",                # Read RawDigit
  "adcSampleFiller",            # Subtract pedestal, trivial calibration
  "adcScaleAdcToKe"             # Scale samples to nominal ADC counts
]

# ProtoDUNE sim dataprep at ke scale with tail removal.
pdsim_dataprep_tools_oldtail: [
  @sequence::pdsim_dataprep_tools_calib,
  "adcCorrectUndershootKe"      # correct undershoot with old tool
]

# ProtoDUNE sim dataprep at ke scale with tail removal.
pdsim_dataprep_tools_tail: [
  @sequence::pdsim_dataprep_tools_calib,
  "pdspTailPedRemovalZKe"       # correct tails
]

# Drop ROIs, scale back to ADC and zero bad/noisy channels for wirecell processing.
pdsim_dataprep_tools_wirecell: [
  @sequence::pdsim_dataprep_tools_tail,
  "adcKeepAllSignalFinder",     # Keep all signal (no ROIs)
  "adcScaleKeToAdc",            # Scale samples to nominal ADC counts
  "pdsp_RemoveBadChannels"      # Set bad channels to 0 ADC
]

# Specify here the default sequence used in reconstruction of MC data.
#protodune_dataprep_tools_sim: @local::pdsim_dataprep_tools_vintage
#protodune_dataprep_tools_sim: @local::pdsim_dataprep_tools_calib
protodune_dataprep_tools_sim: @local::pdsim_dataprep_tools_tail

###################################################################################
#
END_PROLOG

# PdspChannelMapService.fcl
#
# Temporary copy until dune_raw_data is released with this prolog.

BEGIN_PROLOG

# ProtoDUNE-SP online/offline channel mapping.

pdspchannelmap: {
  FileName:         "protoDUNETPCChannelMap_RCE_v4.txt"
  FELIXFileName:    "protoDUNETPCChannelMap_FELIX_v4.txt"
  SSPFileName:      "protoDUNESSPChannelMap_v1.txt"
  LogLevel:         1
}

END_PROLOG

BEGIN_PROLOG

# Iceberg online/offline channel mapping.
# SSP map left over from PDSP for now
# include a FELIX map in case someone uses FELIX for Iceberg

icebergchannelmap: {
  FileName:         "IcebergChannelMap_RCE_v1.txt"
  FELIXFileName:    "IcebergChannelMap_FELIX_v1.txt"
  SSPFileName:      "protoDUNESSPChannelMap_v1.txt"
  LogLevel:         1
}

END_PROLOG
BEGIN_PROLOG

protodune_xyzcalib :
{
  service_provider: "XYZCalibServiceProtoDUNE"

  UseCondbXYZCorr: true
  Interpolate: false

  XCorrFileName: ""
  YZCorrFileName: ""
  NormCorrFileName: ""

  XCorrDBTag: ""
  YZCorrDBTag: ""
  NormCorrDBTag: ""

}

END_PROLOG
BEGIN_PROLOG

protodune_lifetimecalib :
{
  service_provider: "LifetimeCalibServiceProtoDUNE"

  IsMC: false
  UseCondbLifetime: false
  Interpolate: true
  LifetimeFileName: ""
  LifetimeDBTag: ""

}

END_PROLOG
BEGIN_PROLOG

#
# Applies channel-by-channel PE calibrations
#
protodunesp_photoncalibrator:
{
   service_provider: PhotonCalibratorServiceProtoDUNESP
   BadChannels:      [25, 36, 49, 51, 58, 62, 65, 72, 73, 75, 82, 101, 110, 119, 156, 160  ]
}


END_PROLOG
BEGIN_PROLOG

dune_time_tracker: { 
  printSummary : true
  dbOutput     : {
    filename   :  "time.db"
    overwrite  :  true
  }
}

dune_memory_tracker: {
  includeMallocInfo : true
  dbOutput     : {
    filename   :  "mem.db"
    overwrite  :  true
  }
}

END_PROLOG
BEGIN_PROLOG

dunefddphase_crpgain: {
   service_provider: CrpGainService
   LogLevel:       1
   CrpDefaultGain: 6
   CrpNumLem:      36
   LemViewChans:   160
   LemEffTool:     ""
}

# protodune dp LEM efficiency map for CFR-35 design
protodunedphase_crpgain:            @local::dunefddphase_crpgain
protodunedphase_crpgain.LemEffTool: "lemEfficiency"

# simple CRP gain service configuration always returns one number
single_crpgain: @local::dunefddphase_crpgain
single_crpgain.CrpNumLem: 1
single_crpgain.LemEffTool: ""


END_PROLOG

BEGIN_PROLOG

# The above *_dune.fcl include contain the parameter blocks
# for all dune geometries. All PROLOG files for dune should
# contain all of the parameters for each dune geometry so
# that they are in one place and there is only one type of
# file to include. This file is an example of that



############################
### Dune FD Single Phase ###
############################

dunefd_services: {
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 Geometry:                       @local::dune10kt_geo
 GeometryConfigurationWriter: {}
 DetectorClocksService:          @local::dunefd_detectorclocks
 DetectorPropertiesService:      @local::dunefd_detproperties
 LArPropertiesService:           @local::dunefd_properties
 LArFFT:                         @local::dunefd_larfft
 DatabaseUtil:                   @local::dunefd_database
 BackTrackerService:                    @local::dunefd_backtrackerservice
 ParticleInventoryService:      @local::standard_particleinventoryservice
 PhotonBackTrackerService:              @local::dunefd_photonbacktrackerservice
 SpaceCharge:                    @local::dunefd_spacecharge
 NuRandomService:                @local::dune_seedservice
 SignalShapingServiceDUNE:       @local::dunefd_signalshapingservice
 ChannelStatusService:           @local::dunefd_channel_status
 ChannelGroupService:            @local::changroup_apa_keepall
}

dunefd_simulation_services: {
 LArFFT:                       @local::dunefd_larfft
 LArG4Parameters:              @local::dunefd_largeantparameters
 ExptGeoHelperInterface:       @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 Geometry:                     @local::dune10kt_geo
 DetectorClocksService:        @local::dunefd_detectorclocks
 DetectorPropertiesService:    @local::dunefd_detproperties
 LArPropertiesService:         @local::dunefd_properties
 DatabaseUtil:                 @local::dunefd_database
 LArVoxelCalculator:           @local::dunefd_larvoxelcalculator
 MagneticField:                @local::no_mag_larsoft
 BackTrackerService:                  @local::dunefd_backtrackerservice
 ParticleInventoryService:      @local::standard_particleinventoryservice
 PhotonBackTrackerService:            @local::dunefd_photonbacktrackerservice
 SpaceCharge:                  @local::dunefd_spacecharge
 NuRandomService:              @local::dune_seedservice
 SignalShapingServiceDUNE:     @local::dunefd_signalshapingservice
 OpDetResponseInterface:       @local::dunefd_opdetresponse
 ChannelStatusService:         @local::dunefd_channel_status
}

# Reco services for 35-ton simulation.
dunefd_reco_services:                            @local::dunefd_services
dunefd_reco_services.RawDigitExtractService:     @local::rdx_std
dunefd_reco_services.RawDigitPrepService:        @local::adcprep_with_services_sim
dunefd_reco_services.AdcDeconvolutionService:    @local::adcdco_dunefd
dunefd_reco_services.AdcRoiBuildingService:      @local::adcroi_dunefd
dunefd_reco_services.AdcWireBuildingService:     @local::adcwire_std

# Settings for optical simulation in the FD. Optical simulation not on by default
# for FD, turned on by custom physics list and defining a photon visibility
# services is workspace g4 fhicl file.

dunefd_simulation_services.LArPropertiesService.ScintYield: 24000
dunefd_simulation_services.LArPropertiesService.ScintPreScale: 0.05
dunefd_simulation_services.LArPropertiesService.EnableCerenkovLight: false





####################################
### DUNE far detector dual phase ###
####################################

dunefddphase_services: {
 DatabaseUtil:                   @local::dunefd_database
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 ChannelStatusService:           @local::dunefd_channel_status
 LArFFT:                         @local::dunefd_larfft
 NuRandomService:                @local::dune_seedservice
 Geometry:                       @local::dunedphase10kt_geo
 DetectorClocksService:          @local::dunefddphase_detectorclocks
 DetectorPropertiesService:      @local::dunefddphase_detproperties
 LArPropertiesService:           @local::dunefddphase_properties
 SignalShapingServiceDUNEDPhase: @local::dunefddphase_signalshapingservice
 SimChannelExtractService:       @local::scxdp
 CrpGainService:                 @local::dunefddphase_crpgain
 SpaceCharge:                    @local::dunefddphase_spacecharge
}

dunefddphase_simulation_services: {
 BackTrackerService:                    @local::dunefd_backtrackerservice
 ParticleInventoryService:      @local::standard_particleinventoryservice
 LArFFT:                         @local::dunefd_larfft
 LArG4Parameters:                @local::dunefd_largeantparameters
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 LArVoxelCalculator:             @local::dunefd_larvoxelcalculator
 MagneticField:                  @local::no_mag_larsoft
 NuRandomService:                @local::dune_seedservice
 DatabaseUtil:                   @local::dunefd_database
 OpDetResponseInterface:         @local::standard_opdetresponse
 PhotonBackTrackerService:       @local::standard_photonbacktrackerservice
 ChannelStatusService:           @local::dunefd_channel_status
 Geometry:                       @local::dunedphase10kt_geo
 DetectorClocksService:          @local::dunefddphase_detectorclocks
 DetectorPropertiesService:      @local::dunefddphase_detproperties
 LArPropertiesService:           @local::dunefddphase_properties
 SignalShapingServiceDUNEDPhase: @local::dunefddphase_signalshapingservice
 SimChannelExtractService:       @local::scxdp
 CrpGainService:                 @local::dunefddphase_crpgain
 SpaceCharge:                    @local::dunefddphase_spacecharge
 DetPedestalService:		 @local::dunedp_fixedpeds
}

dunefddphase_reco_services:                            @local::dunefddphase_services
dunefddphase_reco_services.BackTrackerService:                @local::dunefd_backtrackerservice
dunefddphase_reco_services.ParticleInventoryService:      @local::standard_particleinventoryservice
dunefddphase_reco_services.RawDigitExtractService:     @local::rdx_std
dunefddphase_reco_services.RawDigitPrepService:        @local::adcprep_with_services_sim
dunefddphase_reco_services.AdcDeconvolutionService:    @local::adcdco_dunefddphase
dunefddphase_reco_services.AdcRoiBuildingService:      @local::adcroi_dunefddphase
dunefddphase_reco_services.AdcWireBuildingService:     @local::adcwire_std
dunefddphase_reco_services.PedestalEvaluationService:  @local::adcped_median
dunefddphase_reco_services.AdcNoiseRemovalService:     @local::adcnr_dunedphase3x1x1

# Settings for optical simulation in the FD. Optical simulation not on by default
# for FD, turned on by custom physics list and defining a photon visibility
# services is workspace g4 fhicl file.

dunefddphase_simulation_services.LArPropertiesService.ScintYield: 24000
dunefddphase_simulation_services.LArPropertiesService.ScintPreScale: 1
dunefddphase_simulation_services.LArPropertiesService.EnableCerenkovLight: false
dunefddphase_simulation_services.OpDetResponseInterface.QuantumEfficiency: 0.12 # including TPB from arxiv 1807.07123



########################
### 3x1x1 dual phase ###
########################
dunedphase3x1x1_services: {
 DatabaseUtil:                   @local::dunefd_database
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 ChannelStatusService:           @local::dunedphase3x1x1_channel_status
 LArFFT:                         @local::dunefd_larfft
 NuRandomService:                @local::dune_seedservice
 Geometry:                       @local::dphase3x1x1_geo
 DetectorClocksService:          @local::dunedphase3x1x1_detectorclocks
 DetectorPropertiesService:      @local::dphase3x1x1_detproperties
 LArPropertiesService:           @local::dunefddphase_properties
 SignalShapingServiceDUNEDPhase: @local::dunedphase3x1x1_signalshapingservice
 SimChannelExtractService:       @local::scxdp
 CrpGainService:                 @local::single_crpgain
 SpaceCharge:                    @local::dunefddphase_spacecharge
}

dunedphase3x1x1_simulation_services: {
 BackTrackerService:                    @local::dunefd_backtrackerservice
 ParticleInventoryService:      @local::standard_particleinventoryservice
 LArFFT:                         @local::dunefd_larfft
 LArG4Parameters:                @local::protodune_largeantparameters
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 LArVoxelCalculator:             @local::dunefd_larvoxelcalculator
 MagneticField:                  @local::no_mag_larsoft
 NuRandomService:                @local::dune_seedservice
 DatabaseUtil:                   @local::dunefd_database
 OpDetResponseInterface:         @local::standard_opdetresponse
 PhotonBackTrackerService:       @local::standard_photonbacktrackerservice
 ChannelStatusService:           @local::dunedphase3x1x1_channel_status
 Geometry:                       @local::dphase3x1x1_geo
 DetectorClocksService:          @local::dunedphase3x1x1_detectorclocks
 DetectorPropertiesService:      @local::dphase3x1x1_detproperties
 LArPropertiesService:           @local::dunefddphase_properties
 SignalShapingServiceDUNEDPhase: @local::dunedphase3x1x1_signalshapingservice
 SimChannelExtractService:       @local::scxdp
 CrpGainService:                 @local::single_crpgain
 SpaceCharge:                    @local::dphase3x1x1_spacecharge
 PhotonVisibilityService: 	 @local::dunedphase3x1x1_photonvisibilityservice
 PhotonVisibilityServiceS2: 	 @local::dunedphase3x1x1_photonvisibilityserviceS2
 DetPedestalService:		 @local::dunedp_fixedpeds
 OpDigiProperties: 		 @local::dunedphase3x1x1_opdigiproperties
}

dunedphase3x1x1_reco_services:                            @local::dunedphase3x1x1_services
dunedphase3x1x1_reco_services.BackTrackerService:                @local::dunefd_backtrackerservice
dunedphase3x1x1_reco_services.ParticleInventoryService:      @local::standard_particleinventoryservice
dunedphase3x1x1_reco_services.RawDigitExtractService:     @local::rdx_std
dunedphase3x1x1_reco_services.RawDigitPrepService:        @local::adcprep_dunedphase3x1x1
dunedphase3x1x1_reco_services.AdcDeconvolutionService:    @local::adcdco_dunefddphase
dunedphase3x1x1_reco_services.AdcRoiBuildingService:      @local::adcroi_dunefddphase
dunedphase3x1x1_reco_services.AdcWireBuildingService:     @local::adcwire_std
dunedphase3x1x1_reco_services.PedestalEvaluationService:  @local::adcped_median
dunedphase3x1x1_reco_services.AdcNoiseRemovalService:     @local::adcnr_dunedphase3x1x1

# Settings for optical simulation in the FD. Optical simulation not on by default
# for FD, turned on by custom physics list and defining a photon visibility
# services is workspace g4 fhicl file.

dunedphase3x1x1_simulation_services.LArG4Parameters.UseCustomPhysics: true
dunedphase3x1x1_simulation_services.LArG4Parameters.EnabledPhysics: [ "Em",
                                           "FastOptical",
                                           "SynchrotronAndGN",
                                           "Ion",
                                           "Hadron",
                                           "Decay",
                                           "HadronElastic",
                                           "Stopping",
                                           "NeutronTrackingCut" ]
dunedphase3x1x1_simulation_services.LArPropertiesService.ScintYield: 		24000
dunedphase3x1x1_simulation_services.LArPropertiesService.EnableCerenkovLight: 	false
dunedphase3x1x1_simulation_services.LArPropertiesService.ScintPreScale: 	1
dunedphase3x1x1_simulation_services.OpDetResponseInterface.QuantumEfficiency: 	1.0

############################
### protoDUNE dual phase ###
############################

protodunedphase_services: {
 DatabaseUtil:                   @local::dunefd_database
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 ChannelStatusService:           @local::dunefd_channel_status
 LArFFT:                         @local::dunefd_larfft
 NuRandomService:                @local::dune_seedservice
 Geometry: 			 @local::protodunedphase_geo
 DetectorClocksService:          @local::protodunedphase_detectorclocks
 DetectorPropertiesService: 	 @local::protodunedphase_detproperties
 LArPropertiesService:           @local::dunefddphase_properties
 SignalShapingServiceDUNEDPhase: @local::protodunedphase_signalshapingservice
 SimChannelExtractService:       @local::scxdp
 CrpGainService:                 @local::dunefddphase_crpgain
 SpaceCharge:                    @local::dunefddphase_spacecharge
 CrpGainService:                 @local::dunefddphase_crpgain
}


protodunedphase_simulation_services: {
 BackTrackerService:                    @local::dunefd_backtrackerservice
 ParticleInventoryService:      @local::standard_particleinventoryservice
 LArFFT:                         @local::dunefd_larfft
 LArG4Parameters:                @local::protodune_largeantparameters
 ExptGeoHelperInterface:         @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 LArVoxelCalculator:             @local::dunefd_larvoxelcalculator
 MagneticField:                  @local::no_mag_larsoft
 NuRandomService:                @local::dune_seedservice
 DatabaseUtil:                   @local::dunefd_database
 OpDetResponseInterface:         @local::standard_opdetresponse
 PhotonBackTrackerService:       @local::standard_photonbacktrackerservice
 ChannelStatusService:           @local::dunefd_channel_status
 Geometry: 			 @local::protodunedphase_geo
 DetectorClocksService:          @local::protodunedphase_detectorclocks
 DetectorPropertiesService: 	 @local::protodunedphase_detproperties
 LArPropertiesService:           @local::dunefddphase_properties
 SignalShapingServiceDUNEDPhase: @local::protodunedphase_signalshapingservice
 SimChannelExtractService:       @local::scxdp
 CrpGainService:                 @local::dunefddphase_crpgain
 SpaceCharge:                    @local::dunefddphase_spacecharge
 PhotonVisibilityService: 	 @local::protodunedp_photonvisibilityservice
 PhotonVisibilityServiceS2: 	 @local::protodunedp_photonvisibilityserviceS2
 DetPedestalService:		 @local::dunedp_fixedpeds
 CrpGainService:                 @local::dunefddphase_crpgain
 OpDigiProperties:               @local::protodunedphase_opdigiproperties
}

protodunedphase_reco_services:                         	  @local::protodunedphase_services
protodunedphase_reco_services.BackTrackerService:         @local::dunefd_backtrackerservice
protodunedphase_reco_services.ParticleInventoryService:   @local::standard_particleinventoryservice
protodunedphase_reco_services.RawDigitExtractService:     @local::rdx_std
protodunedphase_reco_services.RawDigitPrepService:        @local::adcprep_with_services_sim
protodunedphase_reco_services.AdcDeconvolutionService:    @local::adcdco_dunefddphase
protodunedphase_reco_services.AdcRoiBuildingService:      @local::adcroi_dunefddphase
protodunedphase_reco_services.AdcWireBuildingService:     @local::adcwire_std
protodunedphase_reco_services.PedestalEvaluationService:  @local::adcped_median
#protodunedphase_reco_services.AdcNoiseRemovalService:    @local::adcnr_dunedphase3x1x1

# Settings for optical simulation in the protodunedp. Optical simulation IS by default ON,
# turned on by custom physics list and defining a photon visibility
# services is workspace g4 fhicl file.

protodunedphase_simulation_services.LArG4Parameters.UseCustomPhysics: true
protodunedphase_simulation_services.LArG4Parameters.EnabledPhysics: [ "Em",
                                           "FastOptical",
                                           "SynchrotronAndGN",
                                           "Ion",
                                           "Hadron",
                                           "Decay",
                                           "HadronElastic",
                                           "Stopping",
                                           "NeutronTrackingCut" ]

protodunedphase_simulation_services.OpDetResponseInterface.QuantumEfficiency: 1
protodunedphase_simulation_services.LArPropertiesService.ScintPreScale: 1
protodunedphase_simulation_services.LArPropertiesService.ScintYield: 24000
protodunedphase_simulation_services.LArPropertiesService.EnableCerenkovLight: false

protodunedphase_driftY_simulation_services: @local::protodunedphase_simulation_services
protodunedphase_driftY_simulation_services.PhotonVisibilityService: 	 @local::protodunedp_driftY_RL99CM_VUVREF_photonvisibilityservice
protodunedphase_driftY_simulation_services.Geometry: 			 @local::protodunedphase_driftY_geo


# dune10kt and dune34kt consolidated into dunefd,
# but catch any leftover cases of 10kt...
#dune10kt_services: @local::dunefd_services
#dune10kt_services.Geometry.GDML: "dune10kt.gdml"
#dune10kt_services.Geometry.ROOT: "dune10kt.gdml"
#dune10kt_simulation_services: @local::dunefd_services
#dune10kt_simulation_services.Geometry.GDML: "dune10kt.gdml"
#dune10kt_simulation_services.Geometry.ROOT: "dune10kt.gdml"





##############################
### ProtoDUNE Single Phase ###
##############################

protodune_services: {
 ExptGeoHelperInterface:       @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 Geometry:                     @local::protodune_geo
 DetectorClocksService:        @local::protodune_detectorclocks
 DetectorPropertiesService:    @local::protodune_detproperties
 LArPropertiesService:         @local::dunefd_properties
 LArFFT:                       @local::dunefd_larfft
 DatabaseUtil:                 @local::dunefd_database
 BackTrackerService:           @local::dunefd_backtrackerservice
 ParticleInventoryService:     @local::dunefd_particleinventoryservice
 PhotonBackTrackerService:     @local::dunefd_photonbacktrackerservice
 SpaceCharge:                  @local::protodune_spacecharge
 NuRandomService:              @local::dune_seedservice
 SignalShapingServiceDUNE:     @local::protodunesp_signalshapingservice
 ChannelStatusService:         @local::dunefd_channel_status
 ChannelGroupService:          @local::changroup_apa_keepall
}


protodune_rawdecoding_services: {
  ExptGeoHelperInterface:       @local::dune_geometry_helper
  GeometryConfigurationWriter: {}
  Geometry:                     @local::protodune_geo
  DetectorClocksService:        @local::protodune_detectorclocks
  DetectorPropertiesService:    @local::protodune_detproperties
  LArPropertiesService:         @local::dunefd_properties
  LArFFT:                       @local::dunefd_larfft  
  DatabaseUtil:                 @local::dunefd_database
  ChannelStatusService:         @local::dunefd_channel_status
#  ChannelGroupService:          @local::changroup_apa
  PdspChannelMapService:        @local::pdspchannelmap
}

iceberg_rawdecoding_services: {
  ExptGeoHelperInterface:       @local::dune_geometry_helper
  GeometryConfigurationWriter: {}
  Geometry:                     @local::iceberg_geo
  DetectorClocksService:        @local::protodune_detectorclocks
  DetectorPropertiesService:    @local::protodune_detproperties
  LArPropertiesService:         @local::dunefd_properties
  LArFFT:                       @local::dunefd_larfft  
  DatabaseUtil:                 @local::dunefd_database
  ChannelStatusService:         @local::dunefd_channel_status
  IcebergChannelMapService:     @local::icebergchannelmap
}

protodune_data_services: {
 ExptGeoHelperInterface:       @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 Geometry:                     @local::protodune_geo
 DetectorClocksService:        @local::protodune_detectorclocks
 DetectorPropertiesService:    @local::protodune_detproperties
 LArPropertiesService:         @local::dunefd_properties
 LArFFT:                       @local::dunefd_larfft
 DatabaseUtil:                 @local::dunefd_database
 SpaceCharge:                  @local::protodune_spacecharge
 NuRandomService:              @local::dune_seedservice
 SignalShapingServiceDUNE:     @local::protodunesp_signalshapingservice
 ChannelStatusService:         @local::pdsp_channel_status
 ChannelGroupService:          @local::changroup_apa_keepall
# Reco services for ProtoDUNE real data.
 RawDigitExtractService:       @local::rdx_std
 RawDigitPrepService:          @local::adcprep_with_services_sim
 AdcDeconvolutionService:      @local::adcdco_dunefd
 AdcRoiBuildingService:        @local::adcroi_dunefd
 AdcWireBuildingService:       @local::adcwire_std
}


protodune_simulation_services: {
 LArFFT:                       @local::dunefd_larfft
 LArG4Parameters:              @local::protodune_largeantparameters
 ExptGeoHelperInterface:       @local::dune_geometry_helper
 GeometryConfigurationWriter: {}
 Geometry:                     @local::protodune_geo
 DetectorClocksService:        @local::protodune_detectorclocks
 DetectorPropertiesService:    @local::protodune_detproperties
 LArPropertiesService:         @local::dunefd_properties
 DatabaseUtil:                 @local::dunefd_database
 LArVoxelCalculator:           @local::dunefd_larvoxelcalculator
 MagneticField:                @local::no_mag_larsoft
 SpaceCharge:                  @local::protodune_spacecharge
 NuRandomService:              @local::dune_seedservice
 SignalShapingServiceDUNE:     @local::protodunesp_signalshapingservice
 PhotonVisibilityService:      @local::protodune_photonvisibilityservice
 OpDetResponseInterface:       @local::protodune_opdetresponse
 ChannelStatusService:         @local::dunefd_channel_status
}

# Enable photon simulation for protoDUNE by default

protodune_simulation_services.LArPropertiesService.ScintYield: 24000
protodune_simulation_services.LArPropertiesService.ScintPreScale: 0.0287
protodune_simulation_services.LArPropertiesService.EnableCerenkovLight: false
protodune_simulation_services.LArG4Parameters.UseCustomPhysics: true
protodune_simulation_services.LArG4Parameters.EnabledPhysics: [ "Em",
                                                                "FastOptical",
                                                                "SynchrotronAndGN",
                                                                "Ion",
                                                                "Hadron",
                                                                "Decay",
                                                                "HadronElastic",
                                                                "Stopping" ]


# Reco services for ProtoDUNE simulation.
protodune_reco_services:                            @local::protodune_services
protodune_reco_services.RawDigitExtractService:     @local::rdx_std
protodune_reco_services.RawDigitPrepService:        @local::adcprep_with_services_sim
protodune_reco_services.AdcDeconvolutionService:    @local::adcdco_dunefd
protodune_reco_services.AdcRoiBuildingService:      @local::adcroi_dunefd
protodune_reco_services.AdcWireBuildingService:     @local::adcwire_std
# Switch to tool-based dataprep for ProtoDUNE simulation.
protodune_reco_services.RawDigitPrepService:        @local::adcprep_with_tools_sim
protodune_reco_services.RawDigitPrepService.AdcChannelToolNames: @local::protodune_dataprep_tools_sim
# xyz calibration service
protodune_reco_services.XYZCalibService:            @local::protodune_xyzcalib
# lifetime calibration service
protodune_reco_services.LifetimeCalibService:       @local::protodune_lifetimecalib
# channel map service
protodune_reco_services.PdspChannelMapService:      @local::pdspchannelmap
# channel status service
protodune_reco_services.ChannelStatusService:       @local::pdsp_channel_status

# Reco services for ProtoDUNE data
protodune_data_reco_services:                       @local::protodune_reco_services
# Get rid of low frequency noise
protodune_data_reco_services.SignalShapingServiceDUNE.IndUFilter: "(x>0.01)*gaus"
protodune_data_reco_services.SignalShapingServiceDUNE.IndVFilter: "(x>0.01)*gaus"
# Use channel service for data
protodune_data_reco_services.ChannelStatusService: @local::pdsp_channel_status
# Add the photon detector calibrator service
protodune_data_reco_services.IPhotonCalibrator:    @local::protodunesp_photoncalibrator
# ProtoDUNE detector properties service
protodune_data_reco_services.DetectorPropertiesService: @local::protodunesp_detproperties
# Dataprep service.
protodune_data_reco_services.RawDigitPrepService.AdcChannelToolNames: @local::protodune_dataprep_tools_wirecell

##################################################
### Make Parallel Services for the v7 geometry ###
##################################################

protodunev7_services:  @local::protodune_services
protodunev7_services.Geometry: @local::protodunev7_geo

protodunev7_rawdecoding_services:  @local::protodune_rawdecoding_services
protodunev7_rawdecoding_services.Geometry: @local::protodunev7_geo

protodunev7_data_services:  @local::protodune_data_services
protodunev7_data_services.Geometry: @local::protodunev7_geo

protodunev7_reco_services:  @local::protodune_reco_services
protodunev7_reco_services.Geometry: @local::protodunev7_geo

protodunev7_data_reco_services:  @local::protodune_data_reco_services
protodunev7_data_reco_services.Geometry: @local::protodunev7_geo

protodunev7_simulation_services:  @local::protodune_simulation_services
protodunev7_simulation_services.Geometry: @local::protodunev7_geo
protodunev7_simulation_services.PhotonVisibilityService: @local::protodunev7_photonvisibilityservice





#######################
### 35ton Prototype ###
#######################

dune35t_basic_services: {
  ExptGeoHelperInterface:     @local::dune_geometry_helper
  GeometryConfigurationWriter: {}
  Geometry:                   @local::dune35t_geo
  DetectorClocksService:      @local::dune35t_detectorclocks
  DetectorPropertiesService:  @local::dune35t_detproperties
  LArPropertiesService:       @local::dune35t_properties
  DatabaseUtil:               @local::dune35t_database
  SpaceCharge:                @local::dune35t_spacecharge
  NuRandomService:             @local::dune_seedservice
  ChannelStatusService:       @local::dune35t_channel_status_dla
  ChannelGroupService:        @local::changroup_apa_keepall
}

# DLA Aug2016: Drop this in favor of dune35t_reco_services?
# For now, keep for use with the old reco.
dune35t_services:                            @local::dune35t_basic_services
dune35t_services.LArFFT:                     @local::dune35t_larfft
dune35t_services.BackTrackerService:                @local::dune35t_backtrackerservice
dune35t_services.ParticleInventoryService:      @local::dune35t_particleinventoryservice
dune35t_services.PhotonBackTrackerService:          @local::dune35t_photonbacktrackerservice
dune35t_services.SignalShapingServiceDUNE:   @local::dune35t_signalshapingservice

dune35t_gen_services:                        @local::dune35t_basic_services
dune35t_gen_services.MagneticField:          @local::no_mag_larsoft

dune35t_g4_services:                         @local::dune35t_gen_services
dune35t_g4_services.LArG4Parameters:         @local::dune35t_largeantparameters
dune35t_g4_services.LArVoxelCalculator:      @local::dune35t_larvoxelcalculator
dune35t_g4_services.PhotonVisibilityService: @local::dune35t_photonvisibilityservice
dune35t_g4_services.OpDetResponseInterface:  @local::dune35t_opdetresponse

##
# Settings to turn on and configure photon simulation
##

# Pre-scale the scintillation yield to save memory (correct when applying QE)
# MUST match between g4 and detsim steps
dune35t_g4_services.LArPropertiesService.ScintYield:    24000
dune35t_g4_services.LArPropertiesService.ScintPreScale: 0.0023

# disable cerenkov
dune35t_g4_services.LArPropertiesService.EnableCerenkovLight: false

# enable "FastOptical" in geant4
dune35t_g4_services.LArG4Parameters.UseCustomPhysics: true
dune35t_g4_services.LArG4Parameters.EnabledPhysics: [ "Em",
                                                      "FastOptical",
                                                      "SynchrotronAndGN",
                                                      "Ion",
                                                      "Hadron",
                                                      "Decay",
                                                      "HadronElastic",
                                                      "Stopping",
                                                      "NeutronTrackingCut" ]

dune35t_detsim_services:                              @local::dune35t_basic_services
dune35t_detsim_services.LArFFT:                       @local::dune35t_larfft
dune35t_detsim_services.SignalShapingServiceDUNE:     @local::dune35t_signalshapingservice
dune35t_detsim_services.OpDetResponseInterface:       @local::dune35t_opdetresponse
dune35t_detsim_services.LArG4Parameters:              @local::dune35t_largeantparameters

# enable "FastOptical" in geant4
dune35t_detsim_services.LArG4Parameters.UseCustomPhysics: true
dune35t_detsim_services.LArG4Parameters.EnabledPhysics: [ "Em",
                                                          "FastOptical",
                                                          "SynchrotronAndGN",
                                                          "Ion",
                                                          "Hadron",
                                                          "Decay",
                                                          "HadronElastic",
                                                          "Stopping",
                                                          "NeutronTrackingCut" ]

# Pre-scale the scintillation yield to save memory (correct when applying QE)
# MUST match between g4 and detsim steps
dune35t_detsim_services.LArPropertiesService.ScintPreScale:      0.0023

dune35t_simulation_services:                                      @local::dune35t_g4_services
dune35t_simulation_services.LArFFT:                               @local::dune35t_larfft
dune35t_simulation_services.SignalShapingServiceDUNE:             @local::dune35t_signalshapingservice
dune35t_simulation_services.PhotonVisibilityService:              @local::dune35t_photonvisibilityservice
dune35t_simulation_services.BackTrackerService:                          @local::dune35t_backtrackerservice
dune35t_simulation_services.ParticleInventoryService:      @local::dune35t_particleinventoryservice
dune35t_simulation_services.PhotonBackTrackerService:                    @local::dune35t_photonbacktrackerservice

# Reco services for 35-ton data.
dune35tdata_reco_services:                            @local::dune35t_basic_services
dune35tdata_reco_services.LArFFT:                     @local::dune35t_larfft
dune35tdata_reco_services.BackTrackerService:         @local::dune35t_backtrackerservice
dune35tdata_reco_services.ParticleInventoryService:   @local::dune35t_particleinventoryservice
dune35tdata_reco_services.SignalShapingServiceDUNE:   @local::dune35t_signalshapingservice
dune35tdata_reco_services.AdcChannelDataCopyService:  @local::adccopy
dune35tdata_reco_services.RawDigitExtractService:     @local::rdx_35tdata
dune35tdata_reco_services.AdcSuppressonService:       @local::adcmit_dune35t
dune35tdata_reco_services.AdcSuppressService:         @local::adcsuppress_legacy35t
dune35tdata_reco_services.AdcNSignalFindingService:   @local::adcsigfind_suppress
dune35tdata_reco_services.PedestalEvaluationService:  @local::adcped_median
dune35tdata_reco_services.AdcDeconvolutionService:    @local::adcdco_dune35t
dune35tdata_reco_services.AdcRoiBuildingService:      @local::adcroi_dune35t
dune35tdata_reco_services.AdcWireBuildingService:     @local::adcwire_std
dune35tdata_reco_services.RawDigitPrepService:        @local::adcprep_dune35tdata

# Reco services for 35-ton simulation.
dune35tsim_reco_services:                             @local::dune35tdata_reco_services
dune35tsim_reco_services.RawDigitExtractService:      @local::rdx_std
dune35tsim_reco_services.RawDigitPrepService:         @local::adcprep_with_services_sim

dune35t_milliblock_reco_services:                                 @local::dune35tsim_reco_services
dune35t_milliblock_reco_services.DetectorPropertiesService:       @local::dune35t_milliblock_detproperties

dune35t_milliblock_detsim_services:                               @local::dune35t_detsim_services
dune35t_milliblock_detsim_services.DetectorPropertiesService:     @local::dune35t_milliblock_detproperties

dune35t_milliblock_simulation_services:                           @local::dune35t_simulation_services
dune35t_milliblock_simulation_services.DetectorPropertiesService: @local::dune35t_milliblock_detproperties





########################
### Message Services ###
########################

dune_message_services: {
  debugModules: ["*"]
  destinations: {
    LogDebugFile: {
      type:       "file"
      filename:   "debug.log"
      append:     false
      threshold:  "DEBUG"
      categories:{
        default:{ limit: 0 }
      }
    }
    LogStandardOut: {
      type:       "cout"
      threshold:  "WARNING"
      categories:{
        default:{ }
        RecoBaseDefaultCtor: { limit: 0 }
        AnaBaseDefaultCtor:  { limit: 0 }
        GeometryBadInputPoint: { limit: 5 timespan: 1000}
      }
    }
    LogStandardError: {
      type:       "cerr"
      threshold:  "ERROR"
      categories:{
        default:{ }
      }
    }
  }
}

dune_message_services_prod_debug: {
  debugModules: ["*"]
  destinations: {
    LogDebugFile:      @local::dune_message_services.destinations.LogDebugFile
    LogStandardOut:    @local::dune_message_services.destinations.LogStandardOut
    LogStandardError:  @local::dune_message_services.destinations.LogStandardError
  }
}

dune_message_services_prod_debug.destinations.LogDebugFile.categories:{
  default: { }
  RecoBaseDefaultCtor: { limit: 0 }
  AnaBaseDefaultCtor:  { limit: 0 }
  Track3DKalmanSPS_GenFit: { limit: 0 }
  GeometryBadInputPoint: { limit: 5 timespan: 1000}
  SpacePointAlg: { limit: 0 }
  KalmanFilterAlg: { limit: 0 }
  Track3DKalmanHit: { limit: 0 }
  fuzzyCluster: { limit: 0}
  ChannelFilter: { limit: 0}
  HoughBaseAlg: { limit: 0}
  DBscan: {limit: 0}
  CosmicTracker: {limit: 0}
  HitCheater: {limit: 0}
  DisambigAlg35t: {limit: 0}
  ClusterCheater: {limit: 0}
  ClusterCrawlerAlg: {limit: 0}
  CaloPrtTrk: {limit: 0}
  CaloPrtHit: {limit: 0}
  BackTrackerService: {limit: 0}
  DisambigCheat: {limit: 0}
  Summary: {limit: 0}
  CosmicTracker: {limit: 0}
  ClusterMergeTQ: {limit: 0}
  LArPandora: {limit: 0}
}


dune_message_services_prod: {
  debugModules: ["*"]
  destinations: {
    LogDebugFile: {
      type:       "file"
      filename:   "debugprod.log"
      append:     false
      threshold:  "DEBUG"
      categories:{
        default:{ limit: 0 }
      }
    }
    LogStandardOut: {
      type:       "cout"
      threshold:  "INFO"
      categories:{
        ArtReport: {limit: -1}
        default:{limit: 0}
      }
    }
    LogStandardError: {
      type:       "cerr"
      threshold:  "ERROR"
      categories:{
        default:{}
      }
    }
  }
}

dune_message_services_interactive: {
  debugModules: ["*"]
  destinations: {
    LogDebugFile:      @local::dune_message_services.destinations.LogDebugFile
    LogStandardOut:    @local::dune_message_services.destinations.LogStandardOut
    LogStandardError:  @local::dune_message_services.destinations.LogStandardError
  }
}
dune_message_services_interactive.destinations.LogStandardOut.threshold:  "INFO"
dune_message_services_interactive.destinations.LogStandardOut.categories:{
  default: { limit: 0 }
}
dune_message_services_interactive.destinations.LogStandardError.threshold:  "WARNING"
dune_message_services_interactive.destinations.LogStandardError.categories: {
  default: { }
  RecoBaseDefaultCtor: { limit: 1 }
  AnaBaseDefaultCtor:  { limit: 1 }
  GeometryBadInputPoint: { limit: 5 timespan: 1000}
}

END_PROLOG
